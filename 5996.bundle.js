"use strict";(self.webpackChunkpylinac_yaml_editor=self.webpackChunkpylinac_yaml_editor||[]).push([[5996],{5996:(e,n,t)=>{t.r(n),t.d(n,{clearPlatformLanguageAssociations:()=>w,getLanguageIds:()=>d,registerPlatformLanguageAssociation:()=>p});var i=t(3958),o=t(3720),r=t(3072),a=t(8019),s=t(2467),f=t(6844),l=t(4957);let m=[],u=[],c=[];function p(e,n=!1){!function(e,n,t){const o=function(e){return{id:e.id,mime:e.mime,filename:e.filename,extension:e.extension,filepattern:e.filepattern,firstline:e.firstline,userConfigured:false,filenameLowercase:e.filename?e.filename.toLowerCase():void 0,extensionLowercase:e.extension?e.extension.toLowerCase():void 0,filepatternLowercase:e.filepattern?(0,i.qg)(e.filepattern.toLowerCase()):void 0,filepatternOnPath:!!e.filepattern&&e.filepattern.indexOf(a.SA.sep)>=0}}(e);m.push(o),o.userConfigured?c.push(o):u.push(o),t&&!o.userConfigured&&m.forEach((e=>{e.mime===o.mime||e.userConfigured||(o.extension&&e.extension===o.extension&&console.warn(`Overwriting extension <<${o.extension}>> to now point to mime <<${o.mime}>>`),o.filename&&e.filename===o.filename&&console.warn(`Overwriting filename <<${o.filename}>> to now point to mime <<${o.mime}>>`),o.filepattern&&e.filepattern===o.filepattern&&console.warn(`Overwriting filepattern <<${o.filepattern}>> to now point to mime <<${o.mime}>>`),o.firstline&&e.firstline===o.firstline&&console.warn(`Overwriting firstline <<${o.firstline}>> to now point to mime <<${o.mime}>>`))}))}(e,0,n)}function w(){m=m.filter((e=>e.userConfigured)),u=[]}function d(e,n){return function(e,n){let t;if(e)switch(e.scheme){case r.ny.file:t=e.fsPath;break;case r.ny.data:t=s.B6.parseMetaData(e).get(s.B6.META_DATA_LABEL);break;case r.ny.vscodeNotebookCell:t=void 0;break;default:t=e.path}if(!t)return[{id:"unknown",mime:o.K.unknown}];t=t.toLowerCase();const i=(0,a.P8)(t),p=g(t,i,c);if(p)return[p,{id:l.vH,mime:o.K.text}];const w=g(t,i,u);if(w)return[w,{id:l.vH,mime:o.K.text}];if(n){const e=function(e){if((0,f.LU)(e)&&(e=e.substr(1)),e.length>0)for(let n=m.length-1;n>=0;n--){const t=m[n];if(!t.firstline)continue;const i=e.match(t.firstline);if(i&&i.length>0)return t}}(n);if(e)return[e,{id:l.vH,mime:o.K.text}]}return[{id:"unknown",mime:o.K.unknown}]}(e,n).map((e=>e.id))}function g(e,n,t){let i,o,r;for(let a=t.length-1;a>=0;a--){const s=t[a];if(n===s.filenameLowercase){i=s;break}if(s.filepattern&&(!o||s.filepattern.length>o.filepattern.length)){const t=s.filepatternOnPath?e:n;s.filepatternLowercase?.(t)&&(o=s)}s.extension&&(!r||s.extension.length>r.extension.length)&&n.endsWith(s.extensionLowercase)&&(r=s)}return i||o||r||void 0}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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dUQsR0FJQUMsR0FJQUMsUUFBSixDQUlKLEMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9weWxpbmFjLXlhbWwtZWRpdG9yLy4vbm9kZV9tb2R1bGVzL21vbmFjby1lZGl0b3IvZXNtL3ZzL2VkaXRvci9jb21tb24vc2VydmljZXMvbGFuZ3VhZ2VzQXNzb2NpYXRpb25zLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiAgQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKiAgTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLiBTZWUgTGljZW5zZS50eHQgaW4gdGhlIHByb2plY3Qgcm9vdCBmb3IgbGljZW5zZSBpbmZvcm1hdGlvbi5cbiAqLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuaW1wb3J0IHsgcGFyc2UgfSBmcm9tICcuLi8uLi8uLi9iYXNlL2NvbW1vbi9nbG9iLmpzJztcbmltcG9ydCB7IE1pbWVzIH0gZnJvbSAnLi4vLi4vLi4vYmFzZS9jb21tb24vbWltZS5qcyc7XG5pbXBvcnQgeyBTY2hlbWFzIH0gZnJvbSAnLi4vLi4vLi4vYmFzZS9jb21tb24vbmV0d29yay5qcyc7XG5pbXBvcnQgeyBiYXNlbmFtZSwgcG9zaXggfSBmcm9tICcuLi8uLi8uLi9iYXNlL2NvbW1vbi9wYXRoLmpzJztcbmltcG9ydCB7IERhdGFVcmkgfSBmcm9tICcuLi8uLi8uLi9iYXNlL2NvbW1vbi9yZXNvdXJjZXMuanMnO1xuaW1wb3J0IHsgc3RhcnRzV2l0aFVURjhCT00gfSBmcm9tICcuLi8uLi8uLi9iYXNlL2NvbW1vbi9zdHJpbmdzLmpzJztcbmltcG9ydCB7IFBMQUlOVEVYVF9MQU5HVUFHRV9JRCB9IGZyb20gJy4uL2xhbmd1YWdlcy9tb2Rlc1JlZ2lzdHJ5LmpzJztcbmxldCByZWdpc3RlcmVkQXNzb2NpYXRpb25zID0gW107XG5sZXQgbm9uVXNlclJlZ2lzdGVyZWRBc3NvY2lhdGlvbnMgPSBbXTtcbmxldCB1c2VyUmVnaXN0ZXJlZEFzc29jaWF0aW9ucyA9IFtdO1xuLyoqXG4gKiBBc3NvY2lhdGUgYSBsYW5ndWFnZSB0byB0aGUgcmVnaXN0cnkgKHBsYXRmb3JtKS5cbiAqICogKipOT1RFKio6IFRoaXMgYXNzb2NpYXRpb24gd2lsbCBsb3NlIG92ZXIgYXNzb2NpYXRpb25zIHJlZ2lzdGVyZWQgdXNpbmcgYHJlZ2lzdGVyQ29uZmlndXJlZExhbmd1YWdlQXNzb2NpYXRpb25gLlxuICogKiAqKk5PVEUqKjogVXNlIGBjbGVhclBsYXRmb3JtTGFuZ3VhZ2VBc3NvY2lhdGlvbnNgIHRvIHJlbW92ZSBhbGwgYXNzb2NpYXRpb25zIHJlZ2lzdGVyZWQgdXNpbmcgdGhpcyBmdW5jdGlvbi5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlZ2lzdGVyUGxhdGZvcm1MYW5ndWFnZUFzc29jaWF0aW9uKGFzc29jaWF0aW9uLCB3YXJuT25PdmVyd3JpdGUgPSBmYWxzZSkge1xuICAgIF9yZWdpc3Rlckxhbmd1YWdlQXNzb2NpYXRpb24oYXNzb2NpYXRpb24sIGZhbHNlLCB3YXJuT25PdmVyd3JpdGUpO1xufVxuZnVuY3Rpb24gX3JlZ2lzdGVyTGFuZ3VhZ2VBc3NvY2lhdGlvbihhc3NvY2lhdGlvbiwgdXNlckNvbmZpZ3VyZWQsIHdhcm5Pbk92ZXJ3cml0ZSkge1xuICAgIC8vIFJlZ2lzdGVyXG4gICAgY29uc3QgYXNzb2NpYXRpb25JdGVtID0gdG9MYW5ndWFnZUFzc29jaWF0aW9uSXRlbShhc3NvY2lhdGlvbiwgdXNlckNvbmZpZ3VyZWQpO1xuICAgIHJlZ2lzdGVyZWRBc3NvY2lhdGlvbnMucHVzaChhc3NvY2lhdGlvbkl0ZW0pO1xuICAgIGlmICghYXNzb2NpYXRpb25JdGVtLnVzZXJDb25maWd1cmVkKSB7XG4gICAgICAgIG5vblVzZXJSZWdpc3RlcmVkQXNzb2NpYXRpb25zLnB1c2goYXNzb2NpYXRpb25JdGVtKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHVzZXJSZWdpc3RlcmVkQXNzb2NpYXRpb25zLnB1c2goYXNzb2NpYXRpb25JdGVtKTtcbiAgICB9XG4gICAgLy8gQ2hlY2sgZm9yIGNvbmZsaWN0cyB1bmxlc3MgdGhpcyBpcyBhIHVzZXIgY29uZmlndXJlZCBhc3NvY2lhdGlvblxuICAgIGlmICh3YXJuT25PdmVyd3JpdGUgJiYgIWFzc29jaWF0aW9uSXRlbS51c2VyQ29uZmlndXJlZCkge1xuICAgICAgICByZWdpc3RlcmVkQXNzb2NpYXRpb25zLmZvckVhY2goYSA9PiB7XG4gICAgICAgICAgICBpZiAoYS5taW1lID09PSBhc3NvY2lhdGlvbkl0ZW0ubWltZSB8fCBhLnVzZXJDb25maWd1cmVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuOyAvLyBzYW1lIG1pbWUgb3IgdXNlckNvbmZpZ3VyZWQgaXMgb2tcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhc3NvY2lhdGlvbkl0ZW0uZXh0ZW5zaW9uICYmIGEuZXh0ZW5zaW9uID09PSBhc3NvY2lhdGlvbkl0ZW0uZXh0ZW5zaW9uKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBPdmVyd3JpdGluZyBleHRlbnNpb24gPDwke2Fzc29jaWF0aW9uSXRlbS5leHRlbnNpb259Pj4gdG8gbm93IHBvaW50IHRvIG1pbWUgPDwke2Fzc29jaWF0aW9uSXRlbS5taW1lfT4+YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYXNzb2NpYXRpb25JdGVtLmZpbGVuYW1lICYmIGEuZmlsZW5hbWUgPT09IGFzc29jaWF0aW9uSXRlbS5maWxlbmFtZSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihgT3ZlcndyaXRpbmcgZmlsZW5hbWUgPDwke2Fzc29jaWF0aW9uSXRlbS5maWxlbmFtZX0+PiB0byBub3cgcG9pbnQgdG8gbWltZSA8PCR7YXNzb2NpYXRpb25JdGVtLm1pbWV9Pj5gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhc3NvY2lhdGlvbkl0ZW0uZmlsZXBhdHRlcm4gJiYgYS5maWxlcGF0dGVybiA9PT0gYXNzb2NpYXRpb25JdGVtLmZpbGVwYXR0ZXJuKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBPdmVyd3JpdGluZyBmaWxlcGF0dGVybiA8PCR7YXNzb2NpYXRpb25JdGVtLmZpbGVwYXR0ZXJufT4+IHRvIG5vdyBwb2ludCB0byBtaW1lIDw8JHthc3NvY2lhdGlvbkl0ZW0ubWltZX0+PmApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGFzc29jaWF0aW9uSXRlbS5maXJzdGxpbmUgJiYgYS5maXJzdGxpbmUgPT09IGFzc29jaWF0aW9uSXRlbS5maXJzdGxpbmUpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYE92ZXJ3cml0aW5nIGZpcnN0bGluZSA8PCR7YXNzb2NpYXRpb25JdGVtLmZpcnN0bGluZX0+PiB0byBub3cgcG9pbnQgdG8gbWltZSA8PCR7YXNzb2NpYXRpb25JdGVtLm1pbWV9Pj5gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxufVxuZnVuY3Rpb24gdG9MYW5ndWFnZUFzc29jaWF0aW9uSXRlbShhc3NvY2lhdGlvbiwgdXNlckNvbmZpZ3VyZWQpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBpZDogYXNzb2NpYXRpb24uaWQsXG4gICAgICAgIG1pbWU6IGFzc29jaWF0aW9uLm1pbWUsXG4gICAgICAgIGZpbGVuYW1lOiBhc3NvY2lhdGlvbi5maWxlbmFtZSxcbiAgICAgICAgZXh0ZW5zaW9uOiBhc3NvY2lhdGlvbi5leHRlbnNpb24sXG4gICAgICAgIGZpbGVwYXR0ZXJuOiBhc3NvY2lhdGlvbi5maWxlcGF0dGVybixcbiAgICAgICAgZmlyc3RsaW5lOiBhc3NvY2lhdGlvbi5maXJzdGxpbmUsXG4gICAgICAgIHVzZXJDb25maWd1cmVkOiB1c2VyQ29uZmlndXJlZCxcbiAgICAgICAgZmlsZW5hbWVMb3dlcmNhc2U6IGFzc29jaWF0aW9uLmZpbGVuYW1lID8gYXNzb2NpYXRpb24uZmlsZW5hbWUudG9Mb3dlckNhc2UoKSA6IHVuZGVmaW5lZCxcbiAgICAgICAgZXh0ZW5zaW9uTG93ZXJjYXNlOiBhc3NvY2lhdGlvbi5leHRlbnNpb24gPyBhc3NvY2lhdGlvbi5leHRlbnNpb24udG9Mb3dlckNhc2UoKSA6IHVuZGVmaW5lZCxcbiAgICAgICAgZmlsZXBhdHRlcm5Mb3dlcmNhc2U6IGFzc29jaWF0aW9uLmZpbGVwYXR0ZXJuID8gcGFyc2UoYXNzb2NpYXRpb24uZmlsZXBhdHRlcm4udG9Mb3dlckNhc2UoKSkgOiB1bmRlZmluZWQsXG4gICAgICAgIGZpbGVwYXR0ZXJuT25QYXRoOiBhc3NvY2lhdGlvbi5maWxlcGF0dGVybiA/IGFzc29jaWF0aW9uLmZpbGVwYXR0ZXJuLmluZGV4T2YocG9zaXguc2VwKSA+PSAwIDogZmFsc2VcbiAgICB9O1xufVxuLyoqXG4gKiBDbGVhciBsYW5ndWFnZSBhc3NvY2lhdGlvbnMgZnJvbSB0aGUgcmVnaXN0cnkgKHBsYXRmb3JtKS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNsZWFyUGxhdGZvcm1MYW5ndWFnZUFzc29jaWF0aW9ucygpIHtcbiAgICByZWdpc3RlcmVkQXNzb2NpYXRpb25zID0gcmVnaXN0ZXJlZEFzc29jaWF0aW9ucy5maWx0ZXIoYSA9PiBhLnVzZXJDb25maWd1cmVkKTtcbiAgICBub25Vc2VyUmVnaXN0ZXJlZEFzc29jaWF0aW9ucyA9IFtdO1xufVxuLyoqXG4gKiBAc2VlIGBnZXRNaW1lVHlwZXNgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRMYW5ndWFnZUlkcyhyZXNvdXJjZSwgZmlyc3RMaW5lKSB7XG4gICAgcmV0dXJuIGdldEFzc29jaWF0aW9ucyhyZXNvdXJjZSwgZmlyc3RMaW5lKS5tYXAoaXRlbSA9PiBpdGVtLmlkKTtcbn1cbmZ1bmN0aW9uIGdldEFzc29jaWF0aW9ucyhyZXNvdXJjZSwgZmlyc3RMaW5lKSB7XG4gICAgbGV0IHBhdGg7XG4gICAgaWYgKHJlc291cmNlKSB7XG4gICAgICAgIHN3aXRjaCAocmVzb3VyY2Uuc2NoZW1lKSB7XG4gICAgICAgICAgICBjYXNlIFNjaGVtYXMuZmlsZTpcbiAgICAgICAgICAgICAgICBwYXRoID0gcmVzb3VyY2UuZnNQYXRoO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBTY2hlbWFzLmRhdGE6IHtcbiAgICAgICAgICAgICAgICBjb25zdCBtZXRhZGF0YSA9IERhdGFVcmkucGFyc2VNZXRhRGF0YShyZXNvdXJjZSk7XG4gICAgICAgICAgICAgICAgcGF0aCA9IG1ldGFkYXRhLmdldChEYXRhVXJpLk1FVEFfREFUQV9MQUJFTCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlIFNjaGVtYXMudnNjb2RlTm90ZWJvb2tDZWxsOlxuICAgICAgICAgICAgICAgIC8vIEZpbGUgcGF0aCBub3QgcmVsZXZhbnQgZm9yIGxhbmd1YWdlIGRldGVjdGlvbiBvZiBjZWxsXG4gICAgICAgICAgICAgICAgcGF0aCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcGF0aCA9IHJlc291cmNlLnBhdGg7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKCFwYXRoKSB7XG4gICAgICAgIHJldHVybiBbeyBpZDogJ3Vua25vd24nLCBtaW1lOiBNaW1lcy51bmtub3duIH1dO1xuICAgIH1cbiAgICBwYXRoID0gcGF0aC50b0xvd2VyQ2FzZSgpO1xuICAgIGNvbnN0IGZpbGVuYW1lID0gYmFzZW5hbWUocGF0aCk7XG4gICAgLy8gMS4pIFVzZXIgY29uZmlndXJlZCBtYXBwaW5ncyBoYXZlIGhpZ2hlc3QgcHJpb3JpdHlcbiAgICBjb25zdCBjb25maWd1cmVkTGFuZ3VhZ2UgPSBnZXRBc3NvY2lhdGlvbkJ5UGF0aChwYXRoLCBmaWxlbmFtZSwgdXNlclJlZ2lzdGVyZWRBc3NvY2lhdGlvbnMpO1xuICAgIGlmIChjb25maWd1cmVkTGFuZ3VhZ2UpIHtcbiAgICAgICAgcmV0dXJuIFtjb25maWd1cmVkTGFuZ3VhZ2UsIHsgaWQ6IFBMQUlOVEVYVF9MQU5HVUFHRV9JRCwgbWltZTogTWltZXMudGV4dCB9XTtcbiAgICB9XG4gICAgLy8gMi4pIFJlZ2lzdGVyZWQgbWFwcGluZ3MgaGF2ZSBtaWRkbGUgcHJpb3JpdHlcbiAgICBjb25zdCByZWdpc3RlcmVkTGFuZ3VhZ2UgPSBnZXRBc3NvY2lhdGlvbkJ5UGF0aChwYXRoLCBmaWxlbmFtZSwgbm9uVXNlclJlZ2lzdGVyZWRBc3NvY2lhdGlvbnMpO1xuICAgIGlmIChyZWdpc3RlcmVkTGFuZ3VhZ2UpIHtcbiAgICAgICAgcmV0dXJuIFtyZWdpc3RlcmVkTGFuZ3VhZ2UsIHsgaWQ6IFBMQUlOVEVYVF9MQU5HVUFHRV9JRCwgbWltZTogTWltZXMudGV4dCB9XTtcbiAgICB9XG4gICAgLy8gMy4pIEZpcnN0bGluZSBoYXMgbG93ZXN0IHByaW9yaXR5XG4gICAgaWYgKGZpcnN0TGluZSkge1xuICAgICAgICBjb25zdCBmaXJzdGxpbmVMYW5ndWFnZSA9IGdldEFzc29jaWF0aW9uQnlGaXJzdGxpbmUoZmlyc3RMaW5lKTtcbiAgICAgICAgaWYgKGZpcnN0bGluZUxhbmd1YWdlKSB7XG4gICAgICAgICAgICByZXR1cm4gW2ZpcnN0bGluZUxhbmd1YWdlLCB7IGlkOiBQTEFJTlRFWFRfTEFOR1VBR0VfSUQsIG1pbWU6IE1pbWVzLnRleHQgfV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIFt7IGlkOiAndW5rbm93bicsIG1pbWU6IE1pbWVzLnVua25vd24gfV07XG59XG5mdW5jdGlvbiBnZXRBc3NvY2lhdGlvbkJ5UGF0aChwYXRoLCBmaWxlbmFtZSwgYXNzb2NpYXRpb25zKSB7XG4gICAgbGV0IGZpbGVuYW1lTWF0Y2ggPSB1bmRlZmluZWQ7XG4gICAgbGV0IHBhdHRlcm5NYXRjaCA9IHVuZGVmaW5lZDtcbiAgICBsZXQgZXh0ZW5zaW9uTWF0Y2ggPSB1bmRlZmluZWQ7XG4gICAgLy8gV2Ugd2FudCB0byBwcmlvcml0aXplIGFzc29jaWF0aW9ucyBiYXNlZCBvbiB0aGUgb3JkZXIgdGhleSBhcmUgcmVnaXN0ZXJlZCBzbyB0aGF0IHRoZSBsYXN0IHJlZ2lzdGVyZWRcbiAgICAvLyBhc3NvY2lhdGlvbiB3aW5zIG92ZXIgYWxsIG90aGVyLiBUaGlzIGlzIGZvciBodHRwczovL2dpdGh1Yi5jb20vbWljcm9zb2Z0L3ZzY29kZS9pc3N1ZXMvMjAwNzRcbiAgICBmb3IgKGxldCBpID0gYXNzb2NpYXRpb25zLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgIGNvbnN0IGFzc29jaWF0aW9uID0gYXNzb2NpYXRpb25zW2ldO1xuICAgICAgICAvLyBGaXJzdCBleGFjdCBuYW1lIG1hdGNoXG4gICAgICAgIGlmIChmaWxlbmFtZSA9PT0gYXNzb2NpYXRpb24uZmlsZW5hbWVMb3dlcmNhc2UpIHtcbiAgICAgICAgICAgIGZpbGVuYW1lTWF0Y2ggPSBhc3NvY2lhdGlvbjtcbiAgICAgICAgICAgIGJyZWFrOyAvLyB0YWtlIGl0IVxuICAgICAgICB9XG4gICAgICAgIC8vIExvbmdlc3QgcGF0dGVybiBtYXRjaFxuICAgICAgICBpZiAoYXNzb2NpYXRpb24uZmlsZXBhdHRlcm4pIHtcbiAgICAgICAgICAgIGlmICghcGF0dGVybk1hdGNoIHx8IGFzc29jaWF0aW9uLmZpbGVwYXR0ZXJuLmxlbmd0aCA+IHBhdHRlcm5NYXRjaC5maWxlcGF0dGVybi5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXQgPSBhc3NvY2lhdGlvbi5maWxlcGF0dGVybk9uUGF0aCA/IHBhdGggOiBmaWxlbmFtZTsgLy8gbWF0Y2ggb24gZnVsbCBwYXRoIGlmIHBhdHRlcm4gY29udGFpbnMgcGF0aCBzZXBhcmF0b3JcbiAgICAgICAgICAgICAgICBpZiAoYXNzb2NpYXRpb24uZmlsZXBhdHRlcm5Mb3dlcmNhc2U/Lih0YXJnZXQpKSB7XG4gICAgICAgICAgICAgICAgICAgIHBhdHRlcm5NYXRjaCA9IGFzc29jaWF0aW9uO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBMb25nZXN0IGV4dGVuc2lvbiBtYXRjaFxuICAgICAgICBpZiAoYXNzb2NpYXRpb24uZXh0ZW5zaW9uKSB7XG4gICAgICAgICAgICBpZiAoIWV4dGVuc2lvbk1hdGNoIHx8IGFzc29jaWF0aW9uLmV4dGVuc2lvbi5sZW5ndGggPiBleHRlbnNpb25NYXRjaC5leHRlbnNpb24ubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgaWYgKGZpbGVuYW1lLmVuZHNXaXRoKGFzc29jaWF0aW9uLmV4dGVuc2lvbkxvd2VyY2FzZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZXh0ZW5zaW9uTWF0Y2ggPSBhc3NvY2lhdGlvbjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgLy8gMS4pIEV4YWN0IG5hbWUgbWF0Y2ggaGFzIHNlY29uZCBoaWdoZXN0IHByaW9yaXR5XG4gICAgaWYgKGZpbGVuYW1lTWF0Y2gpIHtcbiAgICAgICAgcmV0dXJuIGZpbGVuYW1lTWF0Y2g7XG4gICAgfVxuICAgIC8vIDIuKSBNYXRjaCBvbiBwYXR0ZXJuXG4gICAgaWYgKHBhdHRlcm5NYXRjaCkge1xuICAgICAgICByZXR1cm4gcGF0dGVybk1hdGNoO1xuICAgIH1cbiAgICAvLyAzLikgTWF0Y2ggb24gZXh0ZW5zaW9uIGNvbWVzIG5leHRcbiAgICBpZiAoZXh0ZW5zaW9uTWF0Y2gpIHtcbiAgICAgICAgcmV0dXJuIGV4dGVuc2lvbk1hdGNoO1xuICAgIH1cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xufVxuZnVuY3Rpb24gZ2V0QXNzb2NpYXRpb25CeUZpcnN0bGluZShmaXJzdExpbmUpIHtcbiAgICBpZiAoc3RhcnRzV2l0aFVURjhCT00oZmlyc3RMaW5lKSkge1xuICAgICAgICBmaXJzdExpbmUgPSBmaXJzdExpbmUuc3Vic3RyKDEpO1xuICAgIH1cbiAgICBpZiAoZmlyc3RMaW5lLmxlbmd0aCA+IDApIHtcbiAgICAgICAgLy8gV2Ugd2FudCB0byBwcmlvcml0aXplIGFzc29jaWF0aW9ucyBiYXNlZCBvbiB0aGUgb3JkZXIgdGhleSBhcmUgcmVnaXN0ZXJlZCBzbyB0aGF0IHRoZSBsYXN0IHJlZ2lzdGVyZWRcbiAgICAgICAgLy8gYXNzb2NpYXRpb24gd2lucyBvdmVyIGFsbCBvdGhlci4gVGhpcyBpcyBmb3IgaHR0cHM6Ly9naXRodWIuY29tL21pY3Jvc29mdC92c2NvZGUvaXNzdWVzLzIwMDc0XG4gICAgICAgIGZvciAobGV0IGkgPSByZWdpc3RlcmVkQXNzb2NpYXRpb25zLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICBjb25zdCBhc3NvY2lhdGlvbiA9IHJlZ2lzdGVyZWRBc3NvY2lhdGlvbnNbaV07XG4gICAgICAgICAgICBpZiAoIWFzc29jaWF0aW9uLmZpcnN0bGluZSkge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgbWF0Y2hlcyA9IGZpcnN0TGluZS5tYXRjaChhc3NvY2lhdGlvbi5maXJzdGxpbmUpO1xuICAgICAgICAgICAgaWYgKG1hdGNoZXMgJiYgbWF0Y2hlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFzc29jaWF0aW9uO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB1bmRlZmluZWQ7XG59XG4iXSwibmFtZXMiOlsicmVnaXN0ZXJlZEFzc29jaWF0aW9ucyIsIm5vblVzZXJSZWdpc3RlcmVkQXNzb2NpYXRpb25zIiwidXNlclJlZ2lzdGVyZWRBc3NvY2lhdGlvbnMiLCJyZWdpc3RlclBsYXRmb3JtTGFuZ3VhZ2VBc3NvY2lhdGlvbiIsImFzc29jaWF0aW9uIiwid2Fybk9uT3ZlcndyaXRlIiwidXNlckNvbmZpZ3VyZWQiLCJhc3NvY2lhdGlvbkl0ZW0iLCJpZCIsIm1pbWUiLCJmaWxlbmFtZSIsImV4dGVuc2lvbiIsImZpbGVwYXR0ZXJuIiwiZmlyc3RsaW5lIiwiZmlsZW5hbWVMb3dlcmNhc2UiLCJ0b0xvd2VyQ2FzZSIsInVuZGVmaW5lZCIsImV4dGVuc2lvbkxvd2VyY2FzZSIsImZpbGVwYXR0ZXJuTG93ZXJjYXNlIiwiZmlsZXBhdHRlcm5PblBhdGgiLCJpbmRleE9mIiwic2VwIiwidG9MYW5ndWFnZUFzc29jaWF0aW9uSXRlbSIsInB1c2giLCJmb3JFYWNoIiwiYSIsImNvbnNvbGUiLCJ3YXJuIiwiX3JlZ2lzdGVyTGFuZ3VhZ2VBc3NvY2lhdGlvbiIsImNsZWFyUGxhdGZvcm1MYW5ndWFnZUFzc29jaWF0aW9ucyIsImZpbHRlciIsImdldExhbmd1YWdlSWRzIiwicmVzb3VyY2UiLCJmaXJzdExpbmUiLCJwYXRoIiwic2NoZW1lIiwiZmlsZSIsImZzUGF0aCIsImRhdGEiLCJwYXJzZU1ldGFEYXRhIiwiZ2V0IiwiTUVUQV9EQVRBX0xBQkVMIiwidnNjb2RlTm90ZWJvb2tDZWxsIiwidW5rbm93biIsImNvbmZpZ3VyZWRMYW5ndWFnZSIsImdldEFzc29jaWF0aW9uQnlQYXRoIiwidGV4dCIsInJlZ2lzdGVyZWRMYW5ndWFnZSIsImZpcnN0bGluZUxhbmd1YWdlIiwic3Vic3RyIiwibGVuZ3RoIiwiaSIsIm1hdGNoZXMiLCJtYXRjaCIsImdldEFzc29jaWF0aW9uQnlGaXJzdGxpbmUiLCJnZXRBc3NvY2lhdGlvbnMiLCJtYXAiLCJpdGVtIiwiYXNzb2NpYXRpb25zIiwiZmlsZW5hbWVNYXRjaCIsInBhdHRlcm5NYXRjaCIsImV4dGVuc2lvbk1hdGNoIiwidGFyZ2V0IiwiZW5kc1dpdGgiXSwic291cmNlUm9vdCI6IiJ9