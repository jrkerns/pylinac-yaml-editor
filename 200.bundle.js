"use strict";(self.webpackChunkpylinac_yaml_editor=self.webpackChunkpylinac_yaml_editor||[]).push([[200,2230],{8518:(e,t,i)=>{i.d(t,{No:()=>_,TH:()=>h,Zn:()=>d,_1:()=>a,kb:()=>c});var r=i(8019),s=i(3339),n=i(6844);function o(e){return 47===e||92===e}function h(e){return e.replace(/[\\/]/g,r.SA.sep)}function c(e){return-1===e.indexOf("/")&&(e=h(e)),/^[a-zA-Z]:(\/|$)/.test(e)&&(e="/"+e),e}function d(e,t=r.SA.sep){if(!e)return"";const i=e.length,s=e.charCodeAt(0);if(o(s)){if(o(e.charCodeAt(1))&&!o(e.charCodeAt(2))){let r=3;const s=r;for(;r<i&&!o(e.charCodeAt(r));r++);if(s!==r&&!o(e.charCodeAt(r+1)))for(r+=1;r<i;r++)if(o(e.charCodeAt(r)))return e.slice(0,r+1).replace(/[\\/]/g,t)}return t}if(u(s)&&58===e.charCodeAt(1))return o(e.charCodeAt(2))?e.slice(0,2)+t:e.slice(0,2);let n=e.indexOf("://");if(-1!==n)for(n+=3;n<i;n++)if(o(e.charCodeAt(n)))return e.slice(0,n+1);return""}function a(e,t,i,s=r.Vn){if(e===t)return!0;if(!e||!t)return!1;if(t.length>e.length)return!1;if(i){if(!(0,n.ns)(e,t))return!1;if(t.length===e.length)return!0;let i=t.length;return t.charAt(t.length-1)===s&&i--,e.charAt(i)===s}return t.charAt(t.length-1)!==s&&(t+=s),0===e.indexOf(t)}function u(e){return e>=65&&e<=90||e>=97&&e<=122}function _(e,t=s.uF){return!!t&&u(e.charCodeAt(0))&&58===e.charCodeAt(1)}},4403:(e,t,i)=>{i.d(t,{f:()=>n});var r=i(3958),s=i(8019);function n(e,t,i,o,h,c){if(Array.isArray(e)){let r=0;for(const s of e){const e=n(s,t,i,o,h,c);if(10===e)return e;e>r&&(r=e)}return r}if("string"==typeof e)return o?"*"===e?5:e===i?10:0:0;if(e){const{language:n,pattern:d,scheme:a,hasAccessToAllModels:u,notebookType:_}=e;if(!o&&!u)return 0;_&&h&&(t=h);let l=0;if(a)if(a===t.scheme)l=10;else{if("*"!==a)return 0;l=5}if(n)if(n===i)l=10;else{if("*"!==n)return 0;l=Math.max(l,5)}if(_)if(_===c)l=10;else{if("*"!==_||void 0===c)return 0;l=Math.max(l,5)}if(d){let e;if(e="string"==typeof d?d:{...d,base:(0,s.S8)(d.base)},e!==t.fsPath&&!(0,r.YW)(e,t.fsPath))return 0;l=10}return l}return 0}},2230:(e,t,i)=>{i.r(t),i.d(t,{ILanguageFeaturesService:()=>r});const r=(0,i(2399).u1)("ILanguageFeaturesService")},1197:(e,t,i)=>{i.r(t),i.d(t,{LanguageFeaturesService:()=>l});var r=i(2106),s=i(998),n=i(6055),o=i(4403);function h(e){return"string"!=typeof e&&(Array.isArray(e)?e.every(h):!!e.exclusive)}class c{constructor(e,t,i,r,s){this.uri=e,this.languageId=t,this.notebookUri=i,this.notebookType=r,this.recursive=s}equals(e){return this.notebookType===e.notebookType&&this.languageId===e.languageId&&this.uri.toString()===e.uri.toString()&&this.notebookUri?.toString()===e.notebookUri?.toString()&&this.recursive===e.recursive}}class d{constructor(e){this._notebookInfoResolver=e,this._clock=0,this._entries=[],this._onDidChange=new r.vl,this.onDidChange=this._onDidChange.event}register(e,t){let i={selector:e,provider:t,_score:-1,_time:this._clock++};return this._entries.push(i),this._lastCandidate=void 0,this._onDidChange.fire(this._entries.length),(0,s.s)((()=>{if(i){const e=this._entries.indexOf(i);e>=0&&(this._entries.splice(e,1),this._lastCandidate=void 0,this._onDidChange.fire(this._entries.length),i=void 0)}}))}has(e){return this.all(e).length>0}all(e){if(!e)return[];this._updateScores(e,!1);const t=[];for(const e of this._entries)e._score>0&&t.push(e.provider);return t}ordered(e,t=!1){const i=[];return this._orderedForEach(e,t,(e=>i.push(e.provider))),i}orderedGroups(e){const t=[];let i,r;return this._orderedForEach(e,!1,(e=>{i&&r===e._score?i.push(e.provider):(r=e._score,i=[e.provider],t.push(i))})),t}_orderedForEach(e,t,i){this._updateScores(e,t);for(const e of this._entries)e._score>0&&i(e)}_updateScores(e,t){const i=this._notebookInfoResolver?.(e.uri),r=i?new c(e.uri,e.getLanguageId(),i.uri,i.type,t):new c(e.uri,e.getLanguageId(),void 0,void 0,t);if(!this._lastCandidate?.equals(r)){this._lastCandidate=r;for(const i of this._entries)if(i._score=(0,o.f)(i.selector,r.uri,r.languageId,(0,n.vd)(e),r.notebookUri,r.notebookType),h(i.selector)&&i._score>0){if(!t){for(const e of this._entries)e._score=0;i._score=1e3;break}i._score=0}this._entries.sort(d._compareByScoreAndTime)}}static _compareByScoreAndTime(e,t){return e._score<t._score?1:e._score>t._score?-1:a(e.selector)&&!a(t.selector)?1:!a(e.selector)&&a(t.selector)?-1:e._time<t._time?1:e._time>t._time?-1:0}}function a(e){return"string"!=typeof e&&(Array.isArray(e)?e.some(a):Boolean(e.isBuiltin))}var u=i(2230),_=i(6726);class l{constructor(){this.referenceProvider=new d(this._score.bind(this)),this.renameProvider=new d(this._score.bind(this)),this.newSymbolNamesProvider=new d(this._score.bind(this)),this.codeActionProvider=new d(this._score.bind(this)),this.definitionProvider=new d(this._score.bind(this)),this.typeDefinitionProvider=new d(this._score.bind(this)),this.declarationProvider=new d(this._score.bind(this)),this.implementationProvider=new d(this._score.bind(this)),this.documentSymbolProvider=new d(this._score.bind(this)),this.inlayHintsProvider=new d(this._score.bind(this)),this.colorProvider=new d(this._score.bind(this)),this.codeLensProvider=new d(this._score.bind(this)),this.documentFormattingEditProvider=new d(this._score.bind(this)),this.documentRangeFormattingEditProvider=new d(this._score.bind(this)),this.onTypeFormattingEditProvider=new d(this._score.bind(this)),this.signatureHelpProvider=new d(this._score.bind(this)),this.hoverProvider=new d(this._score.bind(this)),this.documentHighlightProvider=new d(this._score.bind(this)),this.multiDocumentHighlightProvider=new d(this._score.bind(this)),this.selectionRangeProvider=new d(this._score.bind(this)),this.foldingRangeProvider=new d(this._score.bind(this)),this.linkProvider=new d(this._score.bind(this)),this.inlineCompletionsProvider=new d(this._score.bind(this)),this.inlineEditProvider=new d(this._score.bind(this)),this.completionProvider=new d(this._score.bind(this)),this.linkedEditingRangeProvider=new d(this._score.bind(this)),this.documentRangeSemanticTokensProvider=new d(this._score.bind(this)),this.documentSemanticTokensProvider=new d(this._score.bind(this)),this.documentDropEditProvider=new d(this._score.bind(this)),this.documentPasteEditProvider=new d(this._score.bind(this))}_score(e){return this._notebookTypeResolver?.(e)}}(0,_.v)(u.ILanguageFeaturesService,l,1)},3312:(e,t,i)=>{i.d(t,{d:()=>r});class r{constructor(e,t=[],i=!1){this.ctor=e,this.staticArguments=t,this.supportsDelayedInstantiation=i}}},6726:(e,t,i)=>{i.d(t,{N:()=>o,v:()=>n});var r=i(3312);const s=[];function n(e,t,i){t instanceof r.d||(t=new r.d(t,[],Boolean(i))),s.push([e,t])}function o(){return s}},2399:(e,t,i)=>{var r;i.d(t,{_$:()=>r,_Y:()=>s,u1:()=>n}),function(e){e.serviceIds=new Map,e.DI_TARGET="$di$target",e.DI_DEPENDENCIES="$di$dependencies",e.getServiceDependencies=function(t){return t[e.DI_DEPENDENCIES]||[]}}(r||(r={}));const s=n("instantiationService");function n(e){if(r.serviceIds.has(e))return r.serviceIds.get(e);const t=function(e,i,s){if(3!==arguments.length)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");!function(e,t,i){t[r.DI_TARGET]===t?t[r.DI_DEPENDENCIES].push({id:e,index:i}):(t[r.DI_DEPENDENCIES]=[{id:e,index:i}],t[r.DI_TARGET]=t)}(t,e,s)};return t.toString=()=>e,r.serviceIds.set(e,t),t}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QyxFQUFrQkMsRUFBSUMsRUFBa0JKLEdBQzlDSSxhQUE0QixNQUM5QkEsRUFBbUIsSUFBSSxJQUFlQSxFQUFrQixHQUFJMUMsUUFBUXNDLEtBRXhFQyxFQUFVakUsS0FBSyxDQUFDbUUsRUFBSUMsR0FDeEIsQ0FDTyxTQUFTQyxJQUNaLE9BQU9KLENBQ1gsQyxpQkNUTyxJQUFJSyxFLG9DQUNYLFNBQVdBLEdBQ1BBLEVBQU1DLFdBQWEsSUFBSUMsSUFDdkJGLEVBQU1HLFVBQVksYUFDbEJILEVBQU1JLGdCQUFrQixtQkFJeEJKLEVBQU1LLHVCQUhOLFNBQWdDYixHQUM1QixPQUFPQSxFQUFLUSxFQUFNSSxrQkFBb0IsRUFDMUMsQ0FFSCxDQVJELENBUUdKLElBQVVBLEVBQVEsQ0FBQyxJQUNmLE1BQU1NLEVBQXdCQyxFQUFnQix3QkFhOUMsU0FBU0EsRUFBZ0JDLEdBQzVCLEdBQUlSLEVBQU1DLFdBQVdsRSxJQUFJeUUsR0FDckIsT0FBT1IsRUFBTUMsV0FBV1EsSUFBSUQsR0FFaEMsTUFBTVgsRUFBSyxTQUFVYSxFQUFRQyxFQUFLQyxHQUM5QixHQUF5QixJQUFyQkMsVUFBVXBKLE9BQ1YsTUFBTSxJQUFJcUosTUFBTSxxRUFsQjVCLFNBQWdDakIsRUFBSWEsRUFBUUUsR0FDcENGLEVBQU9WLEVBQU1HLGFBQWVPLEVBQzVCQSxFQUFPVixFQUFNSSxpQkFBaUIxRSxLQUFLLENBQUVtRSxLQUFJZSxXQUd6Q0YsRUFBT1YsRUFBTUksaUJBQW1CLENBQUMsQ0FBRVAsS0FBSWUsVUFDdkNGLEVBQU9WLEVBQU1HLFdBQWFPLEVBRWxDLENBWVFLLENBQXVCbEIsRUFBSWEsRUFBUUUsRUFDdkMsRUFHQSxPQUZBZixFQUFHaEYsU0FBVyxJQUFNMkYsRUFDcEJSLEVBQU1DLFdBQVdlLElBQUlSLEVBQVdYLEdBQ3pCQSxDQUNYLEMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9weWxpbmFjLXlhbWwtZWRpdG9yLy4vbm9kZV9tb2R1bGVzL21vbmFjby1lZGl0b3IvZXNtL3ZzL2Jhc2UvY29tbW9uL2V4dHBhdGguanMiLCJ3ZWJwYWNrOi8vcHlsaW5hYy15YW1sLWVkaXRvci8uL25vZGVfbW9kdWxlcy9tb25hY28tZWRpdG9yL2VzbS92cy9lZGl0b3IvY29tbW9uL2xhbmd1YWdlU2VsZWN0b3IuanMiLCJ3ZWJwYWNrOi8vcHlsaW5hYy15YW1sLWVkaXRvci8uL25vZGVfbW9kdWxlcy9tb25hY28tZWRpdG9yL2VzbS92cy9lZGl0b3IvY29tbW9uL3NlcnZpY2VzL2xhbmd1YWdlRmVhdHVyZXMuanMiLCJ3ZWJwYWNrOi8vcHlsaW5hYy15YW1sLWVkaXRvci8uL25vZGVfbW9kdWxlcy9tb25hY28tZWRpdG9yL2VzbS92cy9lZGl0b3IvY29tbW9uL2xhbmd1YWdlRmVhdHVyZVJlZ2lzdHJ5LmpzIiwid2VicGFjazovL3B5bGluYWMteWFtbC1lZGl0b3IvLi9ub2RlX21vZHVsZXMvbW9uYWNvLWVkaXRvci9lc20vdnMvZWRpdG9yL2NvbW1vbi9zZXJ2aWNlcy9sYW5ndWFnZUZlYXR1cmVzU2VydmljZS5qcyIsIndlYnBhY2s6Ly9weWxpbmFjLXlhbWwtZWRpdG9yLy4vbm9kZV9tb2R1bGVzL21vbmFjby1lZGl0b3IvZXNtL3ZzL3BsYXRmb3JtL2luc3RhbnRpYXRpb24vY29tbW9uL2Rlc2NyaXB0b3JzLmpzIiwid2VicGFjazovL3B5bGluYWMteWFtbC1lZGl0b3IvLi9ub2RlX21vZHVsZXMvbW9uYWNvLWVkaXRvci9lc20vdnMvcGxhdGZvcm0vaW5zdGFudGlhdGlvbi9jb21tb24vZXh0ZW5zaW9ucy5qcyIsIndlYnBhY2s6Ly9weWxpbmFjLXlhbWwtZWRpdG9yLy4vbm9kZV9tb2R1bGVzL21vbmFjby1lZGl0b3IvZXNtL3ZzL3BsYXRmb3JtL2luc3RhbnRpYXRpb24vY29tbW9uL2luc3RhbnRpYXRpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqICBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqICBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuIFNlZSBMaWNlbnNlLnR4dCBpbiB0aGUgcHJvamVjdCByb290IGZvciBsaWNlbnNlIGluZm9ybWF0aW9uLlxuICotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5pbXBvcnQgeyBwb3NpeCwgc2VwIH0gZnJvbSAnLi9wYXRoLmpzJztcbmltcG9ydCB7IGlzV2luZG93cyB9IGZyb20gJy4vcGxhdGZvcm0uanMnO1xuaW1wb3J0IHsgc3RhcnRzV2l0aElnbm9yZUNhc2UgfSBmcm9tICcuL3N0cmluZ3MuanMnO1xuZXhwb3J0IGZ1bmN0aW9uIGlzUGF0aFNlcGFyYXRvcihjb2RlKSB7XG4gICAgcmV0dXJuIGNvZGUgPT09IDQ3IC8qIENoYXJDb2RlLlNsYXNoICovIHx8IGNvZGUgPT09IDkyIC8qIENoYXJDb2RlLkJhY2tzbGFzaCAqLztcbn1cbi8qKlxuICogVGFrZXMgYSBXaW5kb3dzIE9TIHBhdGggYW5kIGNoYW5nZXMgYmFja3dhcmQgc2xhc2hlcyB0byBmb3J3YXJkIHNsYXNoZXMuXG4gKiBUaGlzIHNob3VsZCBvbmx5IGJlIGRvbmUgZm9yIE9TIHBhdGhzIGZyb20gV2luZG93cyAob3IgdXNlciBwcm92aWRlZCBwYXRocyBwb3RlbnRpYWxseSBmcm9tIFdpbmRvd3MpLlxuICogVXNpbmcgaXQgb24gYSBMaW51eCBvciBNYXhPUyBwYXRoIG1pZ2h0IGNoYW5nZSBpdC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRvU2xhc2hlcyhvc1BhdGgpIHtcbiAgICByZXR1cm4gb3NQYXRoLnJlcGxhY2UoL1tcXFxcL10vZywgcG9zaXguc2VwKTtcbn1cbi8qKlxuICogVGFrZXMgYSBXaW5kb3dzIE9TIHBhdGggKHVzaW5nIGJhY2t3YXJkIG9yIGZvcndhcmQgc2xhc2hlcykgYW5kIHR1cm5zIGl0IGludG8gYSBwb3NpeCBwYXRoOlxuICogLSB0dXJucyBiYWNrd2FyZCBzbGFzaGVzIGludG8gZm9yd2FyZCBzbGFzaGVzXG4gKiAtIG1ha2VzIGl0IGFic29sdXRlIGlmIGl0IHN0YXJ0cyB3aXRoIGEgZHJpdmUgbGV0dGVyXG4gKiBUaGlzIHNob3VsZCBvbmx5IGJlIGRvbmUgZm9yIE9TIHBhdGhzIGZyb20gV2luZG93cyAob3IgdXNlciBwcm92aWRlZCBwYXRocyBwb3RlbnRpYWxseSBmcm9tIFdpbmRvd3MpLlxuICogVXNpbmcgaXQgb24gYSBMaW51eCBvciBNYXhPUyBwYXRoIG1pZ2h0IGNoYW5nZSBpdC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRvUG9zaXhQYXRoKG9zUGF0aCkge1xuICAgIGlmIChvc1BhdGguaW5kZXhPZignLycpID09PSAtMSkge1xuICAgICAgICBvc1BhdGggPSB0b1NsYXNoZXMob3NQYXRoKTtcbiAgICB9XG4gICAgaWYgKC9eW2EtekEtWl06KFxcL3wkKS8udGVzdChvc1BhdGgpKSB7IC8vIHN0YXJ0cyB3aXRoIGEgZHJpdmUgbGV0dGVyXG4gICAgICAgIG9zUGF0aCA9ICcvJyArIG9zUGF0aDtcbiAgICB9XG4gICAgcmV0dXJuIG9zUGF0aDtcbn1cbi8qKlxuICogQ29tcHV0ZXMgdGhlIF9yb290XyB0aGlzIHBhdGgsIGxpa2UgYGdldFJvb3QoJ2M6XFxmaWxlcycpID09PSBjOlxcYCxcbiAqIGBnZXRSb290KCdmaWxlczovLy9maWxlcy9wYXRoJykgPT09IGZpbGVzOi8vL2AsXG4gKiBvciBgZ2V0Um9vdCgnXFxcXHNlcnZlclxcc2hhcmVzXFxwYXRoJykgPT09IFxcXFxzZXJ2ZXJcXHNoYXJlc1xcYFxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0Um9vdChwYXRoLCBzZXAgPSBwb3NpeC5zZXApIHtcbiAgICBpZiAoIXBhdGgpIHtcbiAgICAgICAgcmV0dXJuICcnO1xuICAgIH1cbiAgICBjb25zdCBsZW4gPSBwYXRoLmxlbmd0aDtcbiAgICBjb25zdCBmaXJzdExldHRlciA9IHBhdGguY2hhckNvZGVBdCgwKTtcbiAgICBpZiAoaXNQYXRoU2VwYXJhdG9yKGZpcnN0TGV0dGVyKSkge1xuICAgICAgICBpZiAoaXNQYXRoU2VwYXJhdG9yKHBhdGguY2hhckNvZGVBdCgxKSkpIHtcbiAgICAgICAgICAgIC8vIFVOQyBjYW5kaWRhdGUgXFxcXGxvY2FsaG9zdFxcc2hhcmVzXFxkZGRcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgXl5eXl5eXl5eXl5eXl5eXl5eXlxuICAgICAgICAgICAgaWYgKCFpc1BhdGhTZXBhcmF0b3IocGF0aC5jaGFyQ29kZUF0KDIpKSkge1xuICAgICAgICAgICAgICAgIGxldCBwb3MgPSAzO1xuICAgICAgICAgICAgICAgIGNvbnN0IHN0YXJ0ID0gcG9zO1xuICAgICAgICAgICAgICAgIGZvciAoOyBwb3MgPCBsZW47IHBvcysrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpc1BhdGhTZXBhcmF0b3IocGF0aC5jaGFyQ29kZUF0KHBvcykpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoc3RhcnQgIT09IHBvcyAmJiAhaXNQYXRoU2VwYXJhdG9yKHBhdGguY2hhckNvZGVBdChwb3MgKyAxKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcG9zICs9IDE7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoOyBwb3MgPCBsZW47IHBvcysrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNQYXRoU2VwYXJhdG9yKHBhdGguY2hhckNvZGVBdChwb3MpKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwYXRoLnNsaWNlKDAsIHBvcyArIDEpIC8vIGNvbnN1bWUgdGhpcyBzZXBhcmF0b3JcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoL1tcXFxcL10vZywgc2VwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyAvdXNlci9mYXJcbiAgICAgICAgLy8gXlxuICAgICAgICByZXR1cm4gc2VwO1xuICAgIH1cbiAgICBlbHNlIGlmIChpc1dpbmRvd3NEcml2ZUxldHRlcihmaXJzdExldHRlcikpIHtcbiAgICAgICAgLy8gY2hlY2sgZm9yIHdpbmRvd3MgZHJpdmUgbGV0dGVyIGM6XFwgb3IgYzpcbiAgICAgICAgaWYgKHBhdGguY2hhckNvZGVBdCgxKSA9PT0gNTggLyogQ2hhckNvZGUuQ29sb24gKi8pIHtcbiAgICAgICAgICAgIGlmIChpc1BhdGhTZXBhcmF0b3IocGF0aC5jaGFyQ29kZUF0KDIpKSkge1xuICAgICAgICAgICAgICAgIC8vIEM6XFxmZmZcbiAgICAgICAgICAgICAgICAvLyBeXl5cbiAgICAgICAgICAgICAgICByZXR1cm4gcGF0aC5zbGljZSgwLCAyKSArIHNlcDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIEM6XG4gICAgICAgICAgICAgICAgLy8gXl5cbiAgICAgICAgICAgICAgICByZXR1cm4gcGF0aC5zbGljZSgwLCAyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvLyBjaGVjayBmb3IgVVJJXG4gICAgLy8gc2NoZW1lOi8vYXV0aG9yaXR5L3BhdGhcbiAgICAvLyBeXl5eXl5eXl5eXl5eXl5eXl5eXG4gICAgbGV0IHBvcyA9IHBhdGguaW5kZXhPZignOi8vJyk7XG4gICAgaWYgKHBvcyAhPT0gLTEpIHtcbiAgICAgICAgcG9zICs9IDM7IC8vIDMgLT4gXCI6Ly9cIi5sZW5ndGhcbiAgICAgICAgZm9yICg7IHBvcyA8IGxlbjsgcG9zKyspIHtcbiAgICAgICAgICAgIGlmIChpc1BhdGhTZXBhcmF0b3IocGF0aC5jaGFyQ29kZUF0KHBvcykpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHBhdGguc2xpY2UoMCwgcG9zICsgMSk7IC8vIGNvbnN1bWUgdGhpcyBzZXBhcmF0b3JcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gJyc7XG59XG4vKipcbiAqIEBkZXByZWNhdGVkIHBsZWFzZSB1c2UgYElVcmlJZGVudGl0eVNlcnZpY2UuZXh0VXJpLmlzRXF1YWxPclBhcmVudGAgaW5zdGVhZC4gSWZcbiAqIHlvdSBhcmUgaW4gYSBjb250ZXh0IHdpdGhvdXQgc2VydmljZXMsIGNvbnNpZGVyIHRvIHBhc3MgZG93biB0aGUgYGV4dFVyaWAgZnJvbSB0aGVcbiAqIG91dHNpZGUsIG9yIHVzZSBgZXh0VXJpQmlhc2VkSWdub3JlUGF0aENhc2VgIGlmIHlvdSBrbm93IHdoYXQgeW91IGFyZSBkb2luZy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzRXF1YWxPclBhcmVudChiYXNlLCBwYXJlbnRDYW5kaWRhdGUsIGlnbm9yZUNhc2UsIHNlcGFyYXRvciA9IHNlcCkge1xuICAgIGlmIChiYXNlID09PSBwYXJlbnRDYW5kaWRhdGUpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIGlmICghYmFzZSB8fCAhcGFyZW50Q2FuZGlkYXRlKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKHBhcmVudENhbmRpZGF0ZS5sZW5ndGggPiBiYXNlLmxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmIChpZ25vcmVDYXNlKSB7XG4gICAgICAgIGNvbnN0IGJlZ2luc1dpdGggPSBzdGFydHNXaXRoSWdub3JlQ2FzZShiYXNlLCBwYXJlbnRDYW5kaWRhdGUpO1xuICAgICAgICBpZiAoIWJlZ2luc1dpdGgpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyZW50Q2FuZGlkYXRlLmxlbmd0aCA9PT0gYmFzZS5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlOyAvLyBzYW1lIHBhdGgsIGRpZmZlcmVudCBjYXNpbmdcbiAgICAgICAgfVxuICAgICAgICBsZXQgc2VwT2Zmc2V0ID0gcGFyZW50Q2FuZGlkYXRlLmxlbmd0aDtcbiAgICAgICAgaWYgKHBhcmVudENhbmRpZGF0ZS5jaGFyQXQocGFyZW50Q2FuZGlkYXRlLmxlbmd0aCAtIDEpID09PSBzZXBhcmF0b3IpIHtcbiAgICAgICAgICAgIHNlcE9mZnNldC0tOyAvLyBhZGp1c3QgdGhlIGV4cGVjdGVkIHNlcCBvZmZzZXQgaW4gY2FzZSBvdXIgY2FuZGlkYXRlIGFscmVhZHkgZW5kcyBpbiBzZXBhcmF0b3IgY2hhcmFjdGVyXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGJhc2UuY2hhckF0KHNlcE9mZnNldCkgPT09IHNlcGFyYXRvcjtcbiAgICB9XG4gICAgaWYgKHBhcmVudENhbmRpZGF0ZS5jaGFyQXQocGFyZW50Q2FuZGlkYXRlLmxlbmd0aCAtIDEpICE9PSBzZXBhcmF0b3IpIHtcbiAgICAgICAgcGFyZW50Q2FuZGlkYXRlICs9IHNlcGFyYXRvcjtcbiAgICB9XG4gICAgcmV0dXJuIGJhc2UuaW5kZXhPZihwYXJlbnRDYW5kaWRhdGUpID09PSAwO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGlzV2luZG93c0RyaXZlTGV0dGVyKGNoYXIwKSB7XG4gICAgcmV0dXJuIGNoYXIwID49IDY1IC8qIENoYXJDb2RlLkEgKi8gJiYgY2hhcjAgPD0gOTAgLyogQ2hhckNvZGUuWiAqLyB8fCBjaGFyMCA+PSA5NyAvKiBDaGFyQ29kZS5hICovICYmIGNoYXIwIDw9IDEyMiAvKiBDaGFyQ29kZS56ICovO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGhhc0RyaXZlTGV0dGVyKHBhdGgsIGlzV2luZG93c09TID0gaXNXaW5kb3dzKSB7XG4gICAgaWYgKGlzV2luZG93c09TKSB7XG4gICAgICAgIHJldHVybiBpc1dpbmRvd3NEcml2ZUxldHRlcihwYXRoLmNoYXJDb2RlQXQoMCkpICYmIHBhdGguY2hhckNvZGVBdCgxKSA9PT0gNTggLyogQ2hhckNvZGUuQ29sb24gKi87XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn1cbiIsIi8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiAgQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKiAgTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLiBTZWUgTGljZW5zZS50eHQgaW4gdGhlIHByb2plY3Qgcm9vdCBmb3IgbGljZW5zZSBpbmZvcm1hdGlvbi5cbiAqLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuaW1wb3J0IHsgbWF0Y2ggYXMgbWF0Y2hHbG9iUGF0dGVybiB9IGZyb20gJy4uLy4uL2Jhc2UvY29tbW9uL2dsb2IuanMnO1xuaW1wb3J0IHsgbm9ybWFsaXplIH0gZnJvbSAnLi4vLi4vYmFzZS9jb21tb24vcGF0aC5qcyc7XG5leHBvcnQgZnVuY3Rpb24gc2NvcmUoc2VsZWN0b3IsIGNhbmRpZGF0ZVVyaSwgY2FuZGlkYXRlTGFuZ3VhZ2UsIGNhbmRpZGF0ZUlzU3luY2hyb25pemVkLCBjYW5kaWRhdGVOb3RlYm9va1VyaSwgY2FuZGlkYXRlTm90ZWJvb2tUeXBlKSB7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoc2VsZWN0b3IpKSB7XG4gICAgICAgIC8vIGFycmF5IC0+IHRha2UgbWF4IGluZGl2aWR1YWwgdmFsdWVcbiAgICAgICAgbGV0IHJldCA9IDA7XG4gICAgICAgIGZvciAoY29uc3QgZmlsdGVyIG9mIHNlbGVjdG9yKSB7XG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHNjb3JlKGZpbHRlciwgY2FuZGlkYXRlVXJpLCBjYW5kaWRhdGVMYW5ndWFnZSwgY2FuZGlkYXRlSXNTeW5jaHJvbml6ZWQsIGNhbmRpZGF0ZU5vdGVib29rVXJpLCBjYW5kaWRhdGVOb3RlYm9va1R5cGUpO1xuICAgICAgICAgICAgaWYgKHZhbHVlID09PSAxMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZTsgLy8gYWxyZWFkeSBhdCB0aGUgaGlnaGVzdFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHZhbHVlID4gcmV0KSB7XG4gICAgICAgICAgICAgICAgcmV0ID0gdmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJldDtcbiAgICB9XG4gICAgZWxzZSBpZiAodHlwZW9mIHNlbGVjdG9yID09PSAnc3RyaW5nJykge1xuICAgICAgICBpZiAoIWNhbmRpZGF0ZUlzU3luY2hyb25pemVkKSB7XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuICAgICAgICAvLyBzaG9ydC1oYW5kIG5vdGlvbiwgZGVzdWdhcnMgdG9cbiAgICAgICAgLy8gJ2Zvb0xhbmcnIC0+IHsgbGFuZ3VhZ2U6ICdmb29MYW5nJ31cbiAgICAgICAgLy8gJyonIC0+IHsgbGFuZ3VhZ2U6ICcqJyB9XG4gICAgICAgIGlmIChzZWxlY3RvciA9PT0gJyonKSB7XG4gICAgICAgICAgICByZXR1cm4gNTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChzZWxlY3RvciA9PT0gY2FuZGlkYXRlTGFuZ3VhZ2UpIHtcbiAgICAgICAgICAgIHJldHVybiAxMDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKHNlbGVjdG9yKSB7XG4gICAgICAgIC8vIGZpbHRlciAtPiBzZWxlY3QgYWNjb3JkaW5nbHksIHVzZSBkZWZhdWx0cyBmb3Igc2NoZW1lXG4gICAgICAgIGNvbnN0IHsgbGFuZ3VhZ2UsIHBhdHRlcm4sIHNjaGVtZSwgaGFzQWNjZXNzVG9BbGxNb2RlbHMsIG5vdGVib29rVHlwZSB9ID0gc2VsZWN0b3I7IC8vIFRPRE86IG1pY3Jvc29mdC9UeXBlU2NyaXB0IzQyNzY4XG4gICAgICAgIGlmICghY2FuZGlkYXRlSXNTeW5jaHJvbml6ZWQgJiYgIWhhc0FjY2Vzc1RvQWxsTW9kZWxzKSB7XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuICAgICAgICAvLyBzZWxlY3RvciB0YXJnZXRzIGEgbm90ZWJvb2sgLT4gdXNlIHRoZSBub3RlYm9vayB1cmkgaW5zdGVhZFxuICAgICAgICAvLyBvZiB0aGUgXCJub3JtYWxcIiBkb2N1bWVudCB1cmkuXG4gICAgICAgIGlmIChub3RlYm9va1R5cGUgJiYgY2FuZGlkYXRlTm90ZWJvb2tVcmkpIHtcbiAgICAgICAgICAgIGNhbmRpZGF0ZVVyaSA9IGNhbmRpZGF0ZU5vdGVib29rVXJpO1xuICAgICAgICB9XG4gICAgICAgIGxldCByZXQgPSAwO1xuICAgICAgICBpZiAoc2NoZW1lKSB7XG4gICAgICAgICAgICBpZiAoc2NoZW1lID09PSBjYW5kaWRhdGVVcmkuc2NoZW1lKSB7XG4gICAgICAgICAgICAgICAgcmV0ID0gMTA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChzY2hlbWUgPT09ICcqJykge1xuICAgICAgICAgICAgICAgIHJldCA9IDU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAobGFuZ3VhZ2UpIHtcbiAgICAgICAgICAgIGlmIChsYW5ndWFnZSA9PT0gY2FuZGlkYXRlTGFuZ3VhZ2UpIHtcbiAgICAgICAgICAgICAgICByZXQgPSAxMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGxhbmd1YWdlID09PSAnKicpIHtcbiAgICAgICAgICAgICAgICByZXQgPSBNYXRoLm1heChyZXQsIDUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG5vdGVib29rVHlwZSkge1xuICAgICAgICAgICAgaWYgKG5vdGVib29rVHlwZSA9PT0gY2FuZGlkYXRlTm90ZWJvb2tUeXBlKSB7XG4gICAgICAgICAgICAgICAgcmV0ID0gMTA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChub3RlYm9va1R5cGUgPT09ICcqJyAmJiBjYW5kaWRhdGVOb3RlYm9va1R5cGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHJldCA9IE1hdGgubWF4KHJldCwgNSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAocGF0dGVybikge1xuICAgICAgICAgICAgbGV0IG5vcm1hbGl6ZWRQYXR0ZXJuO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBwYXR0ZXJuID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgIG5vcm1hbGl6ZWRQYXR0ZXJuID0gcGF0dGVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIFNpbmNlIHRoaXMgcGF0dGVybiBoYXMgYSBgYmFzZWAgcHJvcGVydHksIHdlIG5lZWRcbiAgICAgICAgICAgICAgICAvLyB0byBub3JtYWxpemUgdGhpcyBwYXRoIGZpcnN0IGJlZm9yZSBwYXNzaW5nIGl0IG9uXG4gICAgICAgICAgICAgICAgLy8gYmVjYXVzZSB3ZSB3aWxsIGNvbXBhcmUgaXQgYWdhaW5zdCBgVXJpLmZzUGF0aGBcbiAgICAgICAgICAgICAgICAvLyB3aGljaCB1c2VzIHBsYXRmb3JtIHNwZWNpZmljIHNlcGFyYXRvcnMuXG4gICAgICAgICAgICAgICAgLy8gUmVmczogaHR0cHM6Ly9naXRodWIuY29tL21pY3Jvc29mdC92c2NvZGUvaXNzdWVzLzk5OTM4XG4gICAgICAgICAgICAgICAgbm9ybWFsaXplZFBhdHRlcm4gPSB7IC4uLnBhdHRlcm4sIGJhc2U6IG5vcm1hbGl6ZShwYXR0ZXJuLmJhc2UpIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobm9ybWFsaXplZFBhdHRlcm4gPT09IGNhbmRpZGF0ZVVyaS5mc1BhdGggfHwgbWF0Y2hHbG9iUGF0dGVybihub3JtYWxpemVkUGF0dGVybiwgY2FuZGlkYXRlVXJpLmZzUGF0aCkpIHtcbiAgICAgICAgICAgICAgICByZXQgPSAxMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXQ7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gMDtcbiAgICB9XG59XG4iLCIvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICogIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS4gU2VlIExpY2Vuc2UudHh0IGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIGxpY2Vuc2UgaW5mb3JtYXRpb24uXG4gKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cbmltcG9ydCB7IGNyZWF0ZURlY29yYXRvciB9IGZyb20gJy4uLy4uLy4uL3BsYXRmb3JtL2luc3RhbnRpYXRpb24vY29tbW9uL2luc3RhbnRpYXRpb24uanMnO1xuZXhwb3J0IGNvbnN0IElMYW5ndWFnZUZlYXR1cmVzU2VydmljZSA9IGNyZWF0ZURlY29yYXRvcignSUxhbmd1YWdlRmVhdHVyZXNTZXJ2aWNlJyk7XG4iLCIvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICogIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS4gU2VlIExpY2Vuc2UudHh0IGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIGxpY2Vuc2UgaW5mb3JtYXRpb24uXG4gKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cbmltcG9ydCB7IEVtaXR0ZXIgfSBmcm9tICcuLi8uLi9iYXNlL2NvbW1vbi9ldmVudC5qcyc7XG5pbXBvcnQgeyB0b0Rpc3Bvc2FibGUgfSBmcm9tICcuLi8uLi9iYXNlL2NvbW1vbi9saWZlY3ljbGUuanMnO1xuaW1wb3J0IHsgc2hvdWxkU3luY2hyb25pemVNb2RlbCB9IGZyb20gJy4vbW9kZWwuanMnO1xuaW1wb3J0IHsgc2NvcmUgfSBmcm9tICcuL2xhbmd1YWdlU2VsZWN0b3IuanMnO1xuZnVuY3Rpb24gaXNFeGNsdXNpdmUoc2VsZWN0b3IpIHtcbiAgICBpZiAodHlwZW9mIHNlbGVjdG9yID09PSAnc3RyaW5nJykge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoc2VsZWN0b3IpKSB7XG4gICAgICAgIHJldHVybiBzZWxlY3Rvci5ldmVyeShpc0V4Y2x1c2l2ZSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gISFzZWxlY3Rvci5leGNsdXNpdmU7IC8vIFRPRE86IG1pY3Jvc29mdC9UeXBlU2NyaXB0IzQyNzY4XG4gICAgfVxufVxuY2xhc3MgTWF0Y2hDYW5kaWRhdGUge1xuICAgIGNvbnN0cnVjdG9yKHVyaSwgbGFuZ3VhZ2VJZCwgbm90ZWJvb2tVcmksIG5vdGVib29rVHlwZSwgcmVjdXJzaXZlKSB7XG4gICAgICAgIHRoaXMudXJpID0gdXJpO1xuICAgICAgICB0aGlzLmxhbmd1YWdlSWQgPSBsYW5ndWFnZUlkO1xuICAgICAgICB0aGlzLm5vdGVib29rVXJpID0gbm90ZWJvb2tVcmk7XG4gICAgICAgIHRoaXMubm90ZWJvb2tUeXBlID0gbm90ZWJvb2tUeXBlO1xuICAgICAgICB0aGlzLnJlY3Vyc2l2ZSA9IHJlY3Vyc2l2ZTtcbiAgICB9XG4gICAgZXF1YWxzKG90aGVyKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5vdGVib29rVHlwZSA9PT0gb3RoZXIubm90ZWJvb2tUeXBlXG4gICAgICAgICAgICAmJiB0aGlzLmxhbmd1YWdlSWQgPT09IG90aGVyLmxhbmd1YWdlSWRcbiAgICAgICAgICAgICYmIHRoaXMudXJpLnRvU3RyaW5nKCkgPT09IG90aGVyLnVyaS50b1N0cmluZygpXG4gICAgICAgICAgICAmJiB0aGlzLm5vdGVib29rVXJpPy50b1N0cmluZygpID09PSBvdGhlci5ub3RlYm9va1VyaT8udG9TdHJpbmcoKVxuICAgICAgICAgICAgJiYgdGhpcy5yZWN1cnNpdmUgPT09IG90aGVyLnJlY3Vyc2l2ZTtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgTGFuZ3VhZ2VGZWF0dXJlUmVnaXN0cnkge1xuICAgIGNvbnN0cnVjdG9yKF9ub3RlYm9va0luZm9SZXNvbHZlcikge1xuICAgICAgICB0aGlzLl9ub3RlYm9va0luZm9SZXNvbHZlciA9IF9ub3RlYm9va0luZm9SZXNvbHZlcjtcbiAgICAgICAgdGhpcy5fY2xvY2sgPSAwO1xuICAgICAgICB0aGlzLl9lbnRyaWVzID0gW107XG4gICAgICAgIHRoaXMuX29uRGlkQ2hhbmdlID0gbmV3IEVtaXR0ZXIoKTtcbiAgICAgICAgdGhpcy5vbkRpZENoYW5nZSA9IHRoaXMuX29uRGlkQ2hhbmdlLmV2ZW50O1xuICAgIH1cbiAgICByZWdpc3RlcihzZWxlY3RvciwgcHJvdmlkZXIpIHtcbiAgICAgICAgbGV0IGVudHJ5ID0ge1xuICAgICAgICAgICAgc2VsZWN0b3IsXG4gICAgICAgICAgICBwcm92aWRlcixcbiAgICAgICAgICAgIF9zY29yZTogLTEsXG4gICAgICAgICAgICBfdGltZTogdGhpcy5fY2xvY2srK1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLl9lbnRyaWVzLnB1c2goZW50cnkpO1xuICAgICAgICB0aGlzLl9sYXN0Q2FuZGlkYXRlID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLl9vbkRpZENoYW5nZS5maXJlKHRoaXMuX2VudHJpZXMubGVuZ3RoKTtcbiAgICAgICAgcmV0dXJuIHRvRGlzcG9zYWJsZSgoKSA9PiB7XG4gICAgICAgICAgICBpZiAoZW50cnkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBpZHggPSB0aGlzLl9lbnRyaWVzLmluZGV4T2YoZW50cnkpO1xuICAgICAgICAgICAgICAgIGlmIChpZHggPj0gMCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9lbnRyaWVzLnNwbGljZShpZHgsIDEpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9sYXN0Q2FuZGlkYXRlID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9vbkRpZENoYW5nZS5maXJlKHRoaXMuX2VudHJpZXMubGVuZ3RoKTtcbiAgICAgICAgICAgICAgICAgICAgZW50cnkgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgaGFzKG1vZGVsKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFsbChtb2RlbCkubGVuZ3RoID4gMDtcbiAgICB9XG4gICAgYWxsKG1vZGVsKSB7XG4gICAgICAgIGlmICghbW9kZWwpIHtcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl91cGRhdGVTY29yZXMobW9kZWwsIGZhbHNlKTtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gW107XG4gICAgICAgIC8vIGZyb20gcmVnaXN0cnlcbiAgICAgICAgZm9yIChjb25zdCBlbnRyeSBvZiB0aGlzLl9lbnRyaWVzKSB7XG4gICAgICAgICAgICBpZiAoZW50cnkuX3Njb3JlID4gMCkge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKGVudHJ5LnByb3ZpZGVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICBvcmRlcmVkKG1vZGVsLCByZWN1cnNpdmUgPSBmYWxzZSkge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBbXTtcbiAgICAgICAgdGhpcy5fb3JkZXJlZEZvckVhY2gobW9kZWwsIHJlY3Vyc2l2ZSwgZW50cnkgPT4gcmVzdWx0LnB1c2goZW50cnkucHJvdmlkZXIpKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgb3JkZXJlZEdyb3Vwcyhtb2RlbCkge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBbXTtcbiAgICAgICAgbGV0IGxhc3RCdWNrZXQ7XG4gICAgICAgIGxldCBsYXN0QnVja2V0U2NvcmU7XG4gICAgICAgIHRoaXMuX29yZGVyZWRGb3JFYWNoKG1vZGVsLCBmYWxzZSwgZW50cnkgPT4ge1xuICAgICAgICAgICAgaWYgKGxhc3RCdWNrZXQgJiYgbGFzdEJ1Y2tldFNjb3JlID09PSBlbnRyeS5fc2NvcmUpIHtcbiAgICAgICAgICAgICAgICBsYXN0QnVja2V0LnB1c2goZW50cnkucHJvdmlkZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgbGFzdEJ1Y2tldFNjb3JlID0gZW50cnkuX3Njb3JlO1xuICAgICAgICAgICAgICAgIGxhc3RCdWNrZXQgPSBbZW50cnkucHJvdmlkZXJdO1xuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKGxhc3RCdWNrZXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgX29yZGVyZWRGb3JFYWNoKG1vZGVsLCByZWN1cnNpdmUsIGNhbGxiYWNrKSB7XG4gICAgICAgIHRoaXMuX3VwZGF0ZVNjb3Jlcyhtb2RlbCwgcmVjdXJzaXZlKTtcbiAgICAgICAgZm9yIChjb25zdCBlbnRyeSBvZiB0aGlzLl9lbnRyaWVzKSB7XG4gICAgICAgICAgICBpZiAoZW50cnkuX3Njb3JlID4gMCkge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKGVudHJ5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBfdXBkYXRlU2NvcmVzKG1vZGVsLCByZWN1cnNpdmUpIHtcbiAgICAgICAgY29uc3Qgbm90ZWJvb2tJbmZvID0gdGhpcy5fbm90ZWJvb2tJbmZvUmVzb2x2ZXI/Lihtb2RlbC51cmkpO1xuICAgICAgICAvLyB1c2UgdGhlIHVyaSAoc2NoZW1lLCBwYXR0ZXJuKSBvZiB0aGUgbm90ZWJvb2sgaW5mbyBpZmYgd2UgaGF2ZSBvbmVcbiAgICAgICAgLy8gb3RoZXJ3aXNlIGl0J3MgdGhlIG1vZGVsJ3MvZG9jdW1lbnQncyB1cmlcbiAgICAgICAgY29uc3QgY2FuZGlkYXRlID0gbm90ZWJvb2tJbmZvXG4gICAgICAgICAgICA/IG5ldyBNYXRjaENhbmRpZGF0ZShtb2RlbC51cmksIG1vZGVsLmdldExhbmd1YWdlSWQoKSwgbm90ZWJvb2tJbmZvLnVyaSwgbm90ZWJvb2tJbmZvLnR5cGUsIHJlY3Vyc2l2ZSlcbiAgICAgICAgICAgIDogbmV3IE1hdGNoQ2FuZGlkYXRlKG1vZGVsLnVyaSwgbW9kZWwuZ2V0TGFuZ3VhZ2VJZCgpLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgcmVjdXJzaXZlKTtcbiAgICAgICAgaWYgKHRoaXMuX2xhc3RDYW5kaWRhdGU/LmVxdWFscyhjYW5kaWRhdGUpKSB7XG4gICAgICAgICAgICAvLyBub3RoaW5nIGhhcyBjaGFuZ2VkXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fbGFzdENhbmRpZGF0ZSA9IGNhbmRpZGF0ZTtcbiAgICAgICAgZm9yIChjb25zdCBlbnRyeSBvZiB0aGlzLl9lbnRyaWVzKSB7XG4gICAgICAgICAgICBlbnRyeS5fc2NvcmUgPSBzY29yZShlbnRyeS5zZWxlY3RvciwgY2FuZGlkYXRlLnVyaSwgY2FuZGlkYXRlLmxhbmd1YWdlSWQsIHNob3VsZFN5bmNocm9uaXplTW9kZWwobW9kZWwpLCBjYW5kaWRhdGUubm90ZWJvb2tVcmksIGNhbmRpZGF0ZS5ub3RlYm9va1R5cGUpO1xuICAgICAgICAgICAgaWYgKGlzRXhjbHVzaXZlKGVudHJ5LnNlbGVjdG9yKSAmJiBlbnRyeS5fc2NvcmUgPiAwKSB7XG4gICAgICAgICAgICAgICAgaWYgKHJlY3Vyc2l2ZSkge1xuICAgICAgICAgICAgICAgICAgICBlbnRyeS5fc2NvcmUgPSAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gc3VwcG9ydCBmb3Igb25lIGV4Y2x1c2l2ZSBzZWxlY3RvciB0aGF0IG92ZXJ3cml0ZXNcbiAgICAgICAgICAgICAgICAgICAgLy8gYW55IG90aGVyIHNlbGVjdG9yXG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZW50cnkgb2YgdGhpcy5fZW50cmllcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgZW50cnkuX3Njb3JlID0gMDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbnRyeS5fc2NvcmUgPSAxMDAwO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gbmVlZHMgc29ydGluZ1xuICAgICAgICB0aGlzLl9lbnRyaWVzLnNvcnQoTGFuZ3VhZ2VGZWF0dXJlUmVnaXN0cnkuX2NvbXBhcmVCeVNjb3JlQW5kVGltZSk7XG4gICAgfVxuICAgIHN0YXRpYyBfY29tcGFyZUJ5U2NvcmVBbmRUaW1lKGEsIGIpIHtcbiAgICAgICAgaWYgKGEuX3Njb3JlIDwgYi5fc2NvcmUpIHtcbiAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGEuX3Njb3JlID4gYi5fc2NvcmUpIHtcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfVxuICAgICAgICAvLyBEZS1wcmlvcml0aXplIGJ1aWx0LWluIHByb3ZpZGVyc1xuICAgICAgICBpZiAoaXNCdWlsdGluU2VsZWN0b3IoYS5zZWxlY3RvcikgJiYgIWlzQnVpbHRpblNlbGVjdG9yKGIuc2VsZWN0b3IpKSB7XG4gICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICghaXNCdWlsdGluU2VsZWN0b3IoYS5zZWxlY3RvcikgJiYgaXNCdWlsdGluU2VsZWN0b3IoYi5zZWxlY3RvcikpIHtcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYS5fdGltZSA8IGIuX3RpbWUpIHtcbiAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGEuX3RpbWUgPiBiLl90aW1lKSB7XG4gICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIGlzQnVpbHRpblNlbGVjdG9yKHNlbGVjdG9yKSB7XG4gICAgaWYgKHR5cGVvZiBzZWxlY3RvciA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAoQXJyYXkuaXNBcnJheShzZWxlY3RvcikpIHtcbiAgICAgICAgcmV0dXJuIHNlbGVjdG9yLnNvbWUoaXNCdWlsdGluU2VsZWN0b3IpO1xuICAgIH1cbiAgICByZXR1cm4gQm9vbGVhbihzZWxlY3Rvci5pc0J1aWx0aW4pO1xufVxuIiwiLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqICBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqICBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuIFNlZSBMaWNlbnNlLnR4dCBpbiB0aGUgcHJvamVjdCByb290IGZvciBsaWNlbnNlIGluZm9ybWF0aW9uLlxuICotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5pbXBvcnQgeyBMYW5ndWFnZUZlYXR1cmVSZWdpc3RyeSB9IGZyb20gJy4uL2xhbmd1YWdlRmVhdHVyZVJlZ2lzdHJ5LmpzJztcbmltcG9ydCB7IElMYW5ndWFnZUZlYXR1cmVzU2VydmljZSB9IGZyb20gJy4vbGFuZ3VhZ2VGZWF0dXJlcy5qcyc7XG5pbXBvcnQgeyByZWdpc3RlclNpbmdsZXRvbiB9IGZyb20gJy4uLy4uLy4uL3BsYXRmb3JtL2luc3RhbnRpYXRpb24vY29tbW9uL2V4dGVuc2lvbnMuanMnO1xuZXhwb3J0IGNsYXNzIExhbmd1YWdlRmVhdHVyZXNTZXJ2aWNlIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5yZWZlcmVuY2VQcm92aWRlciA9IG5ldyBMYW5ndWFnZUZlYXR1cmVSZWdpc3RyeSh0aGlzLl9zY29yZS5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy5yZW5hbWVQcm92aWRlciA9IG5ldyBMYW5ndWFnZUZlYXR1cmVSZWdpc3RyeSh0aGlzLl9zY29yZS5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy5uZXdTeW1ib2xOYW1lc1Byb3ZpZGVyID0gbmV3IExhbmd1YWdlRmVhdHVyZVJlZ2lzdHJ5KHRoaXMuX3Njb3JlLmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLmNvZGVBY3Rpb25Qcm92aWRlciA9IG5ldyBMYW5ndWFnZUZlYXR1cmVSZWdpc3RyeSh0aGlzLl9zY29yZS5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy5kZWZpbml0aW9uUHJvdmlkZXIgPSBuZXcgTGFuZ3VhZ2VGZWF0dXJlUmVnaXN0cnkodGhpcy5fc2NvcmUuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMudHlwZURlZmluaXRpb25Qcm92aWRlciA9IG5ldyBMYW5ndWFnZUZlYXR1cmVSZWdpc3RyeSh0aGlzLl9zY29yZS5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy5kZWNsYXJhdGlvblByb3ZpZGVyID0gbmV3IExhbmd1YWdlRmVhdHVyZVJlZ2lzdHJ5KHRoaXMuX3Njb3JlLmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLmltcGxlbWVudGF0aW9uUHJvdmlkZXIgPSBuZXcgTGFuZ3VhZ2VGZWF0dXJlUmVnaXN0cnkodGhpcy5fc2NvcmUuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMuZG9jdW1lbnRTeW1ib2xQcm92aWRlciA9IG5ldyBMYW5ndWFnZUZlYXR1cmVSZWdpc3RyeSh0aGlzLl9zY29yZS5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy5pbmxheUhpbnRzUHJvdmlkZXIgPSBuZXcgTGFuZ3VhZ2VGZWF0dXJlUmVnaXN0cnkodGhpcy5fc2NvcmUuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMuY29sb3JQcm92aWRlciA9IG5ldyBMYW5ndWFnZUZlYXR1cmVSZWdpc3RyeSh0aGlzLl9zY29yZS5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy5jb2RlTGVuc1Byb3ZpZGVyID0gbmV3IExhbmd1YWdlRmVhdHVyZVJlZ2lzdHJ5KHRoaXMuX3Njb3JlLmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLmRvY3VtZW50Rm9ybWF0dGluZ0VkaXRQcm92aWRlciA9IG5ldyBMYW5ndWFnZUZlYXR1cmVSZWdpc3RyeSh0aGlzLl9zY29yZS5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy5kb2N1bWVudFJhbmdlRm9ybWF0dGluZ0VkaXRQcm92aWRlciA9IG5ldyBMYW5ndWFnZUZlYXR1cmVSZWdpc3RyeSh0aGlzLl9zY29yZS5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy5vblR5cGVGb3JtYXR0aW5nRWRpdFByb3ZpZGVyID0gbmV3IExhbmd1YWdlRmVhdHVyZVJlZ2lzdHJ5KHRoaXMuX3Njb3JlLmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLnNpZ25hdHVyZUhlbHBQcm92aWRlciA9IG5ldyBMYW5ndWFnZUZlYXR1cmVSZWdpc3RyeSh0aGlzLl9zY29yZS5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy5ob3ZlclByb3ZpZGVyID0gbmV3IExhbmd1YWdlRmVhdHVyZVJlZ2lzdHJ5KHRoaXMuX3Njb3JlLmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLmRvY3VtZW50SGlnaGxpZ2h0UHJvdmlkZXIgPSBuZXcgTGFuZ3VhZ2VGZWF0dXJlUmVnaXN0cnkodGhpcy5fc2NvcmUuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMubXVsdGlEb2N1bWVudEhpZ2hsaWdodFByb3ZpZGVyID0gbmV3IExhbmd1YWdlRmVhdHVyZVJlZ2lzdHJ5KHRoaXMuX3Njb3JlLmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLnNlbGVjdGlvblJhbmdlUHJvdmlkZXIgPSBuZXcgTGFuZ3VhZ2VGZWF0dXJlUmVnaXN0cnkodGhpcy5fc2NvcmUuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMuZm9sZGluZ1JhbmdlUHJvdmlkZXIgPSBuZXcgTGFuZ3VhZ2VGZWF0dXJlUmVnaXN0cnkodGhpcy5fc2NvcmUuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMubGlua1Byb3ZpZGVyID0gbmV3IExhbmd1YWdlRmVhdHVyZVJlZ2lzdHJ5KHRoaXMuX3Njb3JlLmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLmlubGluZUNvbXBsZXRpb25zUHJvdmlkZXIgPSBuZXcgTGFuZ3VhZ2VGZWF0dXJlUmVnaXN0cnkodGhpcy5fc2NvcmUuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMuaW5saW5lRWRpdFByb3ZpZGVyID0gbmV3IExhbmd1YWdlRmVhdHVyZVJlZ2lzdHJ5KHRoaXMuX3Njb3JlLmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLmNvbXBsZXRpb25Qcm92aWRlciA9IG5ldyBMYW5ndWFnZUZlYXR1cmVSZWdpc3RyeSh0aGlzLl9zY29yZS5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy5saW5rZWRFZGl0aW5nUmFuZ2VQcm92aWRlciA9IG5ldyBMYW5ndWFnZUZlYXR1cmVSZWdpc3RyeSh0aGlzLl9zY29yZS5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy5kb2N1bWVudFJhbmdlU2VtYW50aWNUb2tlbnNQcm92aWRlciA9IG5ldyBMYW5ndWFnZUZlYXR1cmVSZWdpc3RyeSh0aGlzLl9zY29yZS5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy5kb2N1bWVudFNlbWFudGljVG9rZW5zUHJvdmlkZXIgPSBuZXcgTGFuZ3VhZ2VGZWF0dXJlUmVnaXN0cnkodGhpcy5fc2NvcmUuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMuZG9jdW1lbnREcm9wRWRpdFByb3ZpZGVyID0gbmV3IExhbmd1YWdlRmVhdHVyZVJlZ2lzdHJ5KHRoaXMuX3Njb3JlLmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLmRvY3VtZW50UGFzdGVFZGl0UHJvdmlkZXIgPSBuZXcgTGFuZ3VhZ2VGZWF0dXJlUmVnaXN0cnkodGhpcy5fc2NvcmUuYmluZCh0aGlzKSk7XG4gICAgfVxuICAgIF9zY29yZSh1cmkpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX25vdGVib29rVHlwZVJlc29sdmVyPy4odXJpKTtcbiAgICB9XG59XG5yZWdpc3RlclNpbmdsZXRvbihJTGFuZ3VhZ2VGZWF0dXJlc1NlcnZpY2UsIExhbmd1YWdlRmVhdHVyZXNTZXJ2aWNlLCAxIC8qIEluc3RhbnRpYXRpb25UeXBlLkRlbGF5ZWQgKi8pO1xuIiwiLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqICBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqICBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuIFNlZSBMaWNlbnNlLnR4dCBpbiB0aGUgcHJvamVjdCByb290IGZvciBsaWNlbnNlIGluZm9ybWF0aW9uLlxuICotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5leHBvcnQgY2xhc3MgU3luY0Rlc2NyaXB0b3Ige1xuICAgIGNvbnN0cnVjdG9yKGN0b3IsIHN0YXRpY0FyZ3VtZW50cyA9IFtdLCBzdXBwb3J0c0RlbGF5ZWRJbnN0YW50aWF0aW9uID0gZmFsc2UpIHtcbiAgICAgICAgdGhpcy5jdG9yID0gY3RvcjtcbiAgICAgICAgdGhpcy5zdGF0aWNBcmd1bWVudHMgPSBzdGF0aWNBcmd1bWVudHM7XG4gICAgICAgIHRoaXMuc3VwcG9ydHNEZWxheWVkSW5zdGFudGlhdGlvbiA9IHN1cHBvcnRzRGVsYXllZEluc3RhbnRpYXRpb247XG4gICAgfVxufVxuIiwiLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqICBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqICBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuIFNlZSBMaWNlbnNlLnR4dCBpbiB0aGUgcHJvamVjdCByb290IGZvciBsaWNlbnNlIGluZm9ybWF0aW9uLlxuICotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5pbXBvcnQgeyBTeW5jRGVzY3JpcHRvciB9IGZyb20gJy4vZGVzY3JpcHRvcnMuanMnO1xuY29uc3QgX3JlZ2lzdHJ5ID0gW107XG5leHBvcnQgZnVuY3Rpb24gcmVnaXN0ZXJTaW5nbGV0b24oaWQsIGN0b3JPckRlc2NyaXB0b3IsIHN1cHBvcnRzRGVsYXllZEluc3RhbnRpYXRpb24pIHtcbiAgICBpZiAoIShjdG9yT3JEZXNjcmlwdG9yIGluc3RhbmNlb2YgU3luY0Rlc2NyaXB0b3IpKSB7XG4gICAgICAgIGN0b3JPckRlc2NyaXB0b3IgPSBuZXcgU3luY0Rlc2NyaXB0b3IoY3Rvck9yRGVzY3JpcHRvciwgW10sIEJvb2xlYW4oc3VwcG9ydHNEZWxheWVkSW5zdGFudGlhdGlvbikpO1xuICAgIH1cbiAgICBfcmVnaXN0cnkucHVzaChbaWQsIGN0b3JPckRlc2NyaXB0b3JdKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBnZXRTaW5nbGV0b25TZXJ2aWNlRGVzY3JpcHRvcnMoKSB7XG4gICAgcmV0dXJuIF9yZWdpc3RyeTtcbn1cbiIsIi8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiAgQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKiAgTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLiBTZWUgTGljZW5zZS50eHQgaW4gdGhlIHByb2plY3Qgcm9vdCBmb3IgbGljZW5zZSBpbmZvcm1hdGlvbi5cbiAqLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuLy8gLS0tLS0tIGludGVybmFsIHV0aWxcbmV4cG9ydCB2YXIgX3V0aWw7XG4oZnVuY3Rpb24gKF91dGlsKSB7XG4gICAgX3V0aWwuc2VydmljZUlkcyA9IG5ldyBNYXAoKTtcbiAgICBfdXRpbC5ESV9UQVJHRVQgPSAnJGRpJHRhcmdldCc7XG4gICAgX3V0aWwuRElfREVQRU5ERU5DSUVTID0gJyRkaSRkZXBlbmRlbmNpZXMnO1xuICAgIGZ1bmN0aW9uIGdldFNlcnZpY2VEZXBlbmRlbmNpZXMoY3Rvcikge1xuICAgICAgICByZXR1cm4gY3RvcltfdXRpbC5ESV9ERVBFTkRFTkNJRVNdIHx8IFtdO1xuICAgIH1cbiAgICBfdXRpbC5nZXRTZXJ2aWNlRGVwZW5kZW5jaWVzID0gZ2V0U2VydmljZURlcGVuZGVuY2llcztcbn0pKF91dGlsIHx8IChfdXRpbCA9IHt9KSk7XG5leHBvcnQgY29uc3QgSUluc3RhbnRpYXRpb25TZXJ2aWNlID0gY3JlYXRlRGVjb3JhdG9yKCdpbnN0YW50aWF0aW9uU2VydmljZScpO1xuZnVuY3Rpb24gc3RvcmVTZXJ2aWNlRGVwZW5kZW5jeShpZCwgdGFyZ2V0LCBpbmRleCkge1xuICAgIGlmICh0YXJnZXRbX3V0aWwuRElfVEFSR0VUXSA9PT0gdGFyZ2V0KSB7XG4gICAgICAgIHRhcmdldFtfdXRpbC5ESV9ERVBFTkRFTkNJRVNdLnB1c2goeyBpZCwgaW5kZXggfSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB0YXJnZXRbX3V0aWwuRElfREVQRU5ERU5DSUVTXSA9IFt7IGlkLCBpbmRleCB9XTtcbiAgICAgICAgdGFyZ2V0W191dGlsLkRJX1RBUkdFVF0gPSB0YXJnZXQ7XG4gICAgfVxufVxuLyoqXG4gKiBUaGUgKm9ubHkqIHZhbGlkIHdheSB0byBjcmVhdGUgYSB7e1NlcnZpY2VJZGVudGlmaWVyfX0uXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVEZWNvcmF0b3Ioc2VydmljZUlkKSB7XG4gICAgaWYgKF91dGlsLnNlcnZpY2VJZHMuaGFzKHNlcnZpY2VJZCkpIHtcbiAgICAgICAgcmV0dXJuIF91dGlsLnNlcnZpY2VJZHMuZ2V0KHNlcnZpY2VJZCk7XG4gICAgfVxuICAgIGNvbnN0IGlkID0gZnVuY3Rpb24gKHRhcmdldCwga2V5LCBpbmRleCkge1xuICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCAhPT0gMykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdASVNlcnZpY2VOYW1lLWRlY29yYXRvciBjYW4gb25seSBiZSB1c2VkIHRvIGRlY29yYXRlIGEgcGFyYW1ldGVyJyk7XG4gICAgICAgIH1cbiAgICAgICAgc3RvcmVTZXJ2aWNlRGVwZW5kZW5jeShpZCwgdGFyZ2V0LCBpbmRleCk7XG4gICAgfTtcbiAgICBpZC50b1N0cmluZyA9ICgpID0+IHNlcnZpY2VJZDtcbiAgICBfdXRpbC5zZXJ2aWNlSWRzLnNldChzZXJ2aWNlSWQsIGlkKTtcbiAgICByZXR1cm4gaWQ7XG59XG4iXSwibmFtZXMiOlsiaXNQYXRoU2VwYXJhdG9yIiwiY29kZSIsInRvU2xhc2hlcyIsIm9zUGF0aCIsInJlcGxhY2UiLCJzZXAiLCJ0b1Bvc2l4UGF0aCIsImluZGV4T2YiLCJ0ZXN0IiwiZ2V0Um9vdCIsInBhdGgiLCJsZW4iLCJsZW5ndGgiLCJmaXJzdExldHRlciIsImNoYXJDb2RlQXQiLCJwb3MiLCJzdGFydCIsInNsaWNlIiwiaXNXaW5kb3dzRHJpdmVMZXR0ZXIiLCJpc0VxdWFsT3JQYXJlbnQiLCJiYXNlIiwicGFyZW50Q2FuZGlkYXRlIiwiaWdub3JlQ2FzZSIsInNlcGFyYXRvciIsInNlcE9mZnNldCIsImNoYXJBdCIsImNoYXIwIiwiaGFzRHJpdmVMZXR0ZXIiLCJpc1dpbmRvd3NPUyIsInNjb3JlIiwic2VsZWN0b3IiLCJjYW5kaWRhdGVVcmkiLCJjYW5kaWRhdGVMYW5ndWFnZSIsImNhbmRpZGF0ZUlzU3luY2hyb25pemVkIiwiY2FuZGlkYXRlTm90ZWJvb2tVcmkiLCJjYW5kaWRhdGVOb3RlYm9va1R5cGUiLCJBcnJheSIsImlzQXJyYXkiLCJyZXQiLCJmaWx0ZXIiLCJ2YWx1ZSIsImxhbmd1YWdlIiwicGF0dGVybiIsInNjaGVtZSIsImhhc0FjY2Vzc1RvQWxsTW9kZWxzIiwibm90ZWJvb2tUeXBlIiwiTWF0aCIsIm1heCIsInVuZGVmaW5lZCIsIm5vcm1hbGl6ZWRQYXR0ZXJuIiwiZnNQYXRoIiwiSUxhbmd1YWdlRmVhdHVyZXNTZXJ2aWNlIiwiaXNFeGNsdXNpdmUiLCJldmVyeSIsImV4Y2x1c2l2ZSIsIk1hdGNoQ2FuZGlkYXRlIiwiY29uc3RydWN0b3IiLCJ1cmkiLCJsYW5ndWFnZUlkIiwibm90ZWJvb2tVcmkiLCJyZWN1cnNpdmUiLCJ0aGlzIiwiZXF1YWxzIiwib3RoZXIiLCJ0b1N0cmluZyIsIkxhbmd1YWdlRmVhdHVyZVJlZ2lzdHJ5IiwiX25vdGVib29rSW5mb1Jlc29sdmVyIiwiX2Nsb2NrIiwiX2VudHJpZXMiLCJfb25EaWRDaGFuZ2UiLCJvbkRpZENoYW5nZSIsImV2ZW50IiwicmVnaXN0ZXIiLCJwcm92aWRlciIsImVudHJ5IiwiX3Njb3JlIiwiX3RpbWUiLCJwdXNoIiwiX2xhc3RDYW5kaWRhdGUiLCJmaXJlIiwiaWR4Iiwic3BsaWNlIiwiaGFzIiwibW9kZWwiLCJhbGwiLCJfdXBkYXRlU2NvcmVzIiwicmVzdWx0Iiwib3JkZXJlZCIsIl9vcmRlcmVkRm9yRWFjaCIsIm9yZGVyZWRHcm91cHMiLCJsYXN0QnVja2V0IiwibGFzdEJ1Y2tldFNjb3JlIiwiY2FsbGJhY2siLCJub3RlYm9va0luZm8iLCJjYW5kaWRhdGUiLCJnZXRMYW5ndWFnZUlkIiwidHlwZSIsInNvcnQiLCJfY29tcGFyZUJ5U2NvcmVBbmRUaW1lIiwiYSIsImIiLCJpc0J1aWx0aW5TZWxlY3RvciIsInNvbWUiLCJCb29sZWFuIiwiaXNCdWlsdGluIiwiTGFuZ3VhZ2VGZWF0dXJlc1NlcnZpY2UiLCJyZWZlcmVuY2VQcm92aWRlciIsImJpbmQiLCJyZW5hbWVQcm92aWRlciIsIm5ld1N5bWJvbE5hbWVzUHJvdmlkZXIiLCJjb2RlQWN0aW9uUHJvdmlkZXIiLCJkZWZpbml0aW9uUHJvdmlkZXIiLCJ0eXBlRGVmaW5pdGlvblByb3ZpZGVyIiwiZGVjbGFyYXRpb25Qcm92aWRlciIsImltcGxlbWVudGF0aW9uUHJvdmlkZXIiLCJkb2N1bWVudFN5bWJvbFByb3ZpZGVyIiwiaW5sYXlIaW50c1Byb3ZpZGVyIiwiY29sb3JQcm92aWRlciIsImNvZGVMZW5zUHJvdmlkZXIiLCJkb2N1bWVudEZvcm1hdHRpbmdFZGl0UHJvdmlkZXIiLCJkb2N1bWVudFJhbmdlRm9ybWF0dGluZ0VkaXRQcm92aWRlciIsIm9uVHlwZUZvcm1hdHRpbmdFZGl0UHJvdmlkZXIiLCJzaWduYXR1cmVIZWxwUHJvdmlkZXIiLCJob3ZlclByb3ZpZGVyIiwiZG9jdW1lbnRIaWdobGlnaHRQcm92aWRlciIsIm11bHRpRG9jdW1lbnRIaWdobGlnaHRQcm92aWRlciIsInNlbGVjdGlvblJhbmdlUHJvdmlkZXIiLCJmb2xkaW5nUmFuZ2VQcm92aWRlciIsImxpbmtQcm92aWRlciIsImlubGluZUNvbXBsZXRpb25zUHJvdmlkZXIiLCJpbmxpbmVFZGl0UHJvdmlkZXIiLCJjb21wbGV0aW9uUHJvdmlkZXIiLCJsaW5rZWRFZGl0aW5nUmFuZ2VQcm92aWRlciIsImRvY3VtZW50UmFuZ2VTZW1hbnRpY1Rva2Vuc1Byb3ZpZGVyIiwiZG9jdW1lbnRTZW1hbnRpY1Rva2Vuc1Byb3ZpZGVyIiwiZG9jdW1lbnREcm9wRWRpdFByb3ZpZGVyIiwiZG9jdW1lbnRQYXN0ZUVkaXRQcm92aWRlciIsIl9ub3RlYm9va1R5cGVSZXNvbHZlciIsIlN5bmNEZXNjcmlwdG9yIiwiY3RvciIsInN0YXRpY0FyZ3VtZW50cyIsInN1cHBvcnRzRGVsYXllZEluc3RhbnRpYXRpb24iLCJfcmVnaXN0cnkiLCJyZWdpc3RlclNpbmdsZXRvbiIsImlkIiwiY3Rvck9yRGVzY3JpcHRvciIsImdldFNpbmdsZXRvblNlcnZpY2VEZXNjcmlwdG9ycyIsIl91dGlsIiwic2VydmljZUlkcyIsIk1hcCIsIkRJX1RBUkdFVCIsIkRJX0RFUEVOREVOQ0lFUyIsImdldFNlcnZpY2VEZXBlbmRlbmNpZXMiLCJJSW5zdGFudGlhdGlvblNlcnZpY2UiLCJjcmVhdGVEZWNvcmF0b3IiLCJzZXJ2aWNlSWQiLCJnZXQiLCJ0YXJnZXQiLCJrZXkiLCJpbmRleCIsImFyZ3VtZW50cyIsIkVycm9yIiwic3RvcmVTZXJ2aWNlRGVwZW5kZW5jeSIsInNldCJdLCJzb3VyY2VSb290IjoiIn0=