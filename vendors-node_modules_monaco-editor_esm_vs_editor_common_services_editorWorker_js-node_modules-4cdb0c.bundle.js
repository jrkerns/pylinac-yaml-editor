"use strict";
(self["webpackChunkpylinac_yaml_editor"] = self["webpackChunkpylinac_yaml_editor"] || []).push([["vendors-node_modules_monaco-editor_esm_vs_editor_common_services_editorWorker_js-node_modules-4cdb0c"],{

/***/ "./node_modules/monaco-editor/esm/vs/base/common/numbers.js":
/*!******************************************************************!*\
  !*** ./node_modules/monaco-editor/esm/vs/base/common/numbers.js ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   MovingAverage: () => (/* binding */ MovingAverage),
/* harmony export */   SlidingWindowAverage: () => (/* binding */ SlidingWindowAverage),
/* harmony export */   clamp: () => (/* binding */ clamp)
/* harmony export */ });
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/
function clamp(value, min, max) {
    return Math.min(Math.max(value, min), max);
}
class MovingAverage {
    constructor() {
        this._n = 1;
        this._val = 0;
    }
    update(value) {
        this._val = this._val + (value - this._val) / this._n;
        this._n += 1;
        return this._val;
    }
    get value() {
        return this._val;
    }
}
class SlidingWindowAverage {
    constructor(size) {
        this._n = 0;
        this._val = 0;
        this._values = [];
        this._index = 0;
        this._sum = 0;
        this._values = new Array(size);
        this._values.fill(0, 0, size);
    }
    update(value) {
        const oldValue = this._values[this._index];
        this._values[this._index] = value;
        this._index = (this._index + 1) % this._values.length;
        this._sum -= oldValue;
        this._sum += value;
        if (this._n < this._values.length) {
            this._n += 1;
        }
        this._val = this._sum / this._n;
        return this._val;
    }
    get value() {
        return this._val;
    }
}


/***/ }),

/***/ "./node_modules/monaco-editor/esm/vs/base/common/themables.js":
/*!********************************************************************!*\
  !*** ./node_modules/monaco-editor/esm/vs/base/common/themables.js ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ThemeColor: () => (/* binding */ ThemeColor),
/* harmony export */   ThemeIcon: () => (/* binding */ ThemeIcon)
/* harmony export */ });
/* harmony import */ var _codicons_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./codicons.js */ "./node_modules/monaco-editor/esm/vs/base/common/codicons.js");
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

var ThemeColor;
(function (ThemeColor) {
    function isThemeColor(obj) {
        return obj && typeof obj === 'object' && typeof obj.id === 'string';
    }
    ThemeColor.isThemeColor = isThemeColor;
})(ThemeColor || (ThemeColor = {}));
var ThemeIcon;
(function (ThemeIcon) {
    ThemeIcon.iconNameSegment = '[A-Za-z0-9]+';
    ThemeIcon.iconNameExpression = '[A-Za-z0-9-]+';
    ThemeIcon.iconModifierExpression = '~[A-Za-z]+';
    ThemeIcon.iconNameCharacter = '[A-Za-z0-9~-]';
    const ThemeIconIdRegex = new RegExp(`^(${ThemeIcon.iconNameExpression})(${ThemeIcon.iconModifierExpression})?$`);
    function asClassNameArray(icon) {
        const match = ThemeIconIdRegex.exec(icon.id);
        if (!match) {
            return asClassNameArray(_codicons_js__WEBPACK_IMPORTED_MODULE_0__.Codicon.error);
        }
        const [, id, modifier] = match;
        const classNames = ['codicon', 'codicon-' + id];
        if (modifier) {
            classNames.push('codicon-modifier-' + modifier.substring(1));
        }
        return classNames;
    }
    ThemeIcon.asClassNameArray = asClassNameArray;
    function asClassName(icon) {
        return asClassNameArray(icon).join(' ');
    }
    ThemeIcon.asClassName = asClassName;
    function asCSSSelector(icon) {
        return '.' + asClassNameArray(icon).join('.');
    }
    ThemeIcon.asCSSSelector = asCSSSelector;
    function isThemeIcon(obj) {
        return obj && typeof obj === 'object' && typeof obj.id === 'string' && (typeof obj.color === 'undefined' || ThemeColor.isThemeColor(obj.color));
    }
    ThemeIcon.isThemeIcon = isThemeIcon;
    const _regexFromString = new RegExp(`^\\$\\((${ThemeIcon.iconNameExpression}(?:${ThemeIcon.iconModifierExpression})?)\\)$`);
    function fromString(str) {
        const match = _regexFromString.exec(str);
        if (!match) {
            return undefined;
        }
        const [, name] = match;
        return { id: name };
    }
    ThemeIcon.fromString = fromString;
    function fromId(id) {
        return { id };
    }
    ThemeIcon.fromId = fromId;
    function modify(icon, modifier) {
        let id = icon.id;
        const tildeIndex = id.lastIndexOf('~');
        if (tildeIndex !== -1) {
            id = id.substring(0, tildeIndex);
        }
        if (modifier) {
            id = `${id}~${modifier}`;
        }
        return { id };
    }
    ThemeIcon.modify = modify;
    function getModifier(icon) {
        const tildeIndex = icon.id.lastIndexOf('~');
        if (tildeIndex !== -1) {
            return icon.id.substring(tildeIndex + 1);
        }
        return undefined;
    }
    ThemeIcon.getModifier = getModifier;
    function isEqual(ti1, ti2) {
        return ti1.id === ti2.id && ti1.color?.id === ti2.color?.id;
    }
    ThemeIcon.isEqual = isEqual;
})(ThemeIcon || (ThemeIcon = {}));


/***/ }),

/***/ "./node_modules/monaco-editor/esm/vs/editor/common/services/editorWorker.js":
/*!**********************************************************************************!*\
  !*** ./node_modules/monaco-editor/esm/vs/editor/common/services/editorWorker.js ***!
  \**********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   IEditorWorkerService: () => (/* binding */ IEditorWorkerService)
/* harmony export */ });
/* harmony import */ var _platform_instantiation_common_instantiation_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../platform/instantiation/common/instantiation.js */ "./node_modules/monaco-editor/esm/vs/platform/instantiation/common/instantiation.js");
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

const IEditorWorkerService = (0,_platform_instantiation_common_instantiation_js__WEBPACK_IMPORTED_MODULE_0__.createDecorator)('editorWorkerService');


/***/ }),

/***/ "./node_modules/monaco-editor/esm/vs/editor/common/services/getIconClasses.js":
/*!************************************************************************************!*\
  !*** ./node_modules/monaco-editor/esm/vs/editor/common/services/getIconClasses.js ***!
  \************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   getIconClasses: () => (/* binding */ getIconClasses)
/* harmony export */ });
/* harmony import */ var _base_common_network_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../base/common/network.js */ "./node_modules/monaco-editor/esm/vs/base/common/network.js");
/* harmony import */ var _base_common_resources_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../base/common/resources.js */ "./node_modules/monaco-editor/esm/vs/base/common/resources.js");
/* harmony import */ var _base_common_uri_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../base/common/uri.js */ "./node_modules/monaco-editor/esm/vs/base/common/uri.js");
/* harmony import */ var _languages_modesRegistry_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../languages/modesRegistry.js */ "./node_modules/monaco-editor/esm/vs/editor/common/languages/modesRegistry.js");
/* harmony import */ var _platform_files_common_files_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../platform/files/common/files.js */ "./node_modules/monaco-editor/esm/vs/platform/files/common/files.js");
/* harmony import */ var _base_common_themables_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../base/common/themables.js */ "./node_modules/monaco-editor/esm/vs/base/common/themables.js");
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/






const fileIconDirectoryRegex = /(?:\/|^)(?:([^\/]+)\/)?([^\/]+)$/;
function getIconClasses(modelService, languageService, resource, fileKind, icon) {
    if (_base_common_themables_js__WEBPACK_IMPORTED_MODULE_5__.ThemeIcon.isThemeIcon(icon)) {
        return [`codicon-${icon.id}`, 'predefined-file-icon'];
    }
    if (_base_common_uri_js__WEBPACK_IMPORTED_MODULE_2__.URI.isUri(icon)) {
        return [];
    }
    // we always set these base classes even if we do not have a path
    const classes = fileKind === _platform_files_common_files_js__WEBPACK_IMPORTED_MODULE_4__.FileKind.ROOT_FOLDER ? ['rootfolder-icon'] : fileKind === _platform_files_common_files_js__WEBPACK_IMPORTED_MODULE_4__.FileKind.FOLDER ? ['folder-icon'] : ['file-icon'];
    if (resource) {
        // Get the path and name of the resource. For data-URIs, we need to parse specially
        let name;
        if (resource.scheme === _base_common_network_js__WEBPACK_IMPORTED_MODULE_0__.Schemas.data) {
            const metadata = _base_common_resources_js__WEBPACK_IMPORTED_MODULE_1__.DataUri.parseMetaData(resource);
            name = metadata.get(_base_common_resources_js__WEBPACK_IMPORTED_MODULE_1__.DataUri.META_DATA_LABEL);
        }
        else {
            const match = resource.path.match(fileIconDirectoryRegex);
            if (match) {
                name = cssEscape(match[2].toLowerCase());
                if (match[1]) {
                    classes.push(`${cssEscape(match[1].toLowerCase())}-name-dir-icon`); // parent directory
                }
            }
            else {
                name = cssEscape(resource.authority.toLowerCase());
            }
        }
        // Root Folders
        if (fileKind === _platform_files_common_files_js__WEBPACK_IMPORTED_MODULE_4__.FileKind.ROOT_FOLDER) {
            classes.push(`${name}-root-name-folder-icon`);
        }
        // Folders
        else if (fileKind === _platform_files_common_files_js__WEBPACK_IMPORTED_MODULE_4__.FileKind.FOLDER) {
            classes.push(`${name}-name-folder-icon`);
        }
        // Files
        else {
            // Name & Extension(s)
            if (name) {
                classes.push(`${name}-name-file-icon`);
                classes.push(`name-file-icon`); // extra segment to increase file-name score
                // Avoid doing an explosive combination of extensions for very long filenames
                // (most file systems do not allow files > 255 length) with lots of `.` characters
                // https://github.com/microsoft/vscode/issues/116199
                if (name.length <= 255) {
                    const dotSegments = name.split('.');
                    for (let i = 1; i < dotSegments.length; i++) {
                        classes.push(`${dotSegments.slice(i).join('.')}-ext-file-icon`); // add each combination of all found extensions if more than one
                    }
                }
                classes.push(`ext-file-icon`); // extra segment to increase file-ext score
            }
            // Detected Mode
            const detectedLanguageId = detectLanguageId(modelService, languageService, resource);
            if (detectedLanguageId) {
                classes.push(`${cssEscape(detectedLanguageId)}-lang-file-icon`);
            }
        }
    }
    return classes;
}
function detectLanguageId(modelService, languageService, resource) {
    if (!resource) {
        return null; // we need a resource at least
    }
    let languageId = null;
    // Data URI: check for encoded metadata
    if (resource.scheme === _base_common_network_js__WEBPACK_IMPORTED_MODULE_0__.Schemas.data) {
        const metadata = _base_common_resources_js__WEBPACK_IMPORTED_MODULE_1__.DataUri.parseMetaData(resource);
        const mime = metadata.get(_base_common_resources_js__WEBPACK_IMPORTED_MODULE_1__.DataUri.META_DATA_MIME);
        if (mime) {
            languageId = languageService.getLanguageIdByMimeType(mime);
        }
    }
    // Any other URI: check for model if existing
    else {
        const model = modelService.getModel(resource);
        if (model) {
            languageId = model.getLanguageId();
        }
    }
    // only take if the language id is specific (aka no just plain text)
    if (languageId && languageId !== _languages_modesRegistry_js__WEBPACK_IMPORTED_MODULE_3__.PLAINTEXT_LANGUAGE_ID) {
        return languageId;
    }
    // otherwise fallback to path based detection
    return languageService.guessLanguageIdByFilepathOrFirstLine(resource);
}
function cssEscape(str) {
    return str.replace(/[\s]/g, '/'); // HTML class names can not contain certain whitespace characters (https://dom.spec.whatwg.org/#interface-domtokenlist), use / instead, which doesn't exist in file names.
}


/***/ }),

/***/ "./node_modules/monaco-editor/esm/vs/editor/common/services/languageFeatureDebounce.js":
/*!*********************************************************************************************!*\
  !*** ./node_modules/monaco-editor/esm/vs/editor/common/services/languageFeatureDebounce.js ***!
  \*********************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ILanguageFeatureDebounceService: () => (/* binding */ ILanguageFeatureDebounceService),
/* harmony export */   LanguageFeatureDebounceService: () => (/* binding */ LanguageFeatureDebounceService)
/* harmony export */ });
/* harmony import */ var _base_common_hash_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../base/common/hash.js */ "./node_modules/monaco-editor/esm/vs/base/common/hash.js");
/* harmony import */ var _base_common_map_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../base/common/map.js */ "./node_modules/monaco-editor/esm/vs/base/common/map.js");
/* harmony import */ var _base_common_numbers_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../base/common/numbers.js */ "./node_modules/monaco-editor/esm/vs/base/common/numbers.js");
/* harmony import */ var _platform_environment_common_environment_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../platform/environment/common/environment.js */ "./node_modules/monaco-editor/esm/vs/platform/environment/common/environment.js");
/* harmony import */ var _platform_instantiation_common_extensions_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../platform/instantiation/common/extensions.js */ "./node_modules/monaco-editor/esm/vs/platform/instantiation/common/extensions.js");
/* harmony import */ var _platform_instantiation_common_instantiation_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../platform/instantiation/common/instantiation.js */ "./node_modules/monaco-editor/esm/vs/platform/instantiation/common/instantiation.js");
/* harmony import */ var _platform_log_common_log_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../platform/log/common/log.js */ "./node_modules/monaco-editor/esm/vs/platform/log/common/log.js");
/* harmony import */ var _base_common_network_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../base/common/network.js */ "./node_modules/monaco-editor/esm/vs/base/common/network.js");
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __param = (undefined && undefined.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};








const ILanguageFeatureDebounceService = (0,_platform_instantiation_common_instantiation_js__WEBPACK_IMPORTED_MODULE_5__.createDecorator)('ILanguageFeatureDebounceService');
var IdentityHash;
(function (IdentityHash) {
    const _hashes = new WeakMap();
    let pool = 0;
    function of(obj) {
        let value = _hashes.get(obj);
        if (value === undefined) {
            value = ++pool;
            _hashes.set(obj, value);
        }
        return value;
    }
    IdentityHash.of = of;
})(IdentityHash || (IdentityHash = {}));
class NullDebounceInformation {
    constructor(_default) {
        this._default = _default;
    }
    get(_model) {
        return this._default;
    }
    update(_model, _value) {
        return this._default;
    }
    default() {
        return this._default;
    }
}
class FeatureDebounceInformation {
    constructor(_logService, _name, _registry, _default, _min, _max) {
        this._logService = _logService;
        this._name = _name;
        this._registry = _registry;
        this._default = _default;
        this._min = _min;
        this._max = _max;
        this._cache = new _base_common_map_js__WEBPACK_IMPORTED_MODULE_1__.LRUCache(50, 0.7);
    }
    _key(model) {
        return model.id + this._registry.all(model).reduce((hashVal, obj) => (0,_base_common_hash_js__WEBPACK_IMPORTED_MODULE_0__.doHash)(IdentityHash.of(obj), hashVal), 0);
    }
    get(model) {
        const key = this._key(model);
        const avg = this._cache.get(key);
        return avg
            ? (0,_base_common_numbers_js__WEBPACK_IMPORTED_MODULE_2__.clamp)(avg.value, this._min, this._max)
            : this.default();
    }
    update(model, value) {
        const key = this._key(model);
        let avg = this._cache.get(key);
        if (!avg) {
            avg = new _base_common_numbers_js__WEBPACK_IMPORTED_MODULE_2__.SlidingWindowAverage(6);
            this._cache.set(key, avg);
        }
        const newValue = (0,_base_common_numbers_js__WEBPACK_IMPORTED_MODULE_2__.clamp)(avg.update(value), this._min, this._max);
        if (!(0,_base_common_network_js__WEBPACK_IMPORTED_MODULE_7__.matchesScheme)(model.uri, 'output')) {
            this._logService.trace(`[DEBOUNCE: ${this._name}] for ${model.uri.toString()} is ${newValue}ms`);
        }
        return newValue;
    }
    _overall() {
        const result = new _base_common_numbers_js__WEBPACK_IMPORTED_MODULE_2__.MovingAverage();
        for (const [, avg] of this._cache) {
            result.update(avg.value);
        }
        return result.value;
    }
    default() {
        const value = (this._overall() | 0) || this._default;
        return (0,_base_common_numbers_js__WEBPACK_IMPORTED_MODULE_2__.clamp)(value, this._min, this._max);
    }
}
let LanguageFeatureDebounceService = class LanguageFeatureDebounceService {
    constructor(_logService, envService) {
        this._logService = _logService;
        this._data = new Map();
        this._isDev = envService.isExtensionDevelopment || !envService.isBuilt;
    }
    for(feature, name, config) {
        const min = config?.min ?? 50;
        const max = config?.max ?? min ** 2;
        const extra = config?.key ?? undefined;
        const key = `${IdentityHash.of(feature)},${min}${extra ? ',' + extra : ''}`;
        let info = this._data.get(key);
        if (!info) {
            if (this._isDev) {
                this._logService.debug(`[DEBOUNCE: ${name}] is disabled in developed mode`);
                info = new NullDebounceInformation(min * 1.5);
            }
            else {
                info = new FeatureDebounceInformation(this._logService, name, feature, (this._overallAverage() | 0) || (min * 1.5), // default is overall default or derived from min-value
                min, max);
            }
            this._data.set(key, info);
        }
        return info;
    }
    _overallAverage() {
        // Average of all language features. Not a great value but an approximation
        const result = new _base_common_numbers_js__WEBPACK_IMPORTED_MODULE_2__.MovingAverage();
        for (const info of this._data.values()) {
            result.update(info.default());
        }
        return result.value;
    }
};
LanguageFeatureDebounceService = __decorate([
    __param(0, _platform_log_common_log_js__WEBPACK_IMPORTED_MODULE_6__.ILogService),
    __param(1, _platform_environment_common_environment_js__WEBPACK_IMPORTED_MODULE_3__.IEnvironmentService)
], LanguageFeatureDebounceService);

(0,_platform_instantiation_common_extensions_js__WEBPACK_IMPORTED_MODULE_4__.registerSingleton)(ILanguageFeatureDebounceService, LanguageFeatureDebounceService, 1 /* InstantiationType.Delayed */);


/***/ }),

/***/ "./node_modules/monaco-editor/esm/vs/editor/common/services/markerDecorations.js":
/*!***************************************************************************************!*\
  !*** ./node_modules/monaco-editor/esm/vs/editor/common/services/markerDecorations.js ***!
  \***************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   IMarkerDecorationsService: () => (/* binding */ IMarkerDecorationsService)
/* harmony export */ });
/* harmony import */ var _platform_instantiation_common_instantiation_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../platform/instantiation/common/instantiation.js */ "./node_modules/monaco-editor/esm/vs/platform/instantiation/common/instantiation.js");
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

const IMarkerDecorationsService = (0,_platform_instantiation_common_instantiation_js__WEBPACK_IMPORTED_MODULE_0__.createDecorator)('markerDecorationsService');


/***/ }),

/***/ "./node_modules/monaco-editor/esm/vs/editor/common/services/resolverService.js":
/*!*************************************************************************************!*\
  !*** ./node_modules/monaco-editor/esm/vs/editor/common/services/resolverService.js ***!
  \*************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ITextModelService: () => (/* binding */ ITextModelService)
/* harmony export */ });
/* harmony import */ var _platform_instantiation_common_instantiation_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../platform/instantiation/common/instantiation.js */ "./node_modules/monaco-editor/esm/vs/platform/instantiation/common/instantiation.js");

const ITextModelService = (0,_platform_instantiation_common_instantiation_js__WEBPACK_IMPORTED_MODULE_0__.createDecorator)('textModelService');


/***/ }),

/***/ "./node_modules/monaco-editor/esm/vs/editor/common/services/semanticTokensDto.js":
/*!***************************************************************************************!*\
  !*** ./node_modules/monaco-editor/esm/vs/editor/common/services/semanticTokensDto.js ***!
  \***************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   encodeSemanticTokensDto: () => (/* binding */ encodeSemanticTokensDto)
/* harmony export */ });
/* harmony import */ var _base_common_buffer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../base/common/buffer.js */ "./node_modules/monaco-editor/esm/vs/base/common/buffer.js");
/* harmony import */ var _base_common_platform_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../base/common/platform.js */ "./node_modules/monaco-editor/esm/vs/base/common/platform.js");
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/


function reverseEndianness(arr) {
    for (let i = 0, len = arr.length; i < len; i += 4) {
        // flip bytes 0<->3 and 1<->2
        const b0 = arr[i + 0];
        const b1 = arr[i + 1];
        const b2 = arr[i + 2];
        const b3 = arr[i + 3];
        arr[i + 0] = b3;
        arr[i + 1] = b2;
        arr[i + 2] = b1;
        arr[i + 3] = b0;
    }
}
function toLittleEndianBuffer(arr) {
    const uint8Arr = new Uint8Array(arr.buffer, arr.byteOffset, arr.length * 4);
    if (!_base_common_platform_js__WEBPACK_IMPORTED_MODULE_1__.isLittleEndian()) {
        // the byte order must be changed
        reverseEndianness(uint8Arr);
    }
    return _base_common_buffer_js__WEBPACK_IMPORTED_MODULE_0__.VSBuffer.wrap(uint8Arr);
}
function encodeSemanticTokensDto(semanticTokens) {
    const dest = new Uint32Array(encodeSemanticTokensDtoSize(semanticTokens));
    let offset = 0;
    dest[offset++] = semanticTokens.id;
    if (semanticTokens.type === 'full') {
        dest[offset++] = 1 /* EncodedSemanticTokensType.Full */;
        dest[offset++] = semanticTokens.data.length;
        dest.set(semanticTokens.data, offset);
        offset += semanticTokens.data.length;
    }
    else {
        dest[offset++] = 2 /* EncodedSemanticTokensType.Delta */;
        dest[offset++] = semanticTokens.deltas.length;
        for (const delta of semanticTokens.deltas) {
            dest[offset++] = delta.start;
            dest[offset++] = delta.deleteCount;
            if (delta.data) {
                dest[offset++] = delta.data.length;
                dest.set(delta.data, offset);
                offset += delta.data.length;
            }
            else {
                dest[offset++] = 0;
            }
        }
    }
    return toLittleEndianBuffer(dest);
}
function encodeSemanticTokensDtoSize(semanticTokens) {
    let result = 0;
    result += (+1 // id
        + 1 // type
    );
    if (semanticTokens.type === 'full') {
        result += (+1 // data length
            + semanticTokens.data.length);
    }
    else {
        result += (+1 // delta count
        );
        result += (+1 // start
            + 1 // deleteCount
            + 1 // data length
        ) * semanticTokens.deltas.length;
        for (const delta of semanticTokens.deltas) {
            if (delta.data) {
                result += delta.data.length;
            }
        }
    }
    return result;
}


/***/ }),

/***/ "./node_modules/monaco-editor/esm/vs/editor/common/services/semanticTokensStyling.js":
/*!*******************************************************************************************!*\
  !*** ./node_modules/monaco-editor/esm/vs/editor/common/services/semanticTokensStyling.js ***!
  \*******************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ISemanticTokensStylingService: () => (/* binding */ ISemanticTokensStylingService)
/* harmony export */ });
/* harmony import */ var _platform_instantiation_common_instantiation_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../platform/instantiation/common/instantiation.js */ "./node_modules/monaco-editor/esm/vs/platform/instantiation/common/instantiation.js");
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

const ISemanticTokensStylingService = (0,_platform_instantiation_common_instantiation_js__WEBPACK_IMPORTED_MODULE_0__.createDecorator)('semanticTokensStylingService');


/***/ }),

/***/ "./node_modules/monaco-editor/esm/vs/editor/common/services/semanticTokensStylingService.js":
/*!**************************************************************************************************!*\
  !*** ./node_modules/monaco-editor/esm/vs/editor/common/services/semanticTokensStylingService.js ***!
  \**************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   SemanticTokensStylingService: () => (/* binding */ SemanticTokensStylingService)
/* harmony export */ });
/* harmony import */ var _base_common_lifecycle_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../base/common/lifecycle.js */ "./node_modules/monaco-editor/esm/vs/base/common/lifecycle.js");
/* harmony import */ var _languages_language_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../languages/language.js */ "./node_modules/monaco-editor/esm/vs/editor/common/languages/language.js");
/* harmony import */ var _platform_theme_common_themeService_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../platform/theme/common/themeService.js */ "./node_modules/monaco-editor/esm/vs/platform/theme/common/themeService.js");
/* harmony import */ var _platform_log_common_log_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../platform/log/common/log.js */ "./node_modules/monaco-editor/esm/vs/platform/log/common/log.js");
/* harmony import */ var _semanticTokensProviderStyling_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./semanticTokensProviderStyling.js */ "./node_modules/monaco-editor/esm/vs/editor/common/services/semanticTokensProviderStyling.js");
/* harmony import */ var _semanticTokensStyling_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./semanticTokensStyling.js */ "./node_modules/monaco-editor/esm/vs/editor/common/services/semanticTokensStyling.js");
/* harmony import */ var _platform_instantiation_common_extensions_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../platform/instantiation/common/extensions.js */ "./node_modules/monaco-editor/esm/vs/platform/instantiation/common/extensions.js");
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __param = (undefined && undefined.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};







let SemanticTokensStylingService = class SemanticTokensStylingService extends _base_common_lifecycle_js__WEBPACK_IMPORTED_MODULE_0__.Disposable {
    constructor(_themeService, _logService, _languageService) {
        super();
        this._themeService = _themeService;
        this._logService = _logService;
        this._languageService = _languageService;
        this._caches = new WeakMap();
        this._register(this._themeService.onDidColorThemeChange(() => {
            this._caches = new WeakMap();
        }));
    }
    getStyling(provider) {
        if (!this._caches.has(provider)) {
            this._caches.set(provider, new _semanticTokensProviderStyling_js__WEBPACK_IMPORTED_MODULE_4__.SemanticTokensProviderStyling(provider.getLegend(), this._themeService, this._languageService, this._logService));
        }
        return this._caches.get(provider);
    }
};
SemanticTokensStylingService = __decorate([
    __param(0, _platform_theme_common_themeService_js__WEBPACK_IMPORTED_MODULE_2__.IThemeService),
    __param(1, _platform_log_common_log_js__WEBPACK_IMPORTED_MODULE_3__.ILogService),
    __param(2, _languages_language_js__WEBPACK_IMPORTED_MODULE_1__.ILanguageService)
], SemanticTokensStylingService);

(0,_platform_instantiation_common_extensions_js__WEBPACK_IMPORTED_MODULE_6__.registerSingleton)(_semanticTokensStyling_js__WEBPACK_IMPORTED_MODULE_5__.ISemanticTokensStylingService, SemanticTokensStylingService, 1 /* InstantiationType.Delayed */);


/***/ }),

/***/ "./node_modules/monaco-editor/esm/vs/editor/common/services/textModelSync/textModelSync.protocol.js":
/*!**********************************************************************************************************!*\
  !*** ./node_modules/monaco-editor/esm/vs/editor/common/services/textModelSync/textModelSync.protocol.js ***!
  \**********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/



/***/ }),

/***/ "./node_modules/monaco-editor/esm/vs/editor/common/services/treeViewsDnd.js":
/*!**********************************************************************************!*\
  !*** ./node_modules/monaco-editor/esm/vs/editor/common/services/treeViewsDnd.js ***!
  \**********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   DraggedTreeItemsIdentifier: () => (/* binding */ DraggedTreeItemsIdentifier),
/* harmony export */   TreeViewsDnDService: () => (/* binding */ TreeViewsDnDService)
/* harmony export */ });
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/
class TreeViewsDnDService {
    constructor() {
        this._dragOperations = new Map();
    }
    removeDragOperationTransfer(uuid) {
        if ((uuid && this._dragOperations.has(uuid))) {
            const operation = this._dragOperations.get(uuid);
            this._dragOperations.delete(uuid);
            return operation;
        }
        return undefined;
    }
}
class DraggedTreeItemsIdentifier {
    constructor(identifier) {
        this.identifier = identifier;
    }
}


/***/ }),

/***/ "./node_modules/monaco-editor/esm/vs/editor/common/services/treeViewsDndService.js":
/*!*****************************************************************************************!*\
  !*** ./node_modules/monaco-editor/esm/vs/editor/common/services/treeViewsDndService.js ***!
  \*****************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ITreeViewsDnDService: () => (/* binding */ ITreeViewsDnDService)
/* harmony export */ });
/* harmony import */ var _platform_instantiation_common_extensions_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../platform/instantiation/common/extensions.js */ "./node_modules/monaco-editor/esm/vs/platform/instantiation/common/extensions.js");
/* harmony import */ var _platform_instantiation_common_instantiation_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../platform/instantiation/common/instantiation.js */ "./node_modules/monaco-editor/esm/vs/platform/instantiation/common/instantiation.js");
/* harmony import */ var _treeViewsDnd_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./treeViewsDnd.js */ "./node_modules/monaco-editor/esm/vs/editor/common/services/treeViewsDnd.js");
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/



const ITreeViewsDnDService = (0,_platform_instantiation_common_instantiation_js__WEBPACK_IMPORTED_MODULE_1__.createDecorator)('treeViewsDndService');
(0,_platform_instantiation_common_extensions_js__WEBPACK_IMPORTED_MODULE_0__.registerSingleton)(ITreeViewsDnDService, _treeViewsDnd_js__WEBPACK_IMPORTED_MODULE_2__.TreeViewsDnDService, 1 /* InstantiationType.Delayed */);


/***/ }),

/***/ "./node_modules/monaco-editor/esm/vs/platform/environment/common/environment.js":
/*!**************************************************************************************!*\
  !*** ./node_modules/monaco-editor/esm/vs/platform/environment/common/environment.js ***!
  \**************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   IEnvironmentService: () => (/* binding */ IEnvironmentService)
/* harmony export */ });
/* harmony import */ var _instantiation_common_instantiation_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../instantiation/common/instantiation.js */ "./node_modules/monaco-editor/esm/vs/platform/instantiation/common/instantiation.js");

const IEnvironmentService = (0,_instantiation_common_instantiation_js__WEBPACK_IMPORTED_MODULE_0__.createDecorator)('environmentService');


/***/ }),

/***/ "./node_modules/monaco-editor/esm/vs/platform/files/common/files.js":
/*!**************************************************************************!*\
  !*** ./node_modules/monaco-editor/esm/vs/platform/files/common/files.js ***!
  \**************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   FileKind: () => (/* binding */ FileKind)
/* harmony export */ });
//#endregion
//#region Utilities
var FileKind;
(function (FileKind) {
    FileKind[FileKind["FILE"] = 0] = "FILE";
    FileKind[FileKind["FOLDER"] = 1] = "FOLDER";
    FileKind[FileKind["ROOT_FOLDER"] = 2] = "ROOT_FOLDER";
})(FileKind || (FileKind = {}));
//#endregion


/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmVuZG9ycy1ub2RlX21vZHVsZXNfbW9uYWNvLWVkaXRvcl9lc21fdnNfZWRpdG9yX2NvbW1vbl9zZXJ2aWNlc19lZGl0b3JXb3JrZXJfanMtbm9kZV9tb2R1bGVzLTRjZGIwYy5idW5kbGUuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7QUM5Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDd0M7QUFDakM7QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxnQ0FBZ0M7QUFDMUI7QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkNBQTZDLDZCQUE2QixJQUFJLGlDQUFpQztBQUMvRztBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsaURBQU87QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbURBQW1ELDZCQUE2QixLQUFLLGlDQUFpQztBQUN0SDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixHQUFHLEdBQUcsU0FBUztBQUNuQztBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFD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QSxrQkFBa0IsU0FBSSxJQUFJLFNBQUk7QUFDOUI7QUFDQTtBQUNBLDZDQUE2QyxRQUFRO0FBQ3JEO0FBQ0E7QUFDQSxlQUFlLFNBQUksSUFBSSxTQUFJO0FBQzNCLG9DQUFvQztBQUNwQztBQUMrRDtBQUNIO0FBQ21CO0FBQ2I7QUFDaUI7QUFDUjtBQUNjO0FBQ3pGLDhFQUE4RSxpRUFBVTtBQUN4RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQyw0RkFBNkI7QUFDeEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsaUZBQWE7QUFDNUIsZUFBZSxvRUFBVztBQUMxQixlQUFlLG9FQUFnQjtBQUMvQjtBQUN3QztBQUN4QywrRkFBaUIsQ0FBQyxvRkFBNkI7Ozs7Ozs7Ozs7OztBQzVDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDVTs7Ozs7Ozs7Ozs7Ozs7OztBQ0pWO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNyQkE7QUFDQTtBQUNBO0FBQ0E7QUFDeUY7QUFDQztBQUNsQztBQUNqRCw2QkFBNkIsZ0dBQWU7QUFDbkQsK0ZBQWlCLHVCQUF1QixpRUFBbUI7Ozs7Ozs7Ozs7Ozs7Ozs7QUNSbUI7QUFDdkUsNEJBQTRCLHVGQUFlOzs7Ozs7Ozs7Ozs7Ozs7QUNEbEQ7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLDRCQUE0QjtBQUM3QiIsInNvdXJjZXMiOlsid2VicGFjazovL3B5bGluYWMteWFtbC1lZGl0b3IvLi9ub2RlX21vZHVsZXMvbW9uYWNvLWVkaXRvci9lc20vdnMvYmFzZS9jb21tb24vbnVtYmVycy5qcyIsIndlYnBhY2s6Ly9weWxpbmFjLXlhbWwtZWRpdG9yLy4vbm9kZV9tb2R1bGVzL21vbmFjby1lZGl0b3IvZXNtL3ZzL2Jhc2UvY29tbW9uL3RoZW1hYmxlcy5qcyIsIndlYnBhY2s6Ly9weWxpbmFjLXlhbWwtZWRpdG9yLy4vbm9kZV9tb2R1bGVzL21vbmFjby1lZGl0b3IvZXNtL3ZzL2VkaXRvci9jb21tb24vc2VydmljZXMvZWRpdG9yV29ya2VyLmpzIiwid2VicGFjazovL3B5bGluYWMteWFtbC1lZGl0b3IvLi9ub2RlX21vZHVsZXMvbW9uYWNvLWVkaXRvci9lc20vdnMvZWRpdG9yL2NvbW1vbi9zZXJ2aWNlcy9nZXRJY29uQ2xhc3Nlcy5qcyIsIndlYnBhY2s6Ly9weWxpbmFjLXlhbWwtZWRpdG9yLy4vbm9kZV9tb2R1bGVzL21vbmFjby1lZGl0b3IvZXNtL3ZzL2VkaXRvci9jb21tb24vc2VydmljZXMvbGFuZ3VhZ2VGZWF0dXJlRGVib3VuY2UuanMiLCJ3ZWJwYWNrOi8vcHlsaW5hYy15YW1sLWVkaXRvci8uL25vZGVfbW9kdWxlcy9tb25hY28tZWRpdG9yL2VzbS92cy9lZGl0b3IvY29tbW9uL3NlcnZpY2VzL21hcmtlckRlY29yYXRpb25zLmpzIiwid2VicGFjazovL3B5bGluYWMteWFtbC1lZGl0b3IvLi9ub2RlX21vZHVsZXMvbW9uYWNvLWVkaXRvci9lc20vdnMvZWRpdG9yL2NvbW1vbi9zZXJ2aWNlcy9yZXNvbHZlclNlcnZpY2UuanMiLCJ3ZWJwYWNrOi8vcHlsaW5hYy15YW1sLWVkaXRvci8uL25vZGVfbW9kdWxlcy9tb25hY28tZWRpdG9yL2VzbS92cy9lZGl0b3IvY29tbW9uL3NlcnZpY2VzL3NlbWFudGljVG9rZW5zRHRvLmpzIiwid2VicGFjazovL3B5bGluYWMteWFtbC1lZGl0b3IvLi9ub2RlX21vZHVsZXMvbW9uYWNvLWVkaXRvci9lc20vdnMvZWRpdG9yL2NvbW1vbi9zZXJ2aWNlcy9zZW1hbnRpY1Rva2Vuc1N0eWxpbmcuanMiLCJ3ZWJwYWNrOi8vcHlsaW5hYy15YW1sLWVkaXRvci8uL25vZGVfbW9kdWxlcy9tb25hY28tZWRpdG9yL2VzbS92cy9lZGl0b3IvY29tbW9uL3NlcnZpY2VzL3NlbWFudGljVG9rZW5zU3R5bGluZ1NlcnZpY2UuanMiLCJ3ZWJwYWNrOi8vcHlsaW5hYy15YW1sLWVkaXRvci8uL25vZGVfbW9kdWxlcy9tb25hY28tZWRpdG9yL2VzbS92cy9lZGl0b3IvY29tbW9uL3NlcnZpY2VzL3RleHRNb2RlbFN5bmMvdGV4dE1vZGVsU3luYy5wcm90b2NvbC5qcyIsIndlYnBhY2s6Ly9weWxpbmFjLXlhbWwtZWRpdG9yLy4vbm9kZV9tb2R1bGVzL21vbmFjby1lZGl0b3IvZXNtL3ZzL2VkaXRvci9jb21tb24vc2VydmljZXMvdHJlZVZpZXdzRG5kLmpzIiwid2VicGFjazovL3B5bGluYWMteWFtbC1lZGl0b3IvLi9ub2RlX21vZHVsZXMvbW9uYWNvLWVkaXRvci9lc20vdnMvZWRpdG9yL2NvbW1vbi9zZXJ2aWNlcy90cmVlVmlld3NEbmRTZXJ2aWNlLmpzIiwid2VicGFjazovL3B5bGluYWMteWFtbC1lZGl0b3IvLi9ub2RlX21vZHVsZXMvbW9uYWNvLWVkaXRvci9lc20vdnMvcGxhdGZvcm0vZW52aXJvbm1lbnQvY29tbW9uL2Vudmlyb25tZW50LmpzIiwid2VicGFjazovL3B5bGluYWMteWFtbC1lZGl0b3IvLi9ub2RlX21vZHVsZXMvbW9uYWNvLWVkaXRvci9lc20vdnMvcGxhdGZvcm0vZmlsZXMvY29tbW9uL2ZpbGVzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiAgQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKiAgTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLiBTZWUgTGljZW5zZS50eHQgaW4gdGhlIHByb2plY3Qgcm9vdCBmb3IgbGljZW5zZSBpbmZvcm1hdGlvbi5cbiAqLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuZXhwb3J0IGZ1bmN0aW9uIGNsYW1wKHZhbHVlLCBtaW4sIG1heCkge1xuICAgIHJldHVybiBNYXRoLm1pbihNYXRoLm1heCh2YWx1ZSwgbWluKSwgbWF4KTtcbn1cbmV4cG9ydCBjbGFzcyBNb3ZpbmdBdmVyYWdlIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5fbiA9IDE7XG4gICAgICAgIHRoaXMuX3ZhbCA9IDA7XG4gICAgfVxuICAgIHVwZGF0ZSh2YWx1ZSkge1xuICAgICAgICB0aGlzLl92YWwgPSB0aGlzLl92YWwgKyAodmFsdWUgLSB0aGlzLl92YWwpIC8gdGhpcy5fbjtcbiAgICAgICAgdGhpcy5fbiArPSAxO1xuICAgICAgICByZXR1cm4gdGhpcy5fdmFsO1xuICAgIH1cbiAgICBnZXQgdmFsdWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl92YWw7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIFNsaWRpbmdXaW5kb3dBdmVyYWdlIHtcbiAgICBjb25zdHJ1Y3RvcihzaXplKSB7XG4gICAgICAgIHRoaXMuX24gPSAwO1xuICAgICAgICB0aGlzLl92YWwgPSAwO1xuICAgICAgICB0aGlzLl92YWx1ZXMgPSBbXTtcbiAgICAgICAgdGhpcy5faW5kZXggPSAwO1xuICAgICAgICB0aGlzLl9zdW0gPSAwO1xuICAgICAgICB0aGlzLl92YWx1ZXMgPSBuZXcgQXJyYXkoc2l6ZSk7XG4gICAgICAgIHRoaXMuX3ZhbHVlcy5maWxsKDAsIDAsIHNpemUpO1xuICAgIH1cbiAgICB1cGRhdGUodmFsdWUpIHtcbiAgICAgICAgY29uc3Qgb2xkVmFsdWUgPSB0aGlzLl92YWx1ZXNbdGhpcy5faW5kZXhdO1xuICAgICAgICB0aGlzLl92YWx1ZXNbdGhpcy5faW5kZXhdID0gdmFsdWU7XG4gICAgICAgIHRoaXMuX2luZGV4ID0gKHRoaXMuX2luZGV4ICsgMSkgJSB0aGlzLl92YWx1ZXMubGVuZ3RoO1xuICAgICAgICB0aGlzLl9zdW0gLT0gb2xkVmFsdWU7XG4gICAgICAgIHRoaXMuX3N1bSArPSB2YWx1ZTtcbiAgICAgICAgaWYgKHRoaXMuX24gPCB0aGlzLl92YWx1ZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICB0aGlzLl9uICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fdmFsID0gdGhpcy5fc3VtIC8gdGhpcy5fbjtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3ZhbDtcbiAgICB9XG4gICAgZ2V0IHZhbHVlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdmFsO1xuICAgIH1cbn1cbiIsIi8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiAgQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKiAgTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLiBTZWUgTGljZW5zZS50eHQgaW4gdGhlIHByb2plY3Qgcm9vdCBmb3IgbGljZW5zZSBpbmZvcm1hdGlvbi5cbiAqLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuaW1wb3J0IHsgQ29kaWNvbiB9IGZyb20gJy4vY29kaWNvbnMuanMnO1xuZXhwb3J0IHZhciBUaGVtZUNvbG9yO1xuKGZ1bmN0aW9uIChUaGVtZUNvbG9yKSB7XG4gICAgZnVuY3Rpb24gaXNUaGVtZUNvbG9yKG9iaikge1xuICAgICAgICByZXR1cm4gb2JqICYmIHR5cGVvZiBvYmogPT09ICdvYmplY3QnICYmIHR5cGVvZiBvYmouaWQgPT09ICdzdHJpbmcnO1xuICAgIH1cbiAgICBUaGVtZUNvbG9yLmlzVGhlbWVDb2xvciA9IGlzVGhlbWVDb2xvcjtcbn0pKFRoZW1lQ29sb3IgfHwgKFRoZW1lQ29sb3IgPSB7fSkpO1xuZXhwb3J0IHZhciBUaGVtZUljb247XG4oZnVuY3Rpb24gKFRoZW1lSWNvbikge1xuICAgIFRoZW1lSWNvbi5pY29uTmFtZVNlZ21lbnQgPSAnW0EtWmEtejAtOV0rJztcbiAgICBUaGVtZUljb24uaWNvbk5hbWVFeHByZXNzaW9uID0gJ1tBLVphLXowLTktXSsnO1xuICAgIFRoZW1lSWNvbi5pY29uTW9kaWZpZXJFeHByZXNzaW9uID0gJ35bQS1aYS16XSsnO1xuICAgIFRoZW1lSWNvbi5pY29uTmFtZUNoYXJhY3RlciA9ICdbQS1aYS16MC05fi1dJztcbiAgICBjb25zdCBUaGVtZUljb25JZFJlZ2V4ID0gbmV3IFJlZ0V4cChgXigke1RoZW1lSWNvbi5pY29uTmFtZUV4cHJlc3Npb259KSgke1RoZW1lSWNvbi5pY29uTW9kaWZpZXJFeHByZXNzaW9ufSk/JGApO1xuICAgIGZ1bmN0aW9uIGFzQ2xhc3NOYW1lQXJyYXkoaWNvbikge1xuICAgICAgICBjb25zdCBtYXRjaCA9IFRoZW1lSWNvbklkUmVnZXguZXhlYyhpY29uLmlkKTtcbiAgICAgICAgaWYgKCFtYXRjaCkge1xuICAgICAgICAgICAgcmV0dXJuIGFzQ2xhc3NOYW1lQXJyYXkoQ29kaWNvbi5lcnJvcik7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgWywgaWQsIG1vZGlmaWVyXSA9IG1hdGNoO1xuICAgICAgICBjb25zdCBjbGFzc05hbWVzID0gWydjb2RpY29uJywgJ2NvZGljb24tJyArIGlkXTtcbiAgICAgICAgaWYgKG1vZGlmaWVyKSB7XG4gICAgICAgICAgICBjbGFzc05hbWVzLnB1c2goJ2NvZGljb24tbW9kaWZpZXItJyArIG1vZGlmaWVyLnN1YnN0cmluZygxKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNsYXNzTmFtZXM7XG4gICAgfVxuICAgIFRoZW1lSWNvbi5hc0NsYXNzTmFtZUFycmF5ID0gYXNDbGFzc05hbWVBcnJheTtcbiAgICBmdW5jdGlvbiBhc0NsYXNzTmFtZShpY29uKSB7XG4gICAgICAgIHJldHVybiBhc0NsYXNzTmFtZUFycmF5KGljb24pLmpvaW4oJyAnKTtcbiAgICB9XG4gICAgVGhlbWVJY29uLmFzQ2xhc3NOYW1lID0gYXNDbGFzc05hbWU7XG4gICAgZnVuY3Rpb24gYXNDU1NTZWxlY3RvcihpY29uKSB7XG4gICAgICAgIHJldHVybiAnLicgKyBhc0NsYXNzTmFtZUFycmF5KGljb24pLmpvaW4oJy4nKTtcbiAgICB9XG4gICAgVGhlbWVJY29uLmFzQ1NTU2VsZWN0b3IgPSBhc0NTU1NlbGVjdG9yO1xuICAgIGZ1bmN0aW9uIGlzVGhlbWVJY29uKG9iaikge1xuICAgICAgICByZXR1cm4gb2JqICYmIHR5cGVvZiBvYmogPT09ICdvYmplY3QnICYmIHR5cGVvZiBvYmouaWQgPT09ICdzdHJpbmcnICYmICh0eXBlb2Ygb2JqLmNvbG9yID09PSAndW5kZWZpbmVkJyB8fCBUaGVtZUNvbG9yLmlzVGhlbWVDb2xvcihvYmouY29sb3IpKTtcbiAgICB9XG4gICAgVGhlbWVJY29uLmlzVGhlbWVJY29uID0gaXNUaGVtZUljb247XG4gICAgY29uc3QgX3JlZ2V4RnJvbVN0cmluZyA9IG5ldyBSZWdFeHAoYF5cXFxcJFxcXFwoKCR7VGhlbWVJY29uLmljb25OYW1lRXhwcmVzc2lvbn0oPzoke1RoZW1lSWNvbi5pY29uTW9kaWZpZXJFeHByZXNzaW9ufSk/KVxcXFwpJGApO1xuICAgIGZ1bmN0aW9uIGZyb21TdHJpbmcoc3RyKSB7XG4gICAgICAgIGNvbnN0IG1hdGNoID0gX3JlZ2V4RnJvbVN0cmluZy5leGVjKHN0cik7XG4gICAgICAgIGlmICghbWF0Y2gpIHtcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgWywgbmFtZV0gPSBtYXRjaDtcbiAgICAgICAgcmV0dXJuIHsgaWQ6IG5hbWUgfTtcbiAgICB9XG4gICAgVGhlbWVJY29uLmZyb21TdHJpbmcgPSBmcm9tU3RyaW5nO1xuICAgIGZ1bmN0aW9uIGZyb21JZChpZCkge1xuICAgICAgICByZXR1cm4geyBpZCB9O1xuICAgIH1cbiAgICBUaGVtZUljb24uZnJvbUlkID0gZnJvbUlkO1xuICAgIGZ1bmN0aW9uIG1vZGlmeShpY29uLCBtb2RpZmllcikge1xuICAgICAgICBsZXQgaWQgPSBpY29uLmlkO1xuICAgICAgICBjb25zdCB0aWxkZUluZGV4ID0gaWQubGFzdEluZGV4T2YoJ34nKTtcbiAgICAgICAgaWYgKHRpbGRlSW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgICBpZCA9IGlkLnN1YnN0cmluZygwLCB0aWxkZUluZGV4KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobW9kaWZpZXIpIHtcbiAgICAgICAgICAgIGlkID0gYCR7aWR9fiR7bW9kaWZpZXJ9YDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geyBpZCB9O1xuICAgIH1cbiAgICBUaGVtZUljb24ubW9kaWZ5ID0gbW9kaWZ5O1xuICAgIGZ1bmN0aW9uIGdldE1vZGlmaWVyKGljb24pIHtcbiAgICAgICAgY29uc3QgdGlsZGVJbmRleCA9IGljb24uaWQubGFzdEluZGV4T2YoJ34nKTtcbiAgICAgICAgaWYgKHRpbGRlSW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgICByZXR1cm4gaWNvbi5pZC5zdWJzdHJpbmcodGlsZGVJbmRleCArIDEpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIFRoZW1lSWNvbi5nZXRNb2RpZmllciA9IGdldE1vZGlmaWVyO1xuICAgIGZ1bmN0aW9uIGlzRXF1YWwodGkxLCB0aTIpIHtcbiAgICAgICAgcmV0dXJuIHRpMS5pZCA9PT0gdGkyLmlkICYmIHRpMS5jb2xvcj8uaWQgPT09IHRpMi5jb2xvcj8uaWQ7XG4gICAgfVxuICAgIFRoZW1lSWNvbi5pc0VxdWFsID0gaXNFcXVhbDtcbn0pKFRoZW1lSWNvbiB8fCAoVGhlbWVJY29uID0ge30pKTtcbiIsIi8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiAgQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKiAgTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLiBTZWUgTGljZW5zZS50eHQgaW4gdGhlIHByb2plY3Qgcm9vdCBmb3IgbGljZW5zZSBpbmZvcm1hdGlvbi5cbiAqLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuaW1wb3J0IHsgY3JlYXRlRGVjb3JhdG9yIH0gZnJvbSAnLi4vLi4vLi4vcGxhdGZvcm0vaW5zdGFudGlhdGlvbi9jb21tb24vaW5zdGFudGlhdGlvbi5qcyc7XG5leHBvcnQgY29uc3QgSUVkaXRvcldvcmtlclNlcnZpY2UgPSBjcmVhdGVEZWNvcmF0b3IoJ2VkaXRvcldvcmtlclNlcnZpY2UnKTtcbiIsIi8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiAgQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKiAgTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLiBTZWUgTGljZW5zZS50eHQgaW4gdGhlIHByb2plY3Qgcm9vdCBmb3IgbGljZW5zZSBpbmZvcm1hdGlvbi5cbiAqLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuaW1wb3J0IHsgU2NoZW1hcyB9IGZyb20gJy4uLy4uLy4uL2Jhc2UvY29tbW9uL25ldHdvcmsuanMnO1xuaW1wb3J0IHsgRGF0YVVyaSB9IGZyb20gJy4uLy4uLy4uL2Jhc2UvY29tbW9uL3Jlc291cmNlcy5qcyc7XG5pbXBvcnQgeyBVUkkgfSBmcm9tICcuLi8uLi8uLi9iYXNlL2NvbW1vbi91cmkuanMnO1xuaW1wb3J0IHsgUExBSU5URVhUX0xBTkdVQUdFX0lEIH0gZnJvbSAnLi4vbGFuZ3VhZ2VzL21vZGVzUmVnaXN0cnkuanMnO1xuaW1wb3J0IHsgRmlsZUtpbmQgfSBmcm9tICcuLi8uLi8uLi9wbGF0Zm9ybS9maWxlcy9jb21tb24vZmlsZXMuanMnO1xuaW1wb3J0IHsgVGhlbWVJY29uIH0gZnJvbSAnLi4vLi4vLi4vYmFzZS9jb21tb24vdGhlbWFibGVzLmpzJztcbmNvbnN0IGZpbGVJY29uRGlyZWN0b3J5UmVnZXggPSAvKD86XFwvfF4pKD86KFteXFwvXSspXFwvKT8oW15cXC9dKykkLztcbmV4cG9ydCBmdW5jdGlvbiBnZXRJY29uQ2xhc3Nlcyhtb2RlbFNlcnZpY2UsIGxhbmd1YWdlU2VydmljZSwgcmVzb3VyY2UsIGZpbGVLaW5kLCBpY29uKSB7XG4gICAgaWYgKFRoZW1lSWNvbi5pc1RoZW1lSWNvbihpY29uKSkge1xuICAgICAgICByZXR1cm4gW2Bjb2RpY29uLSR7aWNvbi5pZH1gLCAncHJlZGVmaW5lZC1maWxlLWljb24nXTtcbiAgICB9XG4gICAgaWYgKFVSSS5pc1VyaShpY29uKSkge1xuICAgICAgICByZXR1cm4gW107XG4gICAgfVxuICAgIC8vIHdlIGFsd2F5cyBzZXQgdGhlc2UgYmFzZSBjbGFzc2VzIGV2ZW4gaWYgd2UgZG8gbm90IGhhdmUgYSBwYXRoXG4gICAgY29uc3QgY2xhc3NlcyA9IGZpbGVLaW5kID09PSBGaWxlS2luZC5ST09UX0ZPTERFUiA/IFsncm9vdGZvbGRlci1pY29uJ10gOiBmaWxlS2luZCA9PT0gRmlsZUtpbmQuRk9MREVSID8gWydmb2xkZXItaWNvbiddIDogWydmaWxlLWljb24nXTtcbiAgICBpZiAocmVzb3VyY2UpIHtcbiAgICAgICAgLy8gR2V0IHRoZSBwYXRoIGFuZCBuYW1lIG9mIHRoZSByZXNvdXJjZS4gRm9yIGRhdGEtVVJJcywgd2UgbmVlZCB0byBwYXJzZSBzcGVjaWFsbHlcbiAgICAgICAgbGV0IG5hbWU7XG4gICAgICAgIGlmIChyZXNvdXJjZS5zY2hlbWUgPT09IFNjaGVtYXMuZGF0YSkge1xuICAgICAgICAgICAgY29uc3QgbWV0YWRhdGEgPSBEYXRhVXJpLnBhcnNlTWV0YURhdGEocmVzb3VyY2UpO1xuICAgICAgICAgICAgbmFtZSA9IG1ldGFkYXRhLmdldChEYXRhVXJpLk1FVEFfREFUQV9MQUJFTCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBtYXRjaCA9IHJlc291cmNlLnBhdGgubWF0Y2goZmlsZUljb25EaXJlY3RvcnlSZWdleCk7XG4gICAgICAgICAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgICAgICAgICBuYW1lID0gY3NzRXNjYXBlKG1hdGNoWzJdLnRvTG93ZXJDYXNlKCkpO1xuICAgICAgICAgICAgICAgIGlmIChtYXRjaFsxXSkge1xuICAgICAgICAgICAgICAgICAgICBjbGFzc2VzLnB1c2goYCR7Y3NzRXNjYXBlKG1hdGNoWzFdLnRvTG93ZXJDYXNlKCkpfS1uYW1lLWRpci1pY29uYCk7IC8vIHBhcmVudCBkaXJlY3RvcnlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBuYW1lID0gY3NzRXNjYXBlKHJlc291cmNlLmF1dGhvcml0eS50b0xvd2VyQ2FzZSgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBSb290IEZvbGRlcnNcbiAgICAgICAgaWYgKGZpbGVLaW5kID09PSBGaWxlS2luZC5ST09UX0ZPTERFUikge1xuICAgICAgICAgICAgY2xhc3Nlcy5wdXNoKGAke25hbWV9LXJvb3QtbmFtZS1mb2xkZXItaWNvbmApO1xuICAgICAgICB9XG4gICAgICAgIC8vIEZvbGRlcnNcbiAgICAgICAgZWxzZSBpZiAoZmlsZUtpbmQgPT09IEZpbGVLaW5kLkZPTERFUikge1xuICAgICAgICAgICAgY2xhc3Nlcy5wdXNoKGAke25hbWV9LW5hbWUtZm9sZGVyLWljb25gKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBGaWxlc1xuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vIE5hbWUgJiBFeHRlbnNpb24ocylcbiAgICAgICAgICAgIGlmIChuYW1lKSB7XG4gICAgICAgICAgICAgICAgY2xhc3Nlcy5wdXNoKGAke25hbWV9LW5hbWUtZmlsZS1pY29uYCk7XG4gICAgICAgICAgICAgICAgY2xhc3Nlcy5wdXNoKGBuYW1lLWZpbGUtaWNvbmApOyAvLyBleHRyYSBzZWdtZW50IHRvIGluY3JlYXNlIGZpbGUtbmFtZSBzY29yZVxuICAgICAgICAgICAgICAgIC8vIEF2b2lkIGRvaW5nIGFuIGV4cGxvc2l2ZSBjb21iaW5hdGlvbiBvZiBleHRlbnNpb25zIGZvciB2ZXJ5IGxvbmcgZmlsZW5hbWVzXG4gICAgICAgICAgICAgICAgLy8gKG1vc3QgZmlsZSBzeXN0ZW1zIGRvIG5vdCBhbGxvdyBmaWxlcyA+IDI1NSBsZW5ndGgpIHdpdGggbG90cyBvZiBgLmAgY2hhcmFjdGVyc1xuICAgICAgICAgICAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9taWNyb3NvZnQvdnNjb2RlL2lzc3Vlcy8xMTYxOTlcbiAgICAgICAgICAgICAgICBpZiAobmFtZS5sZW5ndGggPD0gMjU1KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGRvdFNlZ21lbnRzID0gbmFtZS5zcGxpdCgnLicpO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IGRvdFNlZ21lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc2VzLnB1c2goYCR7ZG90U2VnbWVudHMuc2xpY2UoaSkuam9pbignLicpfS1leHQtZmlsZS1pY29uYCk7IC8vIGFkZCBlYWNoIGNvbWJpbmF0aW9uIG9mIGFsbCBmb3VuZCBleHRlbnNpb25zIGlmIG1vcmUgdGhhbiBvbmVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjbGFzc2VzLnB1c2goYGV4dC1maWxlLWljb25gKTsgLy8gZXh0cmEgc2VnbWVudCB0byBpbmNyZWFzZSBmaWxlLWV4dCBzY29yZVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gRGV0ZWN0ZWQgTW9kZVxuICAgICAgICAgICAgY29uc3QgZGV0ZWN0ZWRMYW5ndWFnZUlkID0gZGV0ZWN0TGFuZ3VhZ2VJZChtb2RlbFNlcnZpY2UsIGxhbmd1YWdlU2VydmljZSwgcmVzb3VyY2UpO1xuICAgICAgICAgICAgaWYgKGRldGVjdGVkTGFuZ3VhZ2VJZCkge1xuICAgICAgICAgICAgICAgIGNsYXNzZXMucHVzaChgJHtjc3NFc2NhcGUoZGV0ZWN0ZWRMYW5ndWFnZUlkKX0tbGFuZy1maWxlLWljb25gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gY2xhc3Nlcztcbn1cbmZ1bmN0aW9uIGRldGVjdExhbmd1YWdlSWQobW9kZWxTZXJ2aWNlLCBsYW5ndWFnZVNlcnZpY2UsIHJlc291cmNlKSB7XG4gICAgaWYgKCFyZXNvdXJjZSkge1xuICAgICAgICByZXR1cm4gbnVsbDsgLy8gd2UgbmVlZCBhIHJlc291cmNlIGF0IGxlYXN0XG4gICAgfVxuICAgIGxldCBsYW5ndWFnZUlkID0gbnVsbDtcbiAgICAvLyBEYXRhIFVSSTogY2hlY2sgZm9yIGVuY29kZWQgbWV0YWRhdGFcbiAgICBpZiAocmVzb3VyY2Uuc2NoZW1lID09PSBTY2hlbWFzLmRhdGEpIHtcbiAgICAgICAgY29uc3QgbWV0YWRhdGEgPSBEYXRhVXJpLnBhcnNlTWV0YURhdGEocmVzb3VyY2UpO1xuICAgICAgICBjb25zdCBtaW1lID0gbWV0YWRhdGEuZ2V0KERhdGFVcmkuTUVUQV9EQVRBX01JTUUpO1xuICAgICAgICBpZiAobWltZSkge1xuICAgICAgICAgICAgbGFuZ3VhZ2VJZCA9IGxhbmd1YWdlU2VydmljZS5nZXRMYW5ndWFnZUlkQnlNaW1lVHlwZShtaW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvLyBBbnkgb3RoZXIgVVJJOiBjaGVjayBmb3IgbW9kZWwgaWYgZXhpc3RpbmdcbiAgICBlbHNlIHtcbiAgICAgICAgY29uc3QgbW9kZWwgPSBtb2RlbFNlcnZpY2UuZ2V0TW9kZWwocmVzb3VyY2UpO1xuICAgICAgICBpZiAobW9kZWwpIHtcbiAgICAgICAgICAgIGxhbmd1YWdlSWQgPSBtb2RlbC5nZXRMYW5ndWFnZUlkKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLy8gb25seSB0YWtlIGlmIHRoZSBsYW5ndWFnZSBpZCBpcyBzcGVjaWZpYyAoYWthIG5vIGp1c3QgcGxhaW4gdGV4dClcbiAgICBpZiAobGFuZ3VhZ2VJZCAmJiBsYW5ndWFnZUlkICE9PSBQTEFJTlRFWFRfTEFOR1VBR0VfSUQpIHtcbiAgICAgICAgcmV0dXJuIGxhbmd1YWdlSWQ7XG4gICAgfVxuICAgIC8vIG90aGVyd2lzZSBmYWxsYmFjayB0byBwYXRoIGJhc2VkIGRldGVjdGlvblxuICAgIHJldHVybiBsYW5ndWFnZVNlcnZpY2UuZ3Vlc3NMYW5ndWFnZUlkQnlGaWxlcGF0aE9yRmlyc3RMaW5lKHJlc291cmNlKTtcbn1cbmZ1bmN0aW9uIGNzc0VzY2FwZShzdHIpIHtcbiAgICByZXR1cm4gc3RyLnJlcGxhY2UoL1tcXHNdL2csICcvJyk7IC8vIEhUTUwgY2xhc3MgbmFtZXMgY2FuIG5vdCBjb250YWluIGNlcnRhaW4gd2hpdGVzcGFjZSBjaGFyYWN0ZXJzIChodHRwczovL2RvbS5zcGVjLndoYXR3Zy5vcmcvI2ludGVyZmFjZS1kb210b2tlbmxpc3QpLCB1c2UgLyBpbnN0ZWFkLCB3aGljaCBkb2Vzbid0IGV4aXN0IGluIGZpbGUgbmFtZXMuXG59XG4iLCIvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICogIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS4gU2VlIExpY2Vuc2UudHh0IGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIGxpY2Vuc2UgaW5mb3JtYXRpb24uXG4gKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cbnZhciBfX2RlY29yYXRlID0gKHRoaXMgJiYgdGhpcy5fX2RlY29yYXRlKSB8fCBmdW5jdGlvbiAoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpIHtcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XG4gICAgZWxzZSBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgaWYgKGQgPSBkZWNvcmF0b3JzW2ldKSByID0gKGMgPCAzID8gZChyKSA6IGMgPiAzID8gZCh0YXJnZXQsIGtleSwgcikgOiBkKHRhcmdldCwga2V5KSkgfHwgcjtcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xufTtcbnZhciBfX3BhcmFtID0gKHRoaXMgJiYgdGhpcy5fX3BhcmFtKSB8fCBmdW5jdGlvbiAocGFyYW1JbmRleCwgZGVjb3JhdG9yKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQsIGtleSkgeyBkZWNvcmF0b3IodGFyZ2V0LCBrZXksIHBhcmFtSW5kZXgpOyB9XG59O1xuaW1wb3J0IHsgZG9IYXNoIH0gZnJvbSAnLi4vLi4vLi4vYmFzZS9jb21tb24vaGFzaC5qcyc7XG5pbXBvcnQgeyBMUlVDYWNoZSB9IGZyb20gJy4uLy4uLy4uL2Jhc2UvY29tbW9uL21hcC5qcyc7XG5pbXBvcnQgeyBjbGFtcCwgTW92aW5nQXZlcmFnZSwgU2xpZGluZ1dpbmRvd0F2ZXJhZ2UgfSBmcm9tICcuLi8uLi8uLi9iYXNlL2NvbW1vbi9udW1iZXJzLmpzJztcbmltcG9ydCB7IElFbnZpcm9ubWVudFNlcnZpY2UgfSBmcm9tICcuLi8uLi8uLi9wbGF0Zm9ybS9lbnZpcm9ubWVudC9jb21tb24vZW52aXJvbm1lbnQuanMnO1xuaW1wb3J0IHsgcmVnaXN0ZXJTaW5nbGV0b24gfSBmcm9tICcuLi8uLi8uLi9wbGF0Zm9ybS9pbnN0YW50aWF0aW9uL2NvbW1vbi9leHRlbnNpb25zLmpzJztcbmltcG9ydCB7IGNyZWF0ZURlY29yYXRvciB9IGZyb20gJy4uLy4uLy4uL3BsYXRmb3JtL2luc3RhbnRpYXRpb24vY29tbW9uL2luc3RhbnRpYXRpb24uanMnO1xuaW1wb3J0IHsgSUxvZ1NlcnZpY2UgfSBmcm9tICcuLi8uLi8uLi9wbGF0Zm9ybS9sb2cvY29tbW9uL2xvZy5qcyc7XG5pbXBvcnQgeyBtYXRjaGVzU2NoZW1lIH0gZnJvbSAnLi4vLi4vLi4vYmFzZS9jb21tb24vbmV0d29yay5qcyc7XG5leHBvcnQgY29uc3QgSUxhbmd1YWdlRmVhdHVyZURlYm91bmNlU2VydmljZSA9IGNyZWF0ZURlY29yYXRvcignSUxhbmd1YWdlRmVhdHVyZURlYm91bmNlU2VydmljZScpO1xudmFyIElkZW50aXR5SGFzaDtcbihmdW5jdGlvbiAoSWRlbnRpdHlIYXNoKSB7XG4gICAgY29uc3QgX2hhc2hlcyA9IG5ldyBXZWFrTWFwKCk7XG4gICAgbGV0IHBvb2wgPSAwO1xuICAgIGZ1bmN0aW9uIG9mKG9iaikge1xuICAgICAgICBsZXQgdmFsdWUgPSBfaGFzaGVzLmdldChvYmopO1xuICAgICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdmFsdWUgPSArK3Bvb2w7XG4gICAgICAgICAgICBfaGFzaGVzLnNldChvYmosIHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxuICAgIElkZW50aXR5SGFzaC5vZiA9IG9mO1xufSkoSWRlbnRpdHlIYXNoIHx8IChJZGVudGl0eUhhc2ggPSB7fSkpO1xuY2xhc3MgTnVsbERlYm91bmNlSW5mb3JtYXRpb24ge1xuICAgIGNvbnN0cnVjdG9yKF9kZWZhdWx0KSB7XG4gICAgICAgIHRoaXMuX2RlZmF1bHQgPSBfZGVmYXVsdDtcbiAgICB9XG4gICAgZ2V0KF9tb2RlbCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZGVmYXVsdDtcbiAgICB9XG4gICAgdXBkYXRlKF9tb2RlbCwgX3ZhbHVlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9kZWZhdWx0O1xuICAgIH1cbiAgICBkZWZhdWx0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZGVmYXVsdDtcbiAgICB9XG59XG5jbGFzcyBGZWF0dXJlRGVib3VuY2VJbmZvcm1hdGlvbiB7XG4gICAgY29uc3RydWN0b3IoX2xvZ1NlcnZpY2UsIF9uYW1lLCBfcmVnaXN0cnksIF9kZWZhdWx0LCBfbWluLCBfbWF4KSB7XG4gICAgICAgIHRoaXMuX2xvZ1NlcnZpY2UgPSBfbG9nU2VydmljZTtcbiAgICAgICAgdGhpcy5fbmFtZSA9IF9uYW1lO1xuICAgICAgICB0aGlzLl9yZWdpc3RyeSA9IF9yZWdpc3RyeTtcbiAgICAgICAgdGhpcy5fZGVmYXVsdCA9IF9kZWZhdWx0O1xuICAgICAgICB0aGlzLl9taW4gPSBfbWluO1xuICAgICAgICB0aGlzLl9tYXggPSBfbWF4O1xuICAgICAgICB0aGlzLl9jYWNoZSA9IG5ldyBMUlVDYWNoZSg1MCwgMC43KTtcbiAgICB9XG4gICAgX2tleShtb2RlbCkge1xuICAgICAgICByZXR1cm4gbW9kZWwuaWQgKyB0aGlzLl9yZWdpc3RyeS5hbGwobW9kZWwpLnJlZHVjZSgoaGFzaFZhbCwgb2JqKSA9PiBkb0hhc2goSWRlbnRpdHlIYXNoLm9mKG9iaiksIGhhc2hWYWwpLCAwKTtcbiAgICB9XG4gICAgZ2V0KG1vZGVsKSB7XG4gICAgICAgIGNvbnN0IGtleSA9IHRoaXMuX2tleShtb2RlbCk7XG4gICAgICAgIGNvbnN0IGF2ZyA9IHRoaXMuX2NhY2hlLmdldChrZXkpO1xuICAgICAgICByZXR1cm4gYXZnXG4gICAgICAgICAgICA/IGNsYW1wKGF2Zy52YWx1ZSwgdGhpcy5fbWluLCB0aGlzLl9tYXgpXG4gICAgICAgICAgICA6IHRoaXMuZGVmYXVsdCgpO1xuICAgIH1cbiAgICB1cGRhdGUobW9kZWwsIHZhbHVlKSB7XG4gICAgICAgIGNvbnN0IGtleSA9IHRoaXMuX2tleShtb2RlbCk7XG4gICAgICAgIGxldCBhdmcgPSB0aGlzLl9jYWNoZS5nZXQoa2V5KTtcbiAgICAgICAgaWYgKCFhdmcpIHtcbiAgICAgICAgICAgIGF2ZyA9IG5ldyBTbGlkaW5nV2luZG93QXZlcmFnZSg2KTtcbiAgICAgICAgICAgIHRoaXMuX2NhY2hlLnNldChrZXksIGF2Zyk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbmV3VmFsdWUgPSBjbGFtcChhdmcudXBkYXRlKHZhbHVlKSwgdGhpcy5fbWluLCB0aGlzLl9tYXgpO1xuICAgICAgICBpZiAoIW1hdGNoZXNTY2hlbWUobW9kZWwudXJpLCAnb3V0cHV0JykpIHtcbiAgICAgICAgICAgIHRoaXMuX2xvZ1NlcnZpY2UudHJhY2UoYFtERUJPVU5DRTogJHt0aGlzLl9uYW1lfV0gZm9yICR7bW9kZWwudXJpLnRvU3RyaW5nKCl9IGlzICR7bmV3VmFsdWV9bXNgKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3VmFsdWU7XG4gICAgfVxuICAgIF9vdmVyYWxsKCkge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBuZXcgTW92aW5nQXZlcmFnZSgpO1xuICAgICAgICBmb3IgKGNvbnN0IFssIGF2Z10gb2YgdGhpcy5fY2FjaGUpIHtcbiAgICAgICAgICAgIHJlc3VsdC51cGRhdGUoYXZnLnZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0LnZhbHVlO1xuICAgIH1cbiAgICBkZWZhdWx0KCkge1xuICAgICAgICBjb25zdCB2YWx1ZSA9ICh0aGlzLl9vdmVyYWxsKCkgfCAwKSB8fCB0aGlzLl9kZWZhdWx0O1xuICAgICAgICByZXR1cm4gY2xhbXAodmFsdWUsIHRoaXMuX21pbiwgdGhpcy5fbWF4KTtcbiAgICB9XG59XG5sZXQgTGFuZ3VhZ2VGZWF0dXJlRGVib3VuY2VTZXJ2aWNlID0gY2xhc3MgTGFuZ3VhZ2VGZWF0dXJlRGVib3VuY2VTZXJ2aWNlIHtcbiAgICBjb25zdHJ1Y3RvcihfbG9nU2VydmljZSwgZW52U2VydmljZSkge1xuICAgICAgICB0aGlzLl9sb2dTZXJ2aWNlID0gX2xvZ1NlcnZpY2U7XG4gICAgICAgIHRoaXMuX2RhdGEgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMuX2lzRGV2ID0gZW52U2VydmljZS5pc0V4dGVuc2lvbkRldmVsb3BtZW50IHx8ICFlbnZTZXJ2aWNlLmlzQnVpbHQ7XG4gICAgfVxuICAgIGZvcihmZWF0dXJlLCBuYW1lLCBjb25maWcpIHtcbiAgICAgICAgY29uc3QgbWluID0gY29uZmlnPy5taW4gPz8gNTA7XG4gICAgICAgIGNvbnN0IG1heCA9IGNvbmZpZz8ubWF4ID8/IG1pbiAqKiAyO1xuICAgICAgICBjb25zdCBleHRyYSA9IGNvbmZpZz8ua2V5ID8/IHVuZGVmaW5lZDtcbiAgICAgICAgY29uc3Qga2V5ID0gYCR7SWRlbnRpdHlIYXNoLm9mKGZlYXR1cmUpfSwke21pbn0ke2V4dHJhID8gJywnICsgZXh0cmEgOiAnJ31gO1xuICAgICAgICBsZXQgaW5mbyA9IHRoaXMuX2RhdGEuZ2V0KGtleSk7XG4gICAgICAgIGlmICghaW5mbykge1xuICAgICAgICAgICAgaWYgKHRoaXMuX2lzRGV2KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbG9nU2VydmljZS5kZWJ1ZyhgW0RFQk9VTkNFOiAke25hbWV9XSBpcyBkaXNhYmxlZCBpbiBkZXZlbG9wZWQgbW9kZWApO1xuICAgICAgICAgICAgICAgIGluZm8gPSBuZXcgTnVsbERlYm91bmNlSW5mb3JtYXRpb24obWluICogMS41KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGluZm8gPSBuZXcgRmVhdHVyZURlYm91bmNlSW5mb3JtYXRpb24odGhpcy5fbG9nU2VydmljZSwgbmFtZSwgZmVhdHVyZSwgKHRoaXMuX292ZXJhbGxBdmVyYWdlKCkgfCAwKSB8fCAobWluICogMS41KSwgLy8gZGVmYXVsdCBpcyBvdmVyYWxsIGRlZmF1bHQgb3IgZGVyaXZlZCBmcm9tIG1pbi12YWx1ZVxuICAgICAgICAgICAgICAgIG1pbiwgbWF4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX2RhdGEuc2V0KGtleSwgaW5mbyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGluZm87XG4gICAgfVxuICAgIF9vdmVyYWxsQXZlcmFnZSgpIHtcbiAgICAgICAgLy8gQXZlcmFnZSBvZiBhbGwgbGFuZ3VhZ2UgZmVhdHVyZXMuIE5vdCBhIGdyZWF0IHZhbHVlIGJ1dCBhbiBhcHByb3hpbWF0aW9uXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IG5ldyBNb3ZpbmdBdmVyYWdlKCk7XG4gICAgICAgIGZvciAoY29uc3QgaW5mbyBvZiB0aGlzLl9kYXRhLnZhbHVlcygpKSB7XG4gICAgICAgICAgICByZXN1bHQudXBkYXRlKGluZm8uZGVmYXVsdCgpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0LnZhbHVlO1xuICAgIH1cbn07XG5MYW5ndWFnZUZlYXR1cmVEZWJvdW5jZVNlcnZpY2UgPSBfX2RlY29yYXRlKFtcbiAgICBfX3BhcmFtKDAsIElMb2dTZXJ2aWNlKSxcbiAgICBfX3BhcmFtKDEsIElFbnZpcm9ubWVudFNlcnZpY2UpXG5dLCBMYW5ndWFnZUZlYXR1cmVEZWJvdW5jZVNlcnZpY2UpO1xuZXhwb3J0IHsgTGFuZ3VhZ2VGZWF0dXJlRGVib3VuY2VTZXJ2aWNlIH07XG5yZWdpc3RlclNpbmdsZXRvbihJTGFuZ3VhZ2VGZWF0dXJlRGVib3VuY2VTZXJ2aWNlLCBMYW5ndWFnZUZlYXR1cmVEZWJvdW5jZVNlcnZpY2UsIDEgLyogSW5zdGFudGlhdGlvblR5cGUuRGVsYXllZCAqLyk7XG4iLCIvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICogIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS4gU2VlIExpY2Vuc2UudHh0IGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIGxpY2Vuc2UgaW5mb3JtYXRpb24uXG4gKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cbmltcG9ydCB7IGNyZWF0ZURlY29yYXRvciB9IGZyb20gJy4uLy4uLy4uL3BsYXRmb3JtL2luc3RhbnRpYXRpb24vY29tbW9uL2luc3RhbnRpYXRpb24uanMnO1xuZXhwb3J0IGNvbnN0IElNYXJrZXJEZWNvcmF0aW9uc1NlcnZpY2UgPSBjcmVhdGVEZWNvcmF0b3IoJ21hcmtlckRlY29yYXRpb25zU2VydmljZScpO1xuIiwiaW1wb3J0IHsgY3JlYXRlRGVjb3JhdG9yIH0gZnJvbSAnLi4vLi4vLi4vcGxhdGZvcm0vaW5zdGFudGlhdGlvbi9jb21tb24vaW5zdGFudGlhdGlvbi5qcyc7XG5leHBvcnQgY29uc3QgSVRleHRNb2RlbFNlcnZpY2UgPSBjcmVhdGVEZWNvcmF0b3IoJ3RleHRNb2RlbFNlcnZpY2UnKTtcbiIsIi8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiAgQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKiAgTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLiBTZWUgTGljZW5zZS50eHQgaW4gdGhlIHByb2plY3Qgcm9vdCBmb3IgbGljZW5zZSBpbmZvcm1hdGlvbi5cbiAqLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuaW1wb3J0IHsgVlNCdWZmZXIgfSBmcm9tICcuLi8uLi8uLi9iYXNlL2NvbW1vbi9idWZmZXIuanMnO1xuaW1wb3J0ICogYXMgcGxhdGZvcm0gZnJvbSAnLi4vLi4vLi4vYmFzZS9jb21tb24vcGxhdGZvcm0uanMnO1xuZnVuY3Rpb24gcmV2ZXJzZUVuZGlhbm5lc3MoYXJyKSB7XG4gICAgZm9yIChsZXQgaSA9IDAsIGxlbiA9IGFyci5sZW5ndGg7IGkgPCBsZW47IGkgKz0gNCkge1xuICAgICAgICAvLyBmbGlwIGJ5dGVzIDA8LT4zIGFuZCAxPC0+MlxuICAgICAgICBjb25zdCBiMCA9IGFycltpICsgMF07XG4gICAgICAgIGNvbnN0IGIxID0gYXJyW2kgKyAxXTtcbiAgICAgICAgY29uc3QgYjIgPSBhcnJbaSArIDJdO1xuICAgICAgICBjb25zdCBiMyA9IGFycltpICsgM107XG4gICAgICAgIGFycltpICsgMF0gPSBiMztcbiAgICAgICAgYXJyW2kgKyAxXSA9IGIyO1xuICAgICAgICBhcnJbaSArIDJdID0gYjE7XG4gICAgICAgIGFycltpICsgM10gPSBiMDtcbiAgICB9XG59XG5mdW5jdGlvbiB0b0xpdHRsZUVuZGlhbkJ1ZmZlcihhcnIpIHtcbiAgICBjb25zdCB1aW50OEFyciA9IG5ldyBVaW50OEFycmF5KGFyci5idWZmZXIsIGFyci5ieXRlT2Zmc2V0LCBhcnIubGVuZ3RoICogNCk7XG4gICAgaWYgKCFwbGF0Zm9ybS5pc0xpdHRsZUVuZGlhbigpKSB7XG4gICAgICAgIC8vIHRoZSBieXRlIG9yZGVyIG11c3QgYmUgY2hhbmdlZFxuICAgICAgICByZXZlcnNlRW5kaWFubmVzcyh1aW50OEFycik7XG4gICAgfVxuICAgIHJldHVybiBWU0J1ZmZlci53cmFwKHVpbnQ4QXJyKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBlbmNvZGVTZW1hbnRpY1Rva2Vuc0R0byhzZW1hbnRpY1Rva2Vucykge1xuICAgIGNvbnN0IGRlc3QgPSBuZXcgVWludDMyQXJyYXkoZW5jb2RlU2VtYW50aWNUb2tlbnNEdG9TaXplKHNlbWFudGljVG9rZW5zKSk7XG4gICAgbGV0IG9mZnNldCA9IDA7XG4gICAgZGVzdFtvZmZzZXQrK10gPSBzZW1hbnRpY1Rva2Vucy5pZDtcbiAgICBpZiAoc2VtYW50aWNUb2tlbnMudHlwZSA9PT0gJ2Z1bGwnKSB7XG4gICAgICAgIGRlc3Rbb2Zmc2V0KytdID0gMSAvKiBFbmNvZGVkU2VtYW50aWNUb2tlbnNUeXBlLkZ1bGwgKi87XG4gICAgICAgIGRlc3Rbb2Zmc2V0KytdID0gc2VtYW50aWNUb2tlbnMuZGF0YS5sZW5ndGg7XG4gICAgICAgIGRlc3Quc2V0KHNlbWFudGljVG9rZW5zLmRhdGEsIG9mZnNldCk7XG4gICAgICAgIG9mZnNldCArPSBzZW1hbnRpY1Rva2Vucy5kYXRhLmxlbmd0aDtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGRlc3Rbb2Zmc2V0KytdID0gMiAvKiBFbmNvZGVkU2VtYW50aWNUb2tlbnNUeXBlLkRlbHRhICovO1xuICAgICAgICBkZXN0W29mZnNldCsrXSA9IHNlbWFudGljVG9rZW5zLmRlbHRhcy5sZW5ndGg7XG4gICAgICAgIGZvciAoY29uc3QgZGVsdGEgb2Ygc2VtYW50aWNUb2tlbnMuZGVsdGFzKSB7XG4gICAgICAgICAgICBkZXN0W29mZnNldCsrXSA9IGRlbHRhLnN0YXJ0O1xuICAgICAgICAgICAgZGVzdFtvZmZzZXQrK10gPSBkZWx0YS5kZWxldGVDb3VudDtcbiAgICAgICAgICAgIGlmIChkZWx0YS5kYXRhKSB7XG4gICAgICAgICAgICAgICAgZGVzdFtvZmZzZXQrK10gPSBkZWx0YS5kYXRhLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBkZXN0LnNldChkZWx0YS5kYXRhLCBvZmZzZXQpO1xuICAgICAgICAgICAgICAgIG9mZnNldCArPSBkZWx0YS5kYXRhLmxlbmd0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGRlc3Rbb2Zmc2V0KytdID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdG9MaXR0bGVFbmRpYW5CdWZmZXIoZGVzdCk7XG59XG5mdW5jdGlvbiBlbmNvZGVTZW1hbnRpY1Rva2Vuc0R0b1NpemUoc2VtYW50aWNUb2tlbnMpIHtcbiAgICBsZXQgcmVzdWx0ID0gMDtcbiAgICByZXN1bHQgKz0gKCsxIC8vIGlkXG4gICAgICAgICsgMSAvLyB0eXBlXG4gICAgKTtcbiAgICBpZiAoc2VtYW50aWNUb2tlbnMudHlwZSA9PT0gJ2Z1bGwnKSB7XG4gICAgICAgIHJlc3VsdCArPSAoKzEgLy8gZGF0YSBsZW5ndGhcbiAgICAgICAgICAgICsgc2VtYW50aWNUb2tlbnMuZGF0YS5sZW5ndGgpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmVzdWx0ICs9ICgrMSAvLyBkZWx0YSBjb3VudFxuICAgICAgICApO1xuICAgICAgICByZXN1bHQgKz0gKCsxIC8vIHN0YXJ0XG4gICAgICAgICAgICArIDEgLy8gZGVsZXRlQ291bnRcbiAgICAgICAgICAgICsgMSAvLyBkYXRhIGxlbmd0aFxuICAgICAgICApICogc2VtYW50aWNUb2tlbnMuZGVsdGFzLmxlbmd0aDtcbiAgICAgICAgZm9yIChjb25zdCBkZWx0YSBvZiBzZW1hbnRpY1Rva2Vucy5kZWx0YXMpIHtcbiAgICAgICAgICAgIGlmIChkZWx0YS5kYXRhKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0ICs9IGRlbHRhLmRhdGEubGVuZ3RoO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG4iLCIvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICogIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS4gU2VlIExpY2Vuc2UudHh0IGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIGxpY2Vuc2UgaW5mb3JtYXRpb24uXG4gKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cbmltcG9ydCB7IGNyZWF0ZURlY29yYXRvciB9IGZyb20gJy4uLy4uLy4uL3BsYXRmb3JtL2luc3RhbnRpYXRpb24vY29tbW9uL2luc3RhbnRpYXRpb24uanMnO1xuZXhwb3J0IGNvbnN0IElTZW1hbnRpY1Rva2Vuc1N0eWxpbmdTZXJ2aWNlID0gY3JlYXRlRGVjb3JhdG9yKCdzZW1hbnRpY1Rva2Vuc1N0eWxpbmdTZXJ2aWNlJyk7XG4iLCIvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICogIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS4gU2VlIExpY2Vuc2UudHh0IGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIGxpY2Vuc2UgaW5mb3JtYXRpb24uXG4gKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cbnZhciBfX2RlY29yYXRlID0gKHRoaXMgJiYgdGhpcy5fX2RlY29yYXRlKSB8fCBmdW5jdGlvbiAoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpIHtcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XG4gICAgZWxzZSBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgaWYgKGQgPSBkZWNvcmF0b3JzW2ldKSByID0gKGMgPCAzID8gZChyKSA6IGMgPiAzID8gZCh0YXJnZXQsIGtleSwgcikgOiBkKHRhcmdldCwga2V5KSkgfHwgcjtcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xufTtcbnZhciBfX3BhcmFtID0gKHRoaXMgJiYgdGhpcy5fX3BhcmFtKSB8fCBmdW5jdGlvbiAocGFyYW1JbmRleCwgZGVjb3JhdG9yKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQsIGtleSkgeyBkZWNvcmF0b3IodGFyZ2V0LCBrZXksIHBhcmFtSW5kZXgpOyB9XG59O1xuaW1wb3J0IHsgRGlzcG9zYWJsZSB9IGZyb20gJy4uLy4uLy4uL2Jhc2UvY29tbW9uL2xpZmVjeWNsZS5qcyc7XG5pbXBvcnQgeyBJTGFuZ3VhZ2VTZXJ2aWNlIH0gZnJvbSAnLi4vbGFuZ3VhZ2VzL2xhbmd1YWdlLmpzJztcbmltcG9ydCB7IElUaGVtZVNlcnZpY2UgfSBmcm9tICcuLi8uLi8uLi9wbGF0Zm9ybS90aGVtZS9jb21tb24vdGhlbWVTZXJ2aWNlLmpzJztcbmltcG9ydCB7IElMb2dTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vLi4vcGxhdGZvcm0vbG9nL2NvbW1vbi9sb2cuanMnO1xuaW1wb3J0IHsgU2VtYW50aWNUb2tlbnNQcm92aWRlclN0eWxpbmcgfSBmcm9tICcuL3NlbWFudGljVG9rZW5zUHJvdmlkZXJTdHlsaW5nLmpzJztcbmltcG9ydCB7IElTZW1hbnRpY1Rva2Vuc1N0eWxpbmdTZXJ2aWNlIH0gZnJvbSAnLi9zZW1hbnRpY1Rva2Vuc1N0eWxpbmcuanMnO1xuaW1wb3J0IHsgcmVnaXN0ZXJTaW5nbGV0b24gfSBmcm9tICcuLi8uLi8uLi9wbGF0Zm9ybS9pbnN0YW50aWF0aW9uL2NvbW1vbi9leHRlbnNpb25zLmpzJztcbmxldCBTZW1hbnRpY1Rva2Vuc1N0eWxpbmdTZXJ2aWNlID0gY2xhc3MgU2VtYW50aWNUb2tlbnNTdHlsaW5nU2VydmljZSBleHRlbmRzIERpc3Bvc2FibGUge1xuICAgIGNvbnN0cnVjdG9yKF90aGVtZVNlcnZpY2UsIF9sb2dTZXJ2aWNlLCBfbGFuZ3VhZ2VTZXJ2aWNlKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuX3RoZW1lU2VydmljZSA9IF90aGVtZVNlcnZpY2U7XG4gICAgICAgIHRoaXMuX2xvZ1NlcnZpY2UgPSBfbG9nU2VydmljZTtcbiAgICAgICAgdGhpcy5fbGFuZ3VhZ2VTZXJ2aWNlID0gX2xhbmd1YWdlU2VydmljZTtcbiAgICAgICAgdGhpcy5fY2FjaGVzID0gbmV3IFdlYWtNYXAoKTtcbiAgICAgICAgdGhpcy5fcmVnaXN0ZXIodGhpcy5fdGhlbWVTZXJ2aWNlLm9uRGlkQ29sb3JUaGVtZUNoYW5nZSgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLl9jYWNoZXMgPSBuZXcgV2Vha01hcCgpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGdldFN0eWxpbmcocHJvdmlkZXIpIHtcbiAgICAgICAgaWYgKCF0aGlzLl9jYWNoZXMuaGFzKHByb3ZpZGVyKSkge1xuICAgICAgICAgICAgdGhpcy5fY2FjaGVzLnNldChwcm92aWRlciwgbmV3IFNlbWFudGljVG9rZW5zUHJvdmlkZXJTdHlsaW5nKHByb3ZpZGVyLmdldExlZ2VuZCgpLCB0aGlzLl90aGVtZVNlcnZpY2UsIHRoaXMuX2xhbmd1YWdlU2VydmljZSwgdGhpcy5fbG9nU2VydmljZSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLl9jYWNoZXMuZ2V0KHByb3ZpZGVyKTtcbiAgICB9XG59O1xuU2VtYW50aWNUb2tlbnNTdHlsaW5nU2VydmljZSA9IF9fZGVjb3JhdGUoW1xuICAgIF9fcGFyYW0oMCwgSVRoZW1lU2VydmljZSksXG4gICAgX19wYXJhbSgxLCBJTG9nU2VydmljZSksXG4gICAgX19wYXJhbSgyLCBJTGFuZ3VhZ2VTZXJ2aWNlKVxuXSwgU2VtYW50aWNUb2tlbnNTdHlsaW5nU2VydmljZSk7XG5leHBvcnQgeyBTZW1hbnRpY1Rva2Vuc1N0eWxpbmdTZXJ2aWNlIH07XG5yZWdpc3RlclNpbmdsZXRvbihJU2VtYW50aWNUb2tlbnNTdHlsaW5nU2VydmljZSwgU2VtYW50aWNUb2tlbnNTdHlsaW5nU2VydmljZSwgMSAvKiBJbnN0YW50aWF0aW9uVHlwZS5EZWxheWVkICovKTtcbiIsIi8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiAgQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKiAgTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLiBTZWUgTGljZW5zZS50eHQgaW4gdGhlIHByb2plY3Qgcm9vdCBmb3IgbGljZW5zZSBpbmZvcm1hdGlvbi5cbiAqLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuZXhwb3J0IHt9O1xuIiwiLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqICBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqICBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuIFNlZSBMaWNlbnNlLnR4dCBpbiB0aGUgcHJvamVjdCByb290IGZvciBsaWNlbnNlIGluZm9ybWF0aW9uLlxuICotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5leHBvcnQgY2xhc3MgVHJlZVZpZXdzRG5EU2VydmljZSB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuX2RyYWdPcGVyYXRpb25zID0gbmV3IE1hcCgpO1xuICAgIH1cbiAgICByZW1vdmVEcmFnT3BlcmF0aW9uVHJhbnNmZXIodXVpZCkge1xuICAgICAgICBpZiAoKHV1aWQgJiYgdGhpcy5fZHJhZ09wZXJhdGlvbnMuaGFzKHV1aWQpKSkge1xuICAgICAgICAgICAgY29uc3Qgb3BlcmF0aW9uID0gdGhpcy5fZHJhZ09wZXJhdGlvbnMuZ2V0KHV1aWQpO1xuICAgICAgICAgICAgdGhpcy5fZHJhZ09wZXJhdGlvbnMuZGVsZXRlKHV1aWQpO1xuICAgICAgICAgICAgcmV0dXJuIG9wZXJhdGlvbjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBEcmFnZ2VkVHJlZUl0ZW1zSWRlbnRpZmllciB7XG4gICAgY29uc3RydWN0b3IoaWRlbnRpZmllcikge1xuICAgICAgICB0aGlzLmlkZW50aWZpZXIgPSBpZGVudGlmaWVyO1xuICAgIH1cbn1cbiIsIi8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiAgQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKiAgTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLiBTZWUgTGljZW5zZS50eHQgaW4gdGhlIHByb2plY3Qgcm9vdCBmb3IgbGljZW5zZSBpbmZvcm1hdGlvbi5cbiAqLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuaW1wb3J0IHsgcmVnaXN0ZXJTaW5nbGV0b24gfSBmcm9tICcuLi8uLi8uLi9wbGF0Zm9ybS9pbnN0YW50aWF0aW9uL2NvbW1vbi9leHRlbnNpb25zLmpzJztcbmltcG9ydCB7IGNyZWF0ZURlY29yYXRvciB9IGZyb20gJy4uLy4uLy4uL3BsYXRmb3JtL2luc3RhbnRpYXRpb24vY29tbW9uL2luc3RhbnRpYXRpb24uanMnO1xuaW1wb3J0IHsgVHJlZVZpZXdzRG5EU2VydmljZSB9IGZyb20gJy4vdHJlZVZpZXdzRG5kLmpzJztcbmV4cG9ydCBjb25zdCBJVHJlZVZpZXdzRG5EU2VydmljZSA9IGNyZWF0ZURlY29yYXRvcigndHJlZVZpZXdzRG5kU2VydmljZScpO1xucmVnaXN0ZXJTaW5nbGV0b24oSVRyZWVWaWV3c0RuRFNlcnZpY2UsIFRyZWVWaWV3c0RuRFNlcnZpY2UsIDEgLyogSW5zdGFudGlhdGlvblR5cGUuRGVsYXllZCAqLyk7XG4iLCJpbXBvcnQgeyBjcmVhdGVEZWNvcmF0b3IgfSBmcm9tICcuLi8uLi9pbnN0YW50aWF0aW9uL2NvbW1vbi9pbnN0YW50aWF0aW9uLmpzJztcbmV4cG9ydCBjb25zdCBJRW52aXJvbm1lbnRTZXJ2aWNlID0gY3JlYXRlRGVjb3JhdG9yKCdlbnZpcm9ubWVudFNlcnZpY2UnKTtcbiIsIi8vI2VuZHJlZ2lvblxuLy8jcmVnaW9uIFV0aWxpdGllc1xuZXhwb3J0IHZhciBGaWxlS2luZDtcbihmdW5jdGlvbiAoRmlsZUtpbmQpIHtcbiAgICBGaWxlS2luZFtGaWxlS2luZFtcIkZJTEVcIl0gPSAwXSA9IFwiRklMRVwiO1xuICAgIEZpbGVLaW5kW0ZpbGVLaW5kW1wiRk9MREVSXCJdID0gMV0gPSBcIkZPTERFUlwiO1xuICAgIEZpbGVLaW5kW0ZpbGVLaW5kW1wiUk9PVF9GT0xERVJcIl0gPSAyXSA9IFwiUk9PVF9GT0xERVJcIjtcbn0pKEZpbGVLaW5kIHx8IChGaWxlS2luZCA9IHt9KSk7XG4vLyNlbmRyZWdpb25cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==