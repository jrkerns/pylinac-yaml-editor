"use strict";(self.webpackChunkpylinac_yaml_editor=self.webpackChunkpylinac_yaml_editor||[]).push([[3958],{3958:(n,t,e)=>{e.d(t,{YW:()=>S,qg:()=>C});var r=e(5958),s=e(8518),l=e(7992),a=e(8019),u=e(3339),i=e(6844);const c="**",o="/",f="[/\\\\]",h="[^/\\\\]",g=/\//g;function p(n,t){switch(n){case 0:return"";case 1:return`${h}*?`;default:return`(?:${f}|${h}+${f}${t?`|${f}${h}+`:""})*?`}}function m(n,t){if(!n)return[];const e=[];let r=!1,s=!1,l="";for(const a of n){switch(a){case t:if(!r&&!s){e.push(l),l="";continue}break;case"{":r=!0;break;case"}":r=!1;break;case"[":s=!0;break;case"]":s=!1}l+=a}return l&&e.push(l),e}function b(n){if(!n)return"";let t="";const e=m(n,o);if(e.every((n=>n===c)))t=".*";else{let n=!1;e.forEach(((r,s)=>{if(r===c){if(n)return;t+=p(2,s===e.length-1)}else{let n=!1,l="",a=!1,u="";for(const e of r)if("}"!==e&&n)l+=e;else if(!a||"]"===e&&u)switch(e){case"{":n=!0;continue;case"[":a=!0;continue;case"}":{const e=`(?:${m(l,",").map((n=>b(n))).join("|")})`;t+=e,n=!1,l="";break}case"]":t+="["+u+"]",a=!1,u="";break;case"?":t+=h;continue;case"*":t+=p(1);continue;default:t+=(0,i.bm)(e)}else{let n;n="-"===e?e:"^"!==e&&"!"!==e||u?e===o?"":(0,i.bm)(e):"^",u+=n}s<e.length-1&&(e[s+1]!==c||s+2<e.length)&&(t+=f)}n=r===c}))}return t}const y=/^\*\*\/\*\.[\w\.-]+$/,d=/^\*\*\/([\w\.-]+)\/?$/,$=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/,w=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/,B=/^\*\*((\/[\w\.-]+)+)\/?$/,P=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,k=new l.qK(1e4),x=function(){return!1},W=function(){return null};function _(n,t){if(!n)return W;let e;e="string"!=typeof n?n.pattern:n,e=e.trim();const r=`${e}_${!!t.trimForExclusions}`;let l,c=k.get(r);return c||(c=y.test(e)?function(n,t){return function(e,r){return"string"==typeof e&&e.endsWith(n)?t:null}}(e.substr(4),e):(l=d.exec(q(e,t)))?function(n,t){const e=`/${n}`,r=`\\${n}`,s=function(s,l){return"string"!=typeof s?null:l?l===n?t:null:s===n||s.endsWith(e)||s.endsWith(r)?t:null},l=[n];return s.basenames=l,s.patterns=[t],s.allBasenames=l,s}(l[1],e):(t.trimForExclusions?w:$).test(e)?function(n,t){const e=V(n.slice(1,-1).split(",").map((n=>_(n,t))).filter((n=>n!==W)),n),r=e.length;if(!r)return W;if(1===r)return e[0];const s=function(t,r){for(let s=0,l=e.length;s<l;s++)if(e[s](t,r))return n;return null},l=e.find((n=>!!n.allBasenames));l&&(s.allBasenames=l.allBasenames);const a=e.reduce(((n,t)=>t.allPaths?n.concat(t.allPaths):n),[]);return a.length&&(s.allPaths=a),s}(e,t):(l=B.exec(q(e,t)))?E(l[1].substr(1),e,!0):(l=P.exec(q(e,t)))?E(l[1],e,!1):function(n){try{const t=new RegExp(`^${b(n)}$`);return function(e){return t.lastIndex=0,"string"==typeof e&&t.test(e)?n:null}}catch(n){return W}}(e),k.set(r,c)),function(n,t){if("string"==typeof t)return n;const e=function(e,r){return(0,s._1)(e,t.base,!u.j9)?n((0,i.NB)(e.substr(t.base.length),a.Vn),r):null};return e.allBasenames=n.allBasenames,e.allPaths=n.allPaths,e.basenames=n.basenames,e.patterns=n.patterns,e}(c,n)}function q(n,t){return t.trimForExclusions&&n.endsWith("/**")?n.substr(0,n.length-2):n}function E(n,t,e){const r=a.Vn===a.SA.sep,s=r?n:n.replace(g,a.Vn),l=a.Vn+s,u=a.SA.sep+n;let i;return i=e?function(e,a){return"string"!=typeof e||e!==s&&!e.endsWith(l)&&(r||e!==n&&!e.endsWith(u))?null:t}:function(e,l){return"string"!=typeof e||e!==s&&(r||e!==n)?null:t},i.allPaths=[(e?"*/":"./")+n],i}function S(n,t,e){return!(!n||"string"!=typeof t)&&C(n)(t,void 0,e)}function C(n,t={}){if(!n)return x;if("string"==typeof n||function(n){const t=n;return!!t&&("string"==typeof t.base&&"string"==typeof t.pattern)}(n)){const e=_(n,t);if(e===W)return x;const r=function(n,t){return!!e(n,t)};return e.allBasenames&&(r.allBasenames=e.allBasenames),e.allPaths&&(r.allPaths=e.allPaths),r}return function(n,t){const e=V(Object.getOwnPropertyNames(n).map((e=>function(n,t,e){if(!1===t)return W;const s=_(n,e);if(s===W)return W;if("boolean"==typeof t)return s;if(t){const e=t.when;if("string"==typeof e){const t=(t,l,a,u)=>{if(!u||!s(t,l))return null;const i=u(e.replace("$(basename)",(()=>a)));return(0,r.Qg)(i)?i.then((t=>t?n:null)):i?n:null};return t.requiresSiblings=!0,t}}return s}(e,n[e],t))).filter((n=>n!==W))),s=e.length;if(!s)return W;if(!e.some((n=>!!n.requiresSiblings))){if(1===s)return e[0];const n=function(n,t){let s;for(let l=0,a=e.length;l<a;l++){const a=e[l](n,t);if("string"==typeof a)return a;(0,r.Qg)(a)&&(s||(s=[]),s.push(a))}return s?(async()=>{for(const n of s){const t=await n;if("string"==typeof t)return t}return null})():null},t=e.find((n=>!!n.allBasenames));t&&(n.allBasenames=t.allBasenames);const l=e.reduce(((n,t)=>t.allPaths?n.concat(t.allPaths):n),[]);return l.length&&(n.allPaths=l),n}const l=function(n,t,s){let l,u;for(let i=0,c=e.length;i<c;i++){const c=e[i];c.requiresSiblings&&s&&(t||(t=(0,a.P8)(n)),l||(l=t.substr(0,t.length-(0,a.LC)(n).length)));const o=c(n,t,l,s);if("string"==typeof o)return o;(0,r.Qg)(o)&&(u||(u=[]),u.push(o))}return u?(async()=>{for(const n of u){const t=await n;if("string"==typeof t)return t}return null})():null},u=e.find((n=>!!n.allBasenames));u&&(l.allBasenames=u.allBasenames);const i=e.reduce(((n,t)=>t.allPaths?n.concat(t.allPaths):n),[]);return i.length&&(l.allPaths=i),l}(n,t)}function V(n,t){const e=n.filter((n=>!!n.basenames));if(e.length<2)return n;const r=e.reduce(((n,t)=>{const e=t.basenames;return e?n.concat(e):n}),[]);let s;if(t){s=[];for(let n=0,e=r.length;n<e;n++)s.push(t)}else s=e.reduce(((n,t)=>{const e=t.patterns;return e?n.concat(e):n}),[]);const l=function(n,t){if("string"!=typeof n)return null;if(!t){let e;for(e=n.length;e>0;e--){const t=n.charCodeAt(e-1);if(47===t||92===t)break}t=n.substr(e)}const e=r.indexOf(t);return-1!==e?s[e]:null};l.basenames=r,l.patterns=s,l.allBasenames=r;const a=n.filter((n=>!n.basenames));return a.push(l),a}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q1gsQyIsInNvdXJjZXMiOlsid2VicGFjazovL3B5bGluYWMteWFtbC1lZGl0b3IvLi9ub2RlX21vZHVsZXMvbW9uYWNvLWVkaXRvci9lc20vdnMvYmFzZS9jb21tb24vZ2xvYi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBpc1RoZW5hYmxlIH0gZnJvbSAnLi9hc3luYy5qcyc7XG5pbXBvcnQgeyBpc0VxdWFsT3JQYXJlbnQgfSBmcm9tICcuL2V4dHBhdGguanMnO1xuaW1wb3J0IHsgTFJVQ2FjaGUgfSBmcm9tICcuL21hcC5qcyc7XG5pbXBvcnQgeyBiYXNlbmFtZSwgZXh0bmFtZSwgcG9zaXgsIHNlcCB9IGZyb20gJy4vcGF0aC5qcyc7XG5pbXBvcnQgeyBpc0xpbnV4IH0gZnJvbSAnLi9wbGF0Zm9ybS5qcyc7XG5pbXBvcnQgeyBlc2NhcGVSZWdFeHBDaGFyYWN0ZXJzLCBsdHJpbSB9IGZyb20gJy4vc3RyaW5ncy5qcyc7XG5leHBvcnQgY29uc3QgR0xPQlNUQVIgPSAnKionO1xuZXhwb3J0IGNvbnN0IEdMT0JfU1BMSVQgPSAnLyc7XG5jb25zdCBQQVRIX1JFR0VYID0gJ1svXFxcXFxcXFxdJzsgLy8gYW55IHNsYXNoIG9yIGJhY2tzbGFzaFxuY29uc3QgTk9fUEFUSF9SRUdFWCA9ICdbXi9cXFxcXFxcXF0nOyAvLyBhbnkgbm9uLXNsYXNoIGFuZCBub24tYmFja3NsYXNoXG5jb25zdCBBTExfRk9SV0FSRF9TTEFTSEVTID0gL1xcLy9nO1xuZnVuY3Rpb24gc3RhcnNUb1JlZ0V4cChzdGFyQ291bnQsIGlzTGFzdFBhdHRlcm4pIHtcbiAgICBzd2l0Y2ggKHN0YXJDb3VudCkge1xuICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgIHJldHVybiBgJHtOT19QQVRIX1JFR0VYfSo/YDsgLy8gMSBzdGFyIG1hdGNoZXMgYW55IG51bWJlciBvZiBjaGFyYWN0ZXJzIGV4Y2VwdCBwYXRoIHNlcGFyYXRvciAoLyBhbmQgXFwpIC0gbm9uIGdyZWVkeSAoPylcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIC8vIE1hdGNoZXM6ICAoUGF0aCBTZXAgT1IgUGF0aCBWYWwgZm9sbG93ZWQgYnkgUGF0aCBTZXApIDAtbWFueSB0aW1lcyBleGNlcHQgd2hlbiBpdCdzIHRoZSBsYXN0IHBhdHRlcm5cbiAgICAgICAgICAgIC8vICAgICAgICAgICBpbiB3aGljaCBjYXNlIGFsc28gbWF0Y2hlcyAoUGF0aCBTZXAgZm9sbG93ZWQgYnkgUGF0aCBWYWwpXG4gICAgICAgICAgICAvLyBHcm91cCBpcyBub24gY2FwdHVyaW5nIGJlY2F1c2Ugd2UgZG9uJ3QgbmVlZCB0byBjYXB0dXJlIGF0IGFsbCAoPzouLi4pXG4gICAgICAgICAgICAvLyBPdmVyYWxsIHdlIHVzZSBub24tZ3JlZWR5IG1hdGNoaW5nIGJlY2F1c2UgaXQgY291bGQgYmUgdGhhdCB3ZSBtYXRjaCB0b28gbXVjaFxuICAgICAgICAgICAgcmV0dXJuIGAoPzoke1BBVEhfUkVHRVh9fCR7Tk9fUEFUSF9SRUdFWH0rJHtQQVRIX1JFR0VYfSR7aXNMYXN0UGF0dGVybiA/IGB8JHtQQVRIX1JFR0VYfSR7Tk9fUEFUSF9SRUdFWH0rYCA6ICcnfSkqP2A7XG4gICAgfVxufVxuZXhwb3J0IGZ1bmN0aW9uIHNwbGl0R2xvYkF3YXJlKHBhdHRlcm4sIHNwbGl0Q2hhcikge1xuICAgIGlmICghcGF0dGVybikge1xuICAgICAgICByZXR1cm4gW107XG4gICAgfVxuICAgIGNvbnN0IHNlZ21lbnRzID0gW107XG4gICAgbGV0IGluQnJhY2VzID0gZmFsc2U7XG4gICAgbGV0IGluQnJhY2tldHMgPSBmYWxzZTtcbiAgICBsZXQgY3VyVmFsID0gJyc7XG4gICAgZm9yIChjb25zdCBjaGFyIG9mIHBhdHRlcm4pIHtcbiAgICAgICAgc3dpdGNoIChjaGFyKSB7XG4gICAgICAgICAgICBjYXNlIHNwbGl0Q2hhcjpcbiAgICAgICAgICAgICAgICBpZiAoIWluQnJhY2VzICYmICFpbkJyYWNrZXRzKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlZ21lbnRzLnB1c2goY3VyVmFsKTtcbiAgICAgICAgICAgICAgICAgICAgY3VyVmFsID0gJyc7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3snOlxuICAgICAgICAgICAgICAgIGluQnJhY2VzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ30nOlxuICAgICAgICAgICAgICAgIGluQnJhY2VzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdbJzpcbiAgICAgICAgICAgICAgICBpbkJyYWNrZXRzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ10nOlxuICAgICAgICAgICAgICAgIGluQnJhY2tldHMgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBjdXJWYWwgKz0gY2hhcjtcbiAgICB9XG4gICAgLy8gVGFpbFxuICAgIGlmIChjdXJWYWwpIHtcbiAgICAgICAgc2VnbWVudHMucHVzaChjdXJWYWwpO1xuICAgIH1cbiAgICByZXR1cm4gc2VnbWVudHM7XG59XG5mdW5jdGlvbiBwYXJzZVJlZ0V4cChwYXR0ZXJuKSB7XG4gICAgaWYgKCFwYXR0ZXJuKSB7XG4gICAgICAgIHJldHVybiAnJztcbiAgICB9XG4gICAgbGV0IHJlZ0V4ID0gJyc7XG4gICAgLy8gU3BsaXQgdXAgaW50byBzZWdtZW50cyBmb3IgZWFjaCBzbGFzaCBmb3VuZFxuICAgIGNvbnN0IHNlZ21lbnRzID0gc3BsaXRHbG9iQXdhcmUocGF0dGVybiwgR0xPQl9TUExJVCk7XG4gICAgLy8gU3BlY2lhbCBjYXNlIHdoZXJlIHdlIG9ubHkgaGF2ZSBnbG9ic3RhcnNcbiAgICBpZiAoc2VnbWVudHMuZXZlcnkoc2VnbWVudCA9PiBzZWdtZW50ID09PSBHTE9CU1RBUikpIHtcbiAgICAgICAgcmVnRXggPSAnLionO1xuICAgIH1cbiAgICAvLyBCdWlsZCByZWdleCBvdmVyIHNlZ21lbnRzXG4gICAgZWxzZSB7XG4gICAgICAgIGxldCBwcmV2aW91c1NlZ21lbnRXYXNHbG9iU3RhciA9IGZhbHNlO1xuICAgICAgICBzZWdtZW50cy5mb3JFYWNoKChzZWdtZW50LCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgLy8gVHJlYXQgZ2xvYnN0YXIgc3BlY2lhbGx5XG4gICAgICAgICAgICBpZiAoc2VnbWVudCA9PT0gR0xPQlNUQVIpIHtcbiAgICAgICAgICAgICAgICAvLyBpZiB3ZSBoYXZlIG1vcmUgdGhhbiBvbmUgZ2xvYnN0YXIgYWZ0ZXIgYW5vdGhlciwganVzdCBpZ25vcmUgaXRcbiAgICAgICAgICAgICAgICBpZiAocHJldmlvdXNTZWdtZW50V2FzR2xvYlN0YXIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZWdFeCArPSBzdGFyc1RvUmVnRXhwKDIsIGluZGV4ID09PSBzZWdtZW50cy5sZW5ndGggLSAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIEFueXRoaW5nIGVsc2UsIG5vdCBnbG9ic3RhclxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gU3RhdGVzXG4gICAgICAgICAgICAgICAgbGV0IGluQnJhY2VzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgbGV0IGJyYWNlVmFsID0gJyc7XG4gICAgICAgICAgICAgICAgbGV0IGluQnJhY2tldHMgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBsZXQgYnJhY2tldFZhbCA9ICcnO1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgY2hhciBvZiBzZWdtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFN1cHBvcnQgYnJhY2UgZXhwYW5zaW9uXG4gICAgICAgICAgICAgICAgICAgIGlmIChjaGFyICE9PSAnfScgJiYgaW5CcmFjZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyYWNlVmFsICs9IGNoYXI7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyBTdXBwb3J0IGJyYWNrZXRzXG4gICAgICAgICAgICAgICAgICAgIGlmIChpbkJyYWNrZXRzICYmIChjaGFyICE9PSAnXScgfHwgIWJyYWNrZXRWYWwpIC8qIF0gaXMgbGl0ZXJhbGx5IG9ubHkgYWxsb3dlZCBhcyBmaXJzdCBjaGFyYWN0ZXIgaW4gYnJhY2tldHMgdG8gbWF0Y2ggaXQgKi8pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCByZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyByYW5nZSBvcGVyYXRvclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNoYXIgPT09ICctJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcyA9IGNoYXI7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBuZWdhdGlvbiBvcGVyYXRvciAob25seSB2YWxpZCBvbiBmaXJzdCBpbmRleCBpbiBicmFja2V0KVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoKGNoYXIgPT09ICdeJyB8fCBjaGFyID09PSAnIScpICYmICFicmFja2V0VmFsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzID0gJ14nO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZ2xvYiBzcGxpdCBtYXRjaGluZyBpcyBub3QgYWxsb3dlZCB3aXRoaW4gY2hhcmFjdGVyIHJhbmdlc1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2VlIGh0dHA6Ly9tYW43Lm9yZy9saW51eC9tYW4tcGFnZXMvbWFuNy9nbG9iLjcuaHRtbFxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoY2hhciA9PT0gR0xPQl9TUExJVCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcyA9ICcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gYW55dGhpbmcgZWxzZSBnZXRzIGVzY2FwZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcyA9IGVzY2FwZVJlZ0V4cENoYXJhY3RlcnMoY2hhcik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBicmFja2V0VmFsICs9IHJlcztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoY2hhcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAneyc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5CcmFjZXMgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnWyc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5CcmFja2V0cyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICd9Jzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNob2ljZXMgPSBzcGxpdEdsb2JBd2FyZShicmFjZVZhbCwgJywnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBDb252ZXJ0cyB7Zm9vLGJhcn0gPT4gW2Zvb3xiYXJdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYnJhY2VSZWdFeHAgPSBgKD86JHtjaG9pY2VzLm1hcChjaG9pY2UgPT4gcGFyc2VSZWdFeHAoY2hvaWNlKSkuam9pbignfCcpfSlgO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZ0V4ICs9IGJyYWNlUmVnRXhwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluQnJhY2VzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJhY2VWYWwgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ10nOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVnRXggKz0gKCdbJyArIGJyYWNrZXRWYWwgKyAnXScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluQnJhY2tldHMgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmFja2V0VmFsID0gJyc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICc/JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWdFeCArPSBOT19QQVRIX1JFR0VYOyAvLyAxID8gbWF0Y2hlcyBhbnkgc2luZ2xlIGNoYXJhY3RlciBleGNlcHQgcGF0aCBzZXBhcmF0b3IgKC8gYW5kIFxcKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnKic6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVnRXggKz0gc3RhcnNUb1JlZ0V4cCgxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVnRXggKz0gZXNjYXBlUmVnRXhwQ2hhcmFjdGVycyhjaGFyKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBUYWlsOiBBZGQgdGhlIHNsYXNoIHdlIGhhZCBzcGxpdCBvbiBpZiB0aGVyZSBpcyBtb3JlIHRvXG4gICAgICAgICAgICAgICAgLy8gY29tZSBhbmQgdGhlIHJlbWFpbmluZyBwYXR0ZXJuIGlzIG5vdCBhIGdsb2JzdGFyXG4gICAgICAgICAgICAgICAgLy8gRm9yIGV4YW1wbGUgaWYgcGF0dGVybjogc29tZS8qKi8qLmpzIHdlIHdhbnQgdGhlIFwiL1wiIGFmdGVyXG4gICAgICAgICAgICAgICAgLy8gc29tZSB0byBiZSBpbmNsdWRlZCBpbiB0aGUgUmVnRXggdG8gcHJldmVudCBhIGZvbGRlciBjYWxsZWRcbiAgICAgICAgICAgICAgICAvLyBcInNvbWV0aGluZ1wiIHRvIG1hdGNoIGFzIHdlbGwuXG4gICAgICAgICAgICAgICAgaWYgKGluZGV4IDwgc2VnbWVudHMubGVuZ3RoIC0gMSAmJiAvLyBtb3JlIHNlZ21lbnRzIHRvIGNvbWUgYWZ0ZXIgdGhpc1xuICAgICAgICAgICAgICAgICAgICAoc2VnbWVudHNbaW5kZXggKyAxXSAhPT0gR0xPQlNUQVIgfHwgLy8gbmV4dCBzZWdtZW50IGlzIG5vdCAqKiwgb3IuLi5cbiAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4ICsgMiA8IHNlZ21lbnRzLmxlbmd0aCAvLyAuLi5uZXh0IHNlZ21lbnQgaXMgKiogYnV0IHRoZXJlIGlzIG1vcmUgc2VnbWVudHMgYWZ0ZXIgdGhhdFxuICAgICAgICAgICAgICAgICAgICApKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlZ0V4ICs9IFBBVEhfUkVHRVg7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gdXBkYXRlIGdsb2JzdGFyIHN0YXRlXG4gICAgICAgICAgICBwcmV2aW91c1NlZ21lbnRXYXNHbG9iU3RhciA9IChzZWdtZW50ID09PSBHTE9CU1RBUik7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gcmVnRXg7XG59XG4vLyByZWdleGVzIHRvIGNoZWNrIGZvciB0cml2aWFsIGdsb2IgcGF0dGVybnMgdGhhdCBqdXN0IGNoZWNrIGZvciBTdHJpbmcjZW5kc1dpdGhcbmNvbnN0IFQxID0gL15cXCpcXCpcXC9cXCpcXC5bXFx3XFwuLV0rJC87IC8vICoqLyouc29tZXRoaW5nXG5jb25zdCBUMiA9IC9eXFwqXFwqXFwvKFtcXHdcXC4tXSspXFwvPyQvOyAvLyAqKi9zb21ldGhpbmdcbmNvbnN0IFQzID0gL157XFwqXFwqXFwvXFwqP1tcXHdcXC4tXStcXC8/KCxcXCpcXCpcXC9cXCo/W1xcd1xcLi1dK1xcLz8pKn0kLzsgLy8geyoqLyouc29tZXRoaW5nLCoqLyouZWxzZX0gb3IgeyoqL3BhY2thZ2UuanNvbiwqKi9wcm9qZWN0Lmpzb259XG5jb25zdCBUM18yID0gL157XFwqXFwqXFwvXFwqP1tcXHdcXC4tXSsoXFwvKFxcKlxcKik/KT8oLFxcKlxcKlxcL1xcKj9bXFx3XFwuLV0rKFxcLyhcXCpcXCopPyk/KSp9JC87IC8vIExpa2UgVDMsIHdpdGggb3B0aW9uYWwgdHJhaWxpbmcgLyoqXG5jb25zdCBUNCA9IC9eXFwqXFwqKChcXC9bXFx3XFwuLV0rKSspXFwvPyQvOyAvLyAqKi9zb21ldGhpbmcvZWxzZVxuY29uc3QgVDUgPSAvXihbXFx3XFwuLV0rKFxcL1tcXHdcXC4tXSspKilcXC8/JC87IC8vIHNvbWV0aGluZy9lbHNlXG5jb25zdCBDQUNIRSA9IG5ldyBMUlVDYWNoZSgxMDAwMCk7IC8vIGJvdW5kZWQgdG8gMTAwMDAgZWxlbWVudHNcbmNvbnN0IEZBTFNFID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBmYWxzZTtcbn07XG5jb25zdCBOVUxMID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBudWxsO1xufTtcbmZ1bmN0aW9uIHBhcnNlUGF0dGVybihhcmcxLCBvcHRpb25zKSB7XG4gICAgaWYgKCFhcmcxKSB7XG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIH1cbiAgICAvLyBIYW5kbGUgcmVsYXRpdmUgcGF0dGVybnNcbiAgICBsZXQgcGF0dGVybjtcbiAgICBpZiAodHlwZW9mIGFyZzEgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHBhdHRlcm4gPSBhcmcxLnBhdHRlcm47XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBwYXR0ZXJuID0gYXJnMTtcbiAgICB9XG4gICAgLy8gV2hpdGVzcGFjZSB0cmltbWluZ1xuICAgIHBhdHRlcm4gPSBwYXR0ZXJuLnRyaW0oKTtcbiAgICAvLyBDaGVjayBjYWNoZVxuICAgIGNvbnN0IHBhdHRlcm5LZXkgPSBgJHtwYXR0ZXJufV8keyEhb3B0aW9ucy50cmltRm9yRXhjbHVzaW9uc31gO1xuICAgIGxldCBwYXJzZWRQYXR0ZXJuID0gQ0FDSEUuZ2V0KHBhdHRlcm5LZXkpO1xuICAgIGlmIChwYXJzZWRQYXR0ZXJuKSB7XG4gICAgICAgIHJldHVybiB3cmFwUmVsYXRpdmVQYXR0ZXJuKHBhcnNlZFBhdHRlcm4sIGFyZzEpO1xuICAgIH1cbiAgICAvLyBDaGVjayBmb3IgVHJpdmlhbHNcbiAgICBsZXQgbWF0Y2g7XG4gICAgaWYgKFQxLnRlc3QocGF0dGVybikpIHtcbiAgICAgICAgcGFyc2VkUGF0dGVybiA9IHRyaXZpYTEocGF0dGVybi5zdWJzdHIoNCksIHBhdHRlcm4pOyAvLyBjb21tb24gcGF0dGVybjogKiovKi50eHQganVzdCBuZWVkIGVuZHNXaXRoIGNoZWNrXG4gICAgfVxuICAgIGVsc2UgaWYgKG1hdGNoID0gVDIuZXhlYyh0cmltRm9yRXhjbHVzaW9ucyhwYXR0ZXJuLCBvcHRpb25zKSkpIHsgLy8gY29tbW9uIHBhdHRlcm46ICoqL3NvbWUudHh0IGp1c3QgbmVlZCBiYXNlbmFtZSBjaGVja1xuICAgICAgICBwYXJzZWRQYXR0ZXJuID0gdHJpdmlhMihtYXRjaFsxXSwgcGF0dGVybik7XG4gICAgfVxuICAgIGVsc2UgaWYgKChvcHRpb25zLnRyaW1Gb3JFeGNsdXNpb25zID8gVDNfMiA6IFQzKS50ZXN0KHBhdHRlcm4pKSB7IC8vIHJlcGV0aXRpb24gb2YgY29tbW9uIHBhdHRlcm5zIChzZWUgYWJvdmUpIHsqKi8qLnR4dCwqKi8qLnBuZ31cbiAgICAgICAgcGFyc2VkUGF0dGVybiA9IHRyaXZpYTMocGF0dGVybiwgb3B0aW9ucyk7XG4gICAgfVxuICAgIGVsc2UgaWYgKG1hdGNoID0gVDQuZXhlYyh0cmltRm9yRXhjbHVzaW9ucyhwYXR0ZXJuLCBvcHRpb25zKSkpIHsgLy8gY29tbW9uIHBhdHRlcm46ICoqL3NvbWV0aGluZy9lbHNlIGp1c3QgbmVlZCBlbmRzV2l0aCBjaGVja1xuICAgICAgICBwYXJzZWRQYXR0ZXJuID0gdHJpdmlhNGFuZDUobWF0Y2hbMV0uc3Vic3RyKDEpLCBwYXR0ZXJuLCB0cnVlKTtcbiAgICB9XG4gICAgZWxzZSBpZiAobWF0Y2ggPSBUNS5leGVjKHRyaW1Gb3JFeGNsdXNpb25zKHBhdHRlcm4sIG9wdGlvbnMpKSkgeyAvLyBjb21tb24gcGF0dGVybjogc29tZXRoaW5nL2Vsc2UganVzdCBuZWVkIGVxdWFscyBjaGVja1xuICAgICAgICBwYXJzZWRQYXR0ZXJuID0gdHJpdmlhNGFuZDUobWF0Y2hbMV0sIHBhdHRlcm4sIGZhbHNlKTtcbiAgICB9XG4gICAgLy8gT3RoZXJ3aXNlIGNvbnZlcnQgdG8gcGF0dGVyblxuICAgIGVsc2Uge1xuICAgICAgICBwYXJzZWRQYXR0ZXJuID0gdG9SZWdFeHAocGF0dGVybik7XG4gICAgfVxuICAgIC8vIENhY2hlXG4gICAgQ0FDSEUuc2V0KHBhdHRlcm5LZXksIHBhcnNlZFBhdHRlcm4pO1xuICAgIHJldHVybiB3cmFwUmVsYXRpdmVQYXR0ZXJuKHBhcnNlZFBhdHRlcm4sIGFyZzEpO1xufVxuZnVuY3Rpb24gd3JhcFJlbGF0aXZlUGF0dGVybihwYXJzZWRQYXR0ZXJuLCBhcmcyKSB7XG4gICAgaWYgKHR5cGVvZiBhcmcyID09PSAnc3RyaW5nJykge1xuICAgICAgICByZXR1cm4gcGFyc2VkUGF0dGVybjtcbiAgICB9XG4gICAgY29uc3Qgd3JhcHBlZFBhdHRlcm4gPSBmdW5jdGlvbiAocGF0aCwgYmFzZW5hbWUpIHtcbiAgICAgICAgaWYgKCFpc0VxdWFsT3JQYXJlbnQocGF0aCwgYXJnMi5iYXNlLCAhaXNMaW51eCkpIHtcbiAgICAgICAgICAgIC8vIHNraXAgZ2xvYiBtYXRjaGluZyBpZiBgYmFzZWAgaXMgbm90IGEgcGFyZW50IG9mIGBwYXRoYFxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgLy8gR2l2ZW4gd2UgaGF2ZSBjaGVja2VkIGBiYXNlYCBiZWluZyBhIHBhcmVudCBvZiBgcGF0aGAsXG4gICAgICAgIC8vIHdlIGNhbiBub3cgcmVtb3ZlIHRoZSBgYmFzZWAgcG9ydGlvbiBvZiB0aGUgYHBhdGhgXG4gICAgICAgIC8vIGFuZCBvbmx5IG1hdGNoIG9uIHRoZSByZW1haW5pbmcgcGF0aCBjb21wb25lbnRzXG4gICAgICAgIC8vIEZvciB0aGF0IHdlIHRyeSB0byBleHRyYWN0IHRoZSBwb3J0aW9uIG9mIHRoZSBgcGF0aGBcbiAgICAgICAgLy8gdGhhdCBjb21lcyBhZnRlciB0aGUgYGJhc2VgIHBvcnRpb24uIFdlIGhhdmUgdG8gYWNjb3VudFxuICAgICAgICAvLyBmb3IgdGhlIGZhY3QgdGhhdCBgYmFzZWAgbWlnaHQgZW5kIGluIGEgcGF0aCBzZXBhcmF0b3JcbiAgICAgICAgLy8gKGh0dHBzOi8vZ2l0aHViLmNvbS9taWNyb3NvZnQvdnNjb2RlL2lzc3Vlcy8xNjI0OTgpXG4gICAgICAgIHJldHVybiBwYXJzZWRQYXR0ZXJuKGx0cmltKHBhdGguc3Vic3RyKGFyZzIuYmFzZS5sZW5ndGgpLCBzZXApLCBiYXNlbmFtZSk7XG4gICAgfTtcbiAgICAvLyBNYWtlIHN1cmUgdG8gcHJlc2VydmUgYXNzb2NpYXRlZCBtZXRhZGF0YVxuICAgIHdyYXBwZWRQYXR0ZXJuLmFsbEJhc2VuYW1lcyA9IHBhcnNlZFBhdHRlcm4uYWxsQmFzZW5hbWVzO1xuICAgIHdyYXBwZWRQYXR0ZXJuLmFsbFBhdGhzID0gcGFyc2VkUGF0dGVybi5hbGxQYXRocztcbiAgICB3cmFwcGVkUGF0dGVybi5iYXNlbmFtZXMgPSBwYXJzZWRQYXR0ZXJuLmJhc2VuYW1lcztcbiAgICB3cmFwcGVkUGF0dGVybi5wYXR0ZXJucyA9IHBhcnNlZFBhdHRlcm4ucGF0dGVybnM7XG4gICAgcmV0dXJuIHdyYXBwZWRQYXR0ZXJuO1xufVxuZnVuY3Rpb24gdHJpbUZvckV4Y2x1c2lvbnMocGF0dGVybiwgb3B0aW9ucykge1xuICAgIHJldHVybiBvcHRpb25zLnRyaW1Gb3JFeGNsdXNpb25zICYmIHBhdHRlcm4uZW5kc1dpdGgoJy8qKicpID8gcGF0dGVybi5zdWJzdHIoMCwgcGF0dGVybi5sZW5ndGggLSAyKSA6IHBhdHRlcm47IC8vIGRyb3BwaW5nICoqLCB0YWlsaW5nIC8gaXMgZHJvcHBlZCBsYXRlclxufVxuLy8gY29tbW9uIHBhdHRlcm46ICoqLyoudHh0IGp1c3QgbmVlZCBlbmRzV2l0aCBjaGVja1xuZnVuY3Rpb24gdHJpdmlhMShiYXNlLCBwYXR0ZXJuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChwYXRoLCBiYXNlbmFtZSkge1xuICAgICAgICByZXR1cm4gdHlwZW9mIHBhdGggPT09ICdzdHJpbmcnICYmIHBhdGguZW5kc1dpdGgoYmFzZSkgPyBwYXR0ZXJuIDogbnVsbDtcbiAgICB9O1xufVxuLy8gY29tbW9uIHBhdHRlcm46ICoqL3NvbWUudHh0IGp1c3QgbmVlZCBiYXNlbmFtZSBjaGVja1xuZnVuY3Rpb24gdHJpdmlhMihiYXNlLCBwYXR0ZXJuKSB7XG4gICAgY29uc3Qgc2xhc2hCYXNlID0gYC8ke2Jhc2V9YDtcbiAgICBjb25zdCBiYWNrc2xhc2hCYXNlID0gYFxcXFwke2Jhc2V9YDtcbiAgICBjb25zdCBwYXJzZWRQYXR0ZXJuID0gZnVuY3Rpb24gKHBhdGgsIGJhc2VuYW1lKSB7XG4gICAgICAgIGlmICh0eXBlb2YgcGF0aCAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGlmIChiYXNlbmFtZSkge1xuICAgICAgICAgICAgcmV0dXJuIGJhc2VuYW1lID09PSBiYXNlID8gcGF0dGVybiA6IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHBhdGggPT09IGJhc2UgfHwgcGF0aC5lbmRzV2l0aChzbGFzaEJhc2UpIHx8IHBhdGguZW5kc1dpdGgoYmFja3NsYXNoQmFzZSkgPyBwYXR0ZXJuIDogbnVsbDtcbiAgICB9O1xuICAgIGNvbnN0IGJhc2VuYW1lcyA9IFtiYXNlXTtcbiAgICBwYXJzZWRQYXR0ZXJuLmJhc2VuYW1lcyA9IGJhc2VuYW1lcztcbiAgICBwYXJzZWRQYXR0ZXJuLnBhdHRlcm5zID0gW3BhdHRlcm5dO1xuICAgIHBhcnNlZFBhdHRlcm4uYWxsQmFzZW5hbWVzID0gYmFzZW5hbWVzO1xuICAgIHJldHVybiBwYXJzZWRQYXR0ZXJuO1xufVxuLy8gcmVwZXRpdGlvbiBvZiBjb21tb24gcGF0dGVybnMgKHNlZSBhYm92ZSkgeyoqLyoudHh0LCoqLyoucG5nfVxuZnVuY3Rpb24gdHJpdmlhMyhwYXR0ZXJuLCBvcHRpb25zKSB7XG4gICAgY29uc3QgcGFyc2VkUGF0dGVybnMgPSBhZ2dyZWdhdGVCYXNlbmFtZU1hdGNoZXMocGF0dGVybi5zbGljZSgxLCAtMSlcbiAgICAgICAgLnNwbGl0KCcsJylcbiAgICAgICAgLm1hcChwYXR0ZXJuID0+IHBhcnNlUGF0dGVybihwYXR0ZXJuLCBvcHRpb25zKSlcbiAgICAgICAgLmZpbHRlcihwYXR0ZXJuID0+IHBhdHRlcm4gIT09IE5VTEwpLCBwYXR0ZXJuKTtcbiAgICBjb25zdCBwYXR0ZXJuc0xlbmd0aCA9IHBhcnNlZFBhdHRlcm5zLmxlbmd0aDtcbiAgICBpZiAoIXBhdHRlcm5zTGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBOVUxMO1xuICAgIH1cbiAgICBpZiAocGF0dGVybnNMZW5ndGggPT09IDEpIHtcbiAgICAgICAgcmV0dXJuIHBhcnNlZFBhdHRlcm5zWzBdO1xuICAgIH1cbiAgICBjb25zdCBwYXJzZWRQYXR0ZXJuID0gZnVuY3Rpb24gKHBhdGgsIGJhc2VuYW1lKSB7XG4gICAgICAgIGZvciAobGV0IGkgPSAwLCBuID0gcGFyc2VkUGF0dGVybnMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XG4gICAgICAgICAgICBpZiAocGFyc2VkUGF0dGVybnNbaV0ocGF0aCwgYmFzZW5hbWUpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHBhdHRlcm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBjb25zdCB3aXRoQmFzZW5hbWVzID0gcGFyc2VkUGF0dGVybnMuZmluZChwYXR0ZXJuID0+ICEhcGF0dGVybi5hbGxCYXNlbmFtZXMpO1xuICAgIGlmICh3aXRoQmFzZW5hbWVzKSB7XG4gICAgICAgIHBhcnNlZFBhdHRlcm4uYWxsQmFzZW5hbWVzID0gd2l0aEJhc2VuYW1lcy5hbGxCYXNlbmFtZXM7XG4gICAgfVxuICAgIGNvbnN0IGFsbFBhdGhzID0gcGFyc2VkUGF0dGVybnMucmVkdWNlKChhbGwsIGN1cnJlbnQpID0+IGN1cnJlbnQuYWxsUGF0aHMgPyBhbGwuY29uY2F0KGN1cnJlbnQuYWxsUGF0aHMpIDogYWxsLCBbXSk7XG4gICAgaWYgKGFsbFBhdGhzLmxlbmd0aCkge1xuICAgICAgICBwYXJzZWRQYXR0ZXJuLmFsbFBhdGhzID0gYWxsUGF0aHM7XG4gICAgfVxuICAgIHJldHVybiBwYXJzZWRQYXR0ZXJuO1xufVxuLy8gY29tbW9uIHBhdHRlcm5zOiAqKi9zb21ldGhpbmcvZWxzZSBqdXN0IG5lZWQgZW5kc1dpdGggY2hlY2ssIHNvbWV0aGluZy9lbHNlIGp1c3QgbmVlZHMgYW5kIGVxdWFscyBjaGVja1xuZnVuY3Rpb24gdHJpdmlhNGFuZDUodGFyZ2V0UGF0aCwgcGF0dGVybiwgbWF0Y2hQYXRoRW5kcykge1xuICAgIGNvbnN0IHVzaW5nUG9zaXhTZXAgPSBzZXAgPT09IHBvc2l4LnNlcDtcbiAgICBjb25zdCBuYXRpdmVQYXRoID0gdXNpbmdQb3NpeFNlcCA/IHRhcmdldFBhdGggOiB0YXJnZXRQYXRoLnJlcGxhY2UoQUxMX0ZPUldBUkRfU0xBU0hFUywgc2VwKTtcbiAgICBjb25zdCBuYXRpdmVQYXRoRW5kID0gc2VwICsgbmF0aXZlUGF0aDtcbiAgICBjb25zdCB0YXJnZXRQYXRoRW5kID0gcG9zaXguc2VwICsgdGFyZ2V0UGF0aDtcbiAgICBsZXQgcGFyc2VkUGF0dGVybjtcbiAgICBpZiAobWF0Y2hQYXRoRW5kcykge1xuICAgICAgICBwYXJzZWRQYXR0ZXJuID0gZnVuY3Rpb24gKHBhdGgsIGJhc2VuYW1lKSB7XG4gICAgICAgICAgICByZXR1cm4gdHlwZW9mIHBhdGggPT09ICdzdHJpbmcnICYmICgocGF0aCA9PT0gbmF0aXZlUGF0aCB8fCBwYXRoLmVuZHNXaXRoKG5hdGl2ZVBhdGhFbmQpKSB8fCAhdXNpbmdQb3NpeFNlcCAmJiAocGF0aCA9PT0gdGFyZ2V0UGF0aCB8fCBwYXRoLmVuZHNXaXRoKHRhcmdldFBhdGhFbmQpKSkgPyBwYXR0ZXJuIDogbnVsbDtcbiAgICAgICAgfTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHBhcnNlZFBhdHRlcm4gPSBmdW5jdGlvbiAocGF0aCwgYmFzZW5hbWUpIHtcbiAgICAgICAgICAgIHJldHVybiB0eXBlb2YgcGF0aCA9PT0gJ3N0cmluZycgJiYgKHBhdGggPT09IG5hdGl2ZVBhdGggfHwgKCF1c2luZ1Bvc2l4U2VwICYmIHBhdGggPT09IHRhcmdldFBhdGgpKSA/IHBhdHRlcm4gOiBudWxsO1xuICAgICAgICB9O1xuICAgIH1cbiAgICBwYXJzZWRQYXR0ZXJuLmFsbFBhdGhzID0gWyhtYXRjaFBhdGhFbmRzID8gJyovJyA6ICcuLycpICsgdGFyZ2V0UGF0aF07XG4gICAgcmV0dXJuIHBhcnNlZFBhdHRlcm47XG59XG5mdW5jdGlvbiB0b1JlZ0V4cChwYXR0ZXJuKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcmVnRXhwID0gbmV3IFJlZ0V4cChgXiR7cGFyc2VSZWdFeHAocGF0dGVybil9JGApO1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHBhdGgpIHtcbiAgICAgICAgICAgIHJlZ0V4cC5sYXN0SW5kZXggPSAwOyAvLyByZXNldCBSZWdFeHAgdG8gaXRzIGluaXRpYWwgc3RhdGUgdG8gcmV1c2UgaXQhXG4gICAgICAgICAgICByZXR1cm4gdHlwZW9mIHBhdGggPT09ICdzdHJpbmcnICYmIHJlZ0V4cC50ZXN0KHBhdGgpID8gcGF0dGVybiA6IG51bGw7XG4gICAgICAgIH07XG4gICAgfVxuICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICByZXR1cm4gTlVMTDtcbiAgICB9XG59XG5leHBvcnQgZnVuY3Rpb24gbWF0Y2goYXJnMSwgcGF0aCwgaGFzU2libGluZykge1xuICAgIGlmICghYXJnMSB8fCB0eXBlb2YgcGF0aCAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gcGFyc2UoYXJnMSkocGF0aCwgdW5kZWZpbmVkLCBoYXNTaWJsaW5nKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZShhcmcxLCBvcHRpb25zID0ge30pIHtcbiAgICBpZiAoIWFyZzEpIHtcbiAgICAgICAgcmV0dXJuIEZBTFNFO1xuICAgIH1cbiAgICAvLyBHbG9iIHdpdGggU3RyaW5nXG4gICAgaWYgKHR5cGVvZiBhcmcxID09PSAnc3RyaW5nJyB8fCBpc1JlbGF0aXZlUGF0dGVybihhcmcxKSkge1xuICAgICAgICBjb25zdCBwYXJzZWRQYXR0ZXJuID0gcGFyc2VQYXR0ZXJuKGFyZzEsIG9wdGlvbnMpO1xuICAgICAgICBpZiAocGFyc2VkUGF0dGVybiA9PT0gTlVMTCkge1xuICAgICAgICAgICAgcmV0dXJuIEZBTFNFO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHJlc3VsdFBhdHRlcm4gPSBmdW5jdGlvbiAocGF0aCwgYmFzZW5hbWUpIHtcbiAgICAgICAgICAgIHJldHVybiAhIXBhcnNlZFBhdHRlcm4ocGF0aCwgYmFzZW5hbWUpO1xuICAgICAgICB9O1xuICAgICAgICBpZiAocGFyc2VkUGF0dGVybi5hbGxCYXNlbmFtZXMpIHtcbiAgICAgICAgICAgIHJlc3VsdFBhdHRlcm4uYWxsQmFzZW5hbWVzID0gcGFyc2VkUGF0dGVybi5hbGxCYXNlbmFtZXM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcnNlZFBhdHRlcm4uYWxsUGF0aHMpIHtcbiAgICAgICAgICAgIHJlc3VsdFBhdHRlcm4uYWxsUGF0aHMgPSBwYXJzZWRQYXR0ZXJuLmFsbFBhdGhzO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHRQYXR0ZXJuO1xuICAgIH1cbiAgICAvLyBHbG9iIHdpdGggRXhwcmVzc2lvblxuICAgIHJldHVybiBwYXJzZWRFeHByZXNzaW9uKGFyZzEsIG9wdGlvbnMpO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGlzUmVsYXRpdmVQYXR0ZXJuKG9iaikge1xuICAgIGNvbnN0IHJwID0gb2JqO1xuICAgIGlmICghcnApIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gdHlwZW9mIHJwLmJhc2UgPT09ICdzdHJpbmcnICYmIHR5cGVvZiBycC5wYXR0ZXJuID09PSAnc3RyaW5nJztcbn1cbmZ1bmN0aW9uIHBhcnNlZEV4cHJlc3Npb24oZXhwcmVzc2lvbiwgb3B0aW9ucykge1xuICAgIGNvbnN0IHBhcnNlZFBhdHRlcm5zID0gYWdncmVnYXRlQmFzZW5hbWVNYXRjaGVzKE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKGV4cHJlc3Npb24pXG4gICAgICAgIC5tYXAocGF0dGVybiA9PiBwYXJzZUV4cHJlc3Npb25QYXR0ZXJuKHBhdHRlcm4sIGV4cHJlc3Npb25bcGF0dGVybl0sIG9wdGlvbnMpKVxuICAgICAgICAuZmlsdGVyKHBhdHRlcm4gPT4gcGF0dGVybiAhPT0gTlVMTCkpO1xuICAgIGNvbnN0IHBhdHRlcm5zTGVuZ3RoID0gcGFyc2VkUGF0dGVybnMubGVuZ3RoO1xuICAgIGlmICghcGF0dGVybnNMZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgfVxuICAgIGlmICghcGFyc2VkUGF0dGVybnMuc29tZShwYXJzZWRQYXR0ZXJuID0+ICEhcGFyc2VkUGF0dGVybi5yZXF1aXJlc1NpYmxpbmdzKSkge1xuICAgICAgICBpZiAocGF0dGVybnNMZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgIHJldHVybiBwYXJzZWRQYXR0ZXJuc1swXTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCByZXN1bHRFeHByZXNzaW9uID0gZnVuY3Rpb24gKHBhdGgsIGJhc2VuYW1lKSB7XG4gICAgICAgICAgICBsZXQgcmVzdWx0UHJvbWlzZXMgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMCwgbiA9IHBhcnNlZFBhdHRlcm5zLmxlbmd0aDsgaSA8IG47IGkrKykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHBhcnNlZFBhdHRlcm5zW2ldKHBhdGgsIGJhc2VuYW1lKTtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHJlc3VsdCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDsgLy8gaW1tZWRpYXRlbHkgcmV0dXJuIGFzIHNvb24gYXMgdGhlIGZpcnN0IGV4cHJlc3Npb24gbWF0Y2hlc1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBJZiB0aGUgcmVzdWx0IGlzIGEgcHJvbWlzZSwgd2UgaGF2ZSB0byBrZWVwIGl0IGZvclxuICAgICAgICAgICAgICAgIC8vIGxhdGVyIHByb2Nlc3NpbmcgYW5kIGF3YWl0IHRoZSByZXN1bHQgcHJvcGVybHkuXG4gICAgICAgICAgICAgICAgaWYgKGlzVGhlbmFibGUocmVzdWx0KSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXJlc3VsdFByb21pc2VzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRQcm9taXNlcyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdFByb21pc2VzLnB1c2gocmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBXaXRoIHJlc3VsdCBwcm9taXNlcywgd2UgaGF2ZSB0byBsb29wIG92ZXIgZWFjaCBhbmRcbiAgICAgICAgICAgIC8vIGF3YWl0IHRoZSByZXN1bHQgYmVmb3JlIHdlIGNhbiByZXR1cm4gYW55IHJlc3VsdC5cbiAgICAgICAgICAgIGlmIChyZXN1bHRQcm9taXNlcykge1xuICAgICAgICAgICAgICAgIHJldHVybiAoYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHJlc3VsdFByb21pc2Ugb2YgcmVzdWx0UHJvbWlzZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlc3VsdFByb21pc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHJlc3VsdCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgIH0pKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3Qgd2l0aEJhc2VuYW1lcyA9IHBhcnNlZFBhdHRlcm5zLmZpbmQocGF0dGVybiA9PiAhIXBhdHRlcm4uYWxsQmFzZW5hbWVzKTtcbiAgICAgICAgaWYgKHdpdGhCYXNlbmFtZXMpIHtcbiAgICAgICAgICAgIHJlc3VsdEV4cHJlc3Npb24uYWxsQmFzZW5hbWVzID0gd2l0aEJhc2VuYW1lcy5hbGxCYXNlbmFtZXM7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgYWxsUGF0aHMgPSBwYXJzZWRQYXR0ZXJucy5yZWR1Y2UoKGFsbCwgY3VycmVudCkgPT4gY3VycmVudC5hbGxQYXRocyA/IGFsbC5jb25jYXQoY3VycmVudC5hbGxQYXRocykgOiBhbGwsIFtdKTtcbiAgICAgICAgaWYgKGFsbFBhdGhzLmxlbmd0aCkge1xuICAgICAgICAgICAgcmVzdWx0RXhwcmVzc2lvbi5hbGxQYXRocyA9IGFsbFBhdGhzO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHRFeHByZXNzaW9uO1xuICAgIH1cbiAgICBjb25zdCByZXN1bHRFeHByZXNzaW9uID0gZnVuY3Rpb24gKHBhdGgsIGJhc2UsIGhhc1NpYmxpbmcpIHtcbiAgICAgICAgbGV0IG5hbWUgPSB1bmRlZmluZWQ7XG4gICAgICAgIGxldCByZXN1bHRQcm9taXNlcyA9IHVuZGVmaW5lZDtcbiAgICAgICAgZm9yIChsZXQgaSA9IDAsIG4gPSBwYXJzZWRQYXR0ZXJucy5sZW5ndGg7IGkgPCBuOyBpKyspIHtcbiAgICAgICAgICAgIC8vIFBhdHRlcm4gbWF0Y2hlcyBwYXRoXG4gICAgICAgICAgICBjb25zdCBwYXJzZWRQYXR0ZXJuID0gcGFyc2VkUGF0dGVybnNbaV07XG4gICAgICAgICAgICBpZiAocGFyc2VkUGF0dGVybi5yZXF1aXJlc1NpYmxpbmdzICYmIGhhc1NpYmxpbmcpIHtcbiAgICAgICAgICAgICAgICBpZiAoIWJhc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgYmFzZSA9IGJhc2VuYW1lKHBhdGgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoIW5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZSA9IGJhc2Uuc3Vic3RyKDAsIGJhc2UubGVuZ3RoIC0gZXh0bmFtZShwYXRoKS5sZW5ndGgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHBhcnNlZFBhdHRlcm4ocGF0aCwgYmFzZSwgbmFtZSwgaGFzU2libGluZyk7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHJlc3VsdCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0OyAvLyBpbW1lZGlhdGVseSByZXR1cm4gYXMgc29vbiBhcyB0aGUgZmlyc3QgZXhwcmVzc2lvbiBtYXRjaGVzXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBJZiB0aGUgcmVzdWx0IGlzIGEgcHJvbWlzZSwgd2UgaGF2ZSB0byBrZWVwIGl0IGZvclxuICAgICAgICAgICAgLy8gbGF0ZXIgcHJvY2Vzc2luZyBhbmQgYXdhaXQgdGhlIHJlc3VsdCBwcm9wZXJseS5cbiAgICAgICAgICAgIGlmIChpc1RoZW5hYmxlKHJlc3VsdCkpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXJlc3VsdFByb21pc2VzKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdFByb21pc2VzID0gW107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJlc3VsdFByb21pc2VzLnB1c2gocmVzdWx0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBXaXRoIHJlc3VsdCBwcm9taXNlcywgd2UgaGF2ZSB0byBsb29wIG92ZXIgZWFjaCBhbmRcbiAgICAgICAgLy8gYXdhaXQgdGhlIHJlc3VsdCBiZWZvcmUgd2UgY2FuIHJldHVybiBhbnkgcmVzdWx0LlxuICAgICAgICBpZiAocmVzdWx0UHJvbWlzZXMpIHtcbiAgICAgICAgICAgIHJldHVybiAoYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgcmVzdWx0UHJvbWlzZSBvZiByZXN1bHRQcm9taXNlcykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZXN1bHRQcm9taXNlO1xuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHJlc3VsdCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9KSgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgY29uc3Qgd2l0aEJhc2VuYW1lcyA9IHBhcnNlZFBhdHRlcm5zLmZpbmQocGF0dGVybiA9PiAhIXBhdHRlcm4uYWxsQmFzZW5hbWVzKTtcbiAgICBpZiAod2l0aEJhc2VuYW1lcykge1xuICAgICAgICByZXN1bHRFeHByZXNzaW9uLmFsbEJhc2VuYW1lcyA9IHdpdGhCYXNlbmFtZXMuYWxsQmFzZW5hbWVzO1xuICAgIH1cbiAgICBjb25zdCBhbGxQYXRocyA9IHBhcnNlZFBhdHRlcm5zLnJlZHVjZSgoYWxsLCBjdXJyZW50KSA9PiBjdXJyZW50LmFsbFBhdGhzID8gYWxsLmNvbmNhdChjdXJyZW50LmFsbFBhdGhzKSA6IGFsbCwgW10pO1xuICAgIGlmIChhbGxQYXRocy5sZW5ndGgpIHtcbiAgICAgICAgcmVzdWx0RXhwcmVzc2lvbi5hbGxQYXRocyA9IGFsbFBhdGhzO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0RXhwcmVzc2lvbjtcbn1cbmZ1bmN0aW9uIHBhcnNlRXhwcmVzc2lvblBhdHRlcm4ocGF0dGVybiwgdmFsdWUsIG9wdGlvbnMpIHtcbiAgICBpZiAodmFsdWUgPT09IGZhbHNlKSB7XG4gICAgICAgIHJldHVybiBOVUxMOyAvLyBwYXR0ZXJuIGlzIGRpc2FibGVkXG4gICAgfVxuICAgIGNvbnN0IHBhcnNlZFBhdHRlcm4gPSBwYXJzZVBhdHRlcm4ocGF0dGVybiwgb3B0aW9ucyk7XG4gICAgaWYgKHBhcnNlZFBhdHRlcm4gPT09IE5VTEwpIHtcbiAgICAgICAgcmV0dXJuIE5VTEw7XG4gICAgfVxuICAgIC8vIEV4cHJlc3Npb24gUGF0dGVybiBpcyA8Ym9vbGVhbj5cbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnYm9vbGVhbicpIHtcbiAgICAgICAgcmV0dXJuIHBhcnNlZFBhdHRlcm47XG4gICAgfVxuICAgIC8vIEV4cHJlc3Npb24gUGF0dGVybiBpcyA8U2libGluZ0NsYXVzZT5cbiAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgY29uc3Qgd2hlbiA9IHZhbHVlLndoZW47XG4gICAgICAgIGlmICh0eXBlb2Ygd2hlbiA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IChwYXRoLCBiYXNlbmFtZSwgbmFtZSwgaGFzU2libGluZykgPT4ge1xuICAgICAgICAgICAgICAgIGlmICghaGFzU2libGluZyB8fCAhcGFyc2VkUGF0dGVybihwYXRoLCBiYXNlbmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IGNsYXVzZVBhdHRlcm4gPSB3aGVuLnJlcGxhY2UoJyQoYmFzZW5hbWUpJywgKCkgPT4gbmFtZSk7XG4gICAgICAgICAgICAgICAgY29uc3QgbWF0Y2hlZCA9IGhhc1NpYmxpbmcoY2xhdXNlUGF0dGVybik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGlzVGhlbmFibGUobWF0Y2hlZCkgP1xuICAgICAgICAgICAgICAgICAgICBtYXRjaGVkLnRoZW4obWF0Y2ggPT4gbWF0Y2ggPyBwYXR0ZXJuIDogbnVsbCkgOlxuICAgICAgICAgICAgICAgICAgICBtYXRjaGVkID8gcGF0dGVybiA6IG51bGw7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmVzdWx0LnJlcXVpcmVzU2libGluZ3MgPSB0cnVlO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvLyBFeHByZXNzaW9uIGlzIGFueXRoaW5nXG4gICAgcmV0dXJuIHBhcnNlZFBhdHRlcm47XG59XG5mdW5jdGlvbiBhZ2dyZWdhdGVCYXNlbmFtZU1hdGNoZXMocGFyc2VkUGF0dGVybnMsIHJlc3VsdCkge1xuICAgIGNvbnN0IGJhc2VuYW1lUGF0dGVybnMgPSBwYXJzZWRQYXR0ZXJucy5maWx0ZXIocGFyc2VkUGF0dGVybiA9PiAhIXBhcnNlZFBhdHRlcm4uYmFzZW5hbWVzKTtcbiAgICBpZiAoYmFzZW5hbWVQYXR0ZXJucy5sZW5ndGggPCAyKSB7XG4gICAgICAgIHJldHVybiBwYXJzZWRQYXR0ZXJucztcbiAgICB9XG4gICAgY29uc3QgYmFzZW5hbWVzID0gYmFzZW5hbWVQYXR0ZXJucy5yZWR1Y2UoKGFsbCwgY3VycmVudCkgPT4ge1xuICAgICAgICBjb25zdCBiYXNlbmFtZXMgPSBjdXJyZW50LmJhc2VuYW1lcztcbiAgICAgICAgcmV0dXJuIGJhc2VuYW1lcyA/IGFsbC5jb25jYXQoYmFzZW5hbWVzKSA6IGFsbDtcbiAgICB9LCBbXSk7XG4gICAgbGV0IHBhdHRlcm5zO1xuICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgcGF0dGVybnMgPSBbXTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDAsIG4gPSBiYXNlbmFtZXMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XG4gICAgICAgICAgICBwYXR0ZXJucy5wdXNoKHJlc3VsdCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHBhdHRlcm5zID0gYmFzZW5hbWVQYXR0ZXJucy5yZWR1Y2UoKGFsbCwgY3VycmVudCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgcGF0dGVybnMgPSBjdXJyZW50LnBhdHRlcm5zO1xuICAgICAgICAgICAgcmV0dXJuIHBhdHRlcm5zID8gYWxsLmNvbmNhdChwYXR0ZXJucykgOiBhbGw7XG4gICAgICAgIH0sIFtdKTtcbiAgICB9XG4gICAgY29uc3QgYWdncmVnYXRlID0gZnVuY3Rpb24gKHBhdGgsIGJhc2VuYW1lKSB7XG4gICAgICAgIGlmICh0eXBlb2YgcGF0aCAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGlmICghYmFzZW5hbWUpIHtcbiAgICAgICAgICAgIGxldCBpO1xuICAgICAgICAgICAgZm9yIChpID0gcGF0aC5sZW5ndGg7IGkgPiAwOyBpLS0pIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjaCA9IHBhdGguY2hhckNvZGVBdChpIC0gMSk7XG4gICAgICAgICAgICAgICAgaWYgKGNoID09PSA0NyAvKiBDaGFyQ29kZS5TbGFzaCAqLyB8fCBjaCA9PT0gOTIgLyogQ2hhckNvZGUuQmFja3NsYXNoICovKSB7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJhc2VuYW1lID0gcGF0aC5zdWJzdHIoaSk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaW5kZXggPSBiYXNlbmFtZXMuaW5kZXhPZihiYXNlbmFtZSk7XG4gICAgICAgIHJldHVybiBpbmRleCAhPT0gLTEgPyBwYXR0ZXJuc1tpbmRleF0gOiBudWxsO1xuICAgIH07XG4gICAgYWdncmVnYXRlLmJhc2VuYW1lcyA9IGJhc2VuYW1lcztcbiAgICBhZ2dyZWdhdGUucGF0dGVybnMgPSBwYXR0ZXJucztcbiAgICBhZ2dyZWdhdGUuYWxsQmFzZW5hbWVzID0gYmFzZW5hbWVzO1xuICAgIGNvbnN0IGFnZ3JlZ2F0ZWRQYXR0ZXJucyA9IHBhcnNlZFBhdHRlcm5zLmZpbHRlcihwYXJzZWRQYXR0ZXJuID0+ICFwYXJzZWRQYXR0ZXJuLmJhc2VuYW1lcyk7XG4gICAgYWdncmVnYXRlZFBhdHRlcm5zLnB1c2goYWdncmVnYXRlKTtcbiAgICByZXR1cm4gYWdncmVnYXRlZFBhdHRlcm5zO1xufVxuIl0sIm5hbWVzIjpbIkdMT0JTVEFSIiwiR0xPQl9TUExJVCIsIlBBVEhfUkVHRVgiLCJOT19QQVRIX1JFR0VYIiwiQUxMX0ZPUldBUkRfU0xBU0hFUyIsInN0YXJzVG9SZWdFeHAiLCJzdGFyQ291bnQiLCJpc0xhc3RQYXR0ZXJuIiwic3BsaXRHbG9iQXdhcmUiLCJwYXR0ZXJuIiwic3BsaXRDaGFyIiwic2VnbWVudHMiLCJpbkJyYWNlcyIsImluQnJhY2tldHMiLCJjdXJWYWwiLCJjaGFyIiwicHVzaCIsInBhcnNlUmVnRXhwIiwicmVnRXgiLCJldmVyeSIsInNlZ21lbnQiLCJwcmV2aW91c1NlZ21lbnRXYXNHbG9iU3RhciIsImZvckVhY2giLCJpbmRleCIsImxlbmd0aCIsImJyYWNlVmFsIiwiYnJhY2tldFZhbCIsImJyYWNlUmVnRXhwIiwibWFwIiwiY2hvaWNlIiwiam9pbiIsInJlcyIsIlQxIiwiVDIiLCJUMyIsIlQzXzIiLCJUNCIsIlQ1IiwiQ0FDSEUiLCJGQUxTRSIsIk5VTEwiLCJwYXJzZVBhdHRlcm4iLCJhcmcxIiwib3B0aW9ucyIsInRyaW0iLCJwYXR0ZXJuS2V5IiwidHJpbUZvckV4Y2x1c2lvbnMiLCJtYXRjaCIsInBhcnNlZFBhdHRlcm4iLCJnZXQiLCJ0ZXN0IiwiYmFzZSIsInBhdGgiLCJiYXNlbmFtZSIsImVuZHNXaXRoIiwidHJpdmlhMSIsInN1YnN0ciIsImV4ZWMiLCJzbGFzaEJhc2UiLCJiYWNrc2xhc2hCYXNlIiwiYmFzZW5hbWVzIiwicGF0dGVybnMiLCJhbGxCYXNlbmFtZXMiLCJ0cml2aWEyIiwicGFyc2VkUGF0dGVybnMiLCJhZ2dyZWdhdGVCYXNlbmFtZU1hdGNoZXMiLCJzbGljZSIsInNwbGl0IiwiZmlsdGVyIiwicGF0dGVybnNMZW5ndGgiLCJpIiwibiIsIndpdGhCYXNlbmFtZXMiLCJmaW5kIiwiYWxsUGF0aHMiLCJyZWR1Y2UiLCJhbGwiLCJjdXJyZW50IiwiY29uY2F0IiwidHJpdmlhMyIsInRyaXZpYTRhbmQ1IiwicmVnRXhwIiwiUmVnRXhwIiwibGFzdEluZGV4IiwiZXJyb3IiLCJ0b1JlZ0V4cCIsInNldCIsImFyZzIiLCJ3cmFwcGVkUGF0dGVybiIsIndyYXBSZWxhdGl2ZVBhdHRlcm4iLCJ0YXJnZXRQYXRoIiwibWF0Y2hQYXRoRW5kcyIsInVzaW5nUG9zaXhTZXAiLCJzZXAiLCJuYXRpdmVQYXRoIiwicmVwbGFjZSIsIm5hdGl2ZVBhdGhFbmQiLCJ0YXJnZXRQYXRoRW5kIiwiaGFzU2libGluZyIsInBhcnNlIiwidW5kZWZpbmVkIiwib2JqIiwicnAiLCJpc1JlbGF0aXZlUGF0dGVybiIsInJlc3VsdFBhdHRlcm4iLCJleHByZXNzaW9uIiwiT2JqZWN0IiwiZ2V0T3duUHJvcGVydHlOYW1lcyIsInZhbHVlIiwid2hlbiIsInJlc3VsdCIsIm5hbWUiLCJtYXRjaGVkIiwidGhlbiIsInJlcXVpcmVzU2libGluZ3MiLCJwYXJzZUV4cHJlc3Npb25QYXR0ZXJuIiwic29tZSIsInJlc3VsdEV4cHJlc3Npb24iLCJyZXN1bHRQcm9taXNlcyIsInJlc3VsdFByb21pc2UiLCJwYXJzZWRFeHByZXNzaW9uIiwiYmFzZW5hbWVQYXR0ZXJucyIsImFnZ3JlZ2F0ZSIsImNoIiwiY2hhckNvZGVBdCIsImluZGV4T2YiLCJhZ2dyZWdhdGVkUGF0dGVybnMiXSwic291cmNlUm9vdCI6IiJ9